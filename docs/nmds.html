<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title> 19 R Módulo 10.1 - Análise de Ordenação - NMDS | Fundamentos de Ecologia Numérica</title>
<meta name="author" content="Prof. Elvio S. F. Medeiros">
<meta name="author" content="Laboratório de Ecologia">
<meta name="author" content="Universidade Estadual da Paraíba">
<meta name="author" content="Campus V, João Pessoa, PB">
<meta name="description" content="RESUMO O Escalonamento Multidimensional Não-Métrico, também conhecido como NMDS ou MDS não-métrico (Multidimensional Scaling), é uma técnica estatística útil em situações onde as relações entre os...">
<meta name="generator" content="bookdown 0.38 with bs4_book()">
<meta property="og:title" content=" 19 R Módulo 10.1 - Análise de Ordenação - NMDS | Fundamentos de Ecologia Numérica">
<meta property="og:type" content="book">
<meta property="og:description" content="RESUMO O Escalonamento Multidimensional Não-Métrico, também conhecido como NMDS ou MDS não-métrico (Multidimensional Scaling), é uma técnica estatística útil em situações onde as relações entre os...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content=" 19 R Módulo 10.1 - Análise de Ordenação - NMDS | Fundamentos de Ecologia Numérica">
<meta name="twitter:description" content="RESUMO O Escalonamento Multidimensional Não-Métrico, também conhecido como NMDS ou MDS não-métrico (Multidimensional Scaling), é uma técnica estatística útil em situações onde as relações entre os...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.2/transition.js"></script><script src="libs/bs3compat-0.4.2/tabs.js"></script><script src="libs/bs3compat-0.4.2/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet">
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script><script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script><script src="libs/rglWebGL-binding-1.1.3/rglWebGL.js"></script><link href="libs/rglwidgetClass-1.1.3/rgl.css" rel="stylesheet">
<script src="libs/rglwidgetClass-1.1.3/rglClass.src.js"></script><script src="libs/rglwidgetClass-1.1.3/utils.src.js"></script><script src="libs/rglwidgetClass-1.1.3/buffer.src.js"></script><script src="libs/rglwidgetClass-1.1.3/subscenes.src.js"></script><script src="libs/rglwidgetClass-1.1.3/shaders.src.js"></script><script src="libs/rglwidgetClass-1.1.3/shadersrc.src.js"></script><script src="libs/rglwidgetClass-1.1.3/textures.src.js"></script><script src="libs/rglwidgetClass-1.1.3/projection.src.js"></script><script src="libs/rglwidgetClass-1.1.3/mouse.src.js"></script><script src="libs/rglwidgetClass-1.1.3/init.src.js"></script><script src="libs/rglwidgetClass-1.1.3/pieces.src.js"></script><script src="libs/rglwidgetClass-1.1.3/draw.src.js"></script><script src="libs/rglwidgetClass-1.1.3/controls.src.js"></script><script src="libs/rglwidgetClass-1.1.3/selection.src.js"></script><script src="libs/rglwidgetClass-1.1.3/rglTimer.src.js"></script><script src="libs/rglwidgetClass-1.1.3/pretty.src.js"></script><script src="libs/rglwidgetClass-1.1.3/axes.src.js"></script><script src="libs/rglwidgetClass-1.1.3/animation.src.js"></script><script src="libs/CanvasMatrix4-1.1.3/CanvasMatrix.src.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
          margin-bottom: 1em;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="Disciplina de Ecologia Numérica do Curso de Ciências Biológicas do Campus V da UEPB">Fundamentos de Ecologia Numérica</a>:
        <small class="text-muted">Disciplina de Ecologia Numérica do Curso de Ciências Biológicas do Campus V da UEPB</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Apresentação</a></li>
<li><a class="" href="intro.html"><span class="header-section-number">2</span> Introdução ao R/RStudio</a></li>
<li class="book-part">II. BASES DE DADOS</li>
<li><a class="" href="bases.html"><span class="header-section-number">3</span> Bases de dados. Dados do PPBio Semiárido</a></li>
<li><a class="" href="basepeixes.html"><span class="header-section-number">4</span> Base de dados I - Peixes</a></li>
<li><a class="" href="basehab.html"><span class="header-section-number">5</span> Base de dados II - Habitat</a></li>
<li class="book-part">III. ESTATÍSTICAS DESCRITIVAS</li>
<li><a class="" href="xls.html"><span class="header-section-number">6</span> R Módulo 1 - Importando planilhas de dados</a></li>
<li><a class="" href="tiposR.html"><span class="header-section-number">7</span> R Módulo 2 - Tipos de dados no R</a></li>
<li><a class="" href="univ.html"><span class="header-section-number">8</span> R Módulo 3.1 - Estatísticas descritivas e normalidade</a></li>
<li><a class="" href="univ2.html"><span class="header-section-number">9</span> R Módulo 3.2 - Testes estatísticos</a></li>
<li><a class="" href="unigr.html"><span class="header-section-number">10</span> R Modulo 3.3 - Gráficos univariados</a></li>
<li><a class="" href="estrcom.html"><span class="header-section-number">11</span> R Módulo 4.1 - Estrutura da comunidade</a></li>
<li><a class="" href="partdiv.html"><span class="header-section-number">12</span> R Modulo 4.2 - Decomposição da diversidade</a></li>
<li><a class="" href="estrhab.html"><span class="header-section-number">13</span> R Módulo 4.3 - Estrutura do habitat</a></li>
<li><a class="" href="reltrns.html"><span class="header-section-number">14</span> R Modulo 5 - Relativizações e transformações</a></li>
<li><a class="" href="outcentr.html"><span class="header-section-number">15</span> R Módulo 6 - Análise de outliers baseada no desvio padrão do centróide</a></li>
<li class="book-part">IV. ANÁLISES MULTIVARIADAS</li>
<li><a class="" href="upgma.html"><span class="header-section-number">16</span> R Módulo 7 - Análise de Classificação Hierárquica - SAHN</a></li>
<li><a class="" href="kmeans.html"><span class="header-section-number">17</span> R Módulo 8 - Análise de Classificação Não-hierárquica - K-Means</a></li>
<li><a class="" href="pca.html"><span class="header-section-number">18</span> R Módulo 9 - Análise de Componentes Principais - PCA</a></li>
<li><a class="active" href="nmds.html"><span class="header-section-number">19</span> R Módulo 10.1 - Análise de Ordenação - NMDS</a></li>
<li><a class="" href="nmds2.html"><span class="header-section-number">20</span> R Modulo 10.2 - Análise de Ordenação - NMDS</a></li>
<li><a class="" href="bibliografia-geral.html">Bibliografia Geral</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="nmds" class="section level1" number="19">
<h1>
<span class="header-section-number"> 19</span> R Módulo 10.1 - Análise de Ordenação - NMDS<a class="anchor" aria-label="anchor" href="#nmds"><i class="fas fa-link"></i></a>
</h1>
<div id="resumo-15" class="section level3 unnumbered">
<h3>RESUMO<a class="anchor" aria-label="anchor" href="#resumo-15"><i class="fas fa-link"></i></a>
</h3>
<p>O Escalonamento Multidimensional Não-Métrico, também conhecido como NMDS ou MDS não-métrico (Multidimensional Scaling), é uma técnica estatística útil em situações onde as relações entre os pontos são importantes, mas as distâncias exatas entre eles podem não ser facilmente quantificáveis ou interpretáveis. Além da Ecologia, o NMDS é frequentemente usado em áreas como análise de dados, psicometria, ciência social, visualização de dados e aprendizado de máquina.</p>
</div>
<div id="apresentação-16" class="section level3 unnumbered">
<h3>Apresentação<a class="anchor" aria-label="anchor" href="#apresenta%C3%A7%C3%A3o-16"><i class="fas fa-link"></i></a>
</h3>
<p>O Escalonamento Multidimensional Não-Métrico, também conhecido como NMDS ou MDS não-métrico (Multidimensional Scaling), é uma técnica estatística utilizada para representar dados com muitas dimensões em um espaço dimensional menor, de forma que a estrutura dos dados originais seja preservada o máximo possível.</p>
<p>Ao contrário do MDS métrico, que preserva as distâncias entre os pontos, o MDS não-métrico preserva apenas as relações de ordem ou similaridade entre os pontos, sem assumir uma relação linear com as distâncias reais. Em outras palavras, ele se concentra em preservar as relações de proximidade entre os pontos, mas não necessariamente suas distâncias exatas.</p>
<p>A técnica funciona construindo uma matriz de similaridade a partir dos dados originais e, em seguida, posicionando os pontos em um espaço de menor dimensão de forma que as distâncias ou similaridades relativas sejam mantidas o mais fiel possível à matriz original.</p>
<p>O MDS não-métrico é útil em situações onde as relações entre os pontos são importantes, mas as distâncias exatas entre eles podem não ser facilmente quantificáveis ou interpretáveis. Além da Ecologia, o NMDS é frequentemente usado em áreas como análise de dados, psicometria, ciência social, visualização de dados e aprendizado de máquina.</p>
</div>
<div id="algoritmo-da-nmds" class="section level2" number="19.1">
<h2>
<span class="header-section-number">19.1</span> Algoritmo da NMDS<a class="anchor" aria-label="anchor" href="#algoritmo-da-nmds"><i class="fas fa-link"></i></a>
</h2>
<p>O algoritmo de uma NMDS (Non-Metric Multidimensional Scaling) funciona de maneira a posicionar os pontos de dados em um espaço de menor dimensão de forma que as relações de ordem ou similaridade entre os pontos sejam preservadas o máximo possível.</p>
<p>Aqui está uma visão geral de como o algoritmo de NMDS opera:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Matriz de Similaridade</strong>: O algoritmo começa com uma matriz de similaridade ou dissimilaridade que captura as relações entre os pontos de dados. Essa matriz pode ser baseada em diferentes medidas, como correlações, coeficientes de similaridade, distâncias euclidianas, entre outras.</p></li>
<li><p><strong>Inicialização</strong>: Inicialmente, os pontos são atribuídos a posições aleatórias ou em uma configuração inicial no espaço de menor dimensão.</p></li>
<li><p><strong>Ajuste Iterativo</strong>: O algoritmo itera para melhorar as posições dos pontos no espaço de menor dimensão. Durante cada iteração, os pontos são movidos em direção a uma configuração que melhor preserve as relações de similaridade ou dissimilaridade conforme definido pela matriz de similaridade.</p></li>
<li><p><strong>Critério de Convergência</strong>: O processo iterativo continua até que um critério de convergência seja alcançado. Isso pode ser baseado na estabilidade das posições dos pontos ou na convergência de uma função de custo que quantifica a discrepância entre as relações de similaridade na configuração original e na configuração reduzida.</p></li>
<li><p><strong>Saída</strong>: Uma vez que o algoritmo convergiu, as posições finais dos pontos no espaço de menor dimensão são utilizadas como representações dos dados para visualização ou análise.</p></li>
</ol>
<div id="hello" class="greeting message" style="color: green;">
<p>É importante notar que, embora o NMDS preserve as relações de ordem ou similaridade entre os pontos, não há garantia de que as distâncias absolutas entre os pontos no espaço de menor dimensão correspondam às distâncias reais entre os pontos nos dados originais. O objetivo principal é preservar a estrutura relativa dos dados em um espaço de menor dimensão, facilitando a interpretação e visualização dos padrões nos dados.</p>
</div>
</div>
<div id="organização-básica-13" class="section level2" number="19.2">
<h2>
<span class="header-section-number">19.2</span> Organização básica<a class="anchor" aria-label="anchor" href="#organiza%C3%A7%C3%A3o-b%C3%A1sica-13"><i class="fas fa-link"></i></a>
</h2>
<p>Apagamos os gráficos, se houver algum, limpamos a memória e o console.</p>
<div class="sourceCode" id="cb570"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>all<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\014"</span><span class="op">)</span></span>
<span><span class="co">#apaga os graficos, se houver algum, limpa a memória e o console</span></span></code></pre></div>
</div>
<div id="pacotes-do-módulo-1" class="section level2" number="19.3">
<h2>
<span class="header-section-number">19.3</span> Pacotes do módulo<a class="anchor" aria-label="anchor" href="#pacotes-do-m%C3%B3dulo-1"><i class="fas fa-link"></i></a>
</h2>
<p>Instalando os pacotes necessários para esse módulo. Nos computadores do Laboratório de Ecologia não instale esses pacotes, eles já estão instalados.</p>
<div class="sourceCode" id="cb571"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"openxlsx"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"rgl"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb572"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#dir &lt;- getwd() #criamos um vetor com o diretório  de trbalho </span></span>
<span><span class="co">#shell.exec(dir) #abre o diretorio de trabalho no Windows Explorer</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ycphs.github.io/openxlsx/index.html">openxlsx</a></span><span class="op">)</span></span>
<span><span class="va">ppbio</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html">read.xlsx</a></span><span class="op">(</span><span class="st">"D:/Elvio/OneDrive/Disciplinas/_EcoNumerica/5.Matrizes/ppbio06p-peixes.xlsx"</span>,</span>
<span>                   rowNames <span class="op">=</span> <span class="cn">T</span>, colNames <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                   sheet <span class="op">=</span> <span class="st">"Sheet1"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">ppbio</span><span class="op">)</span></span>
<span><span class="co">#View(ppbio)</span></span>
<span><span class="va">ppbio</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span> <span class="co">#[1:5,1:5] mostra apenas as linhas e colunas de 1 a 5.</span></span></code></pre></div>
</div>
<div id="reinício-1-1" class="section level2" number="19.4">
<h2>
<span class="header-section-number">19.4</span> REINÍCIO 1<a class="anchor" aria-label="anchor" href="#rein%C3%ADcio-1-1"><i class="fas fa-link"></i></a>
</h2>
<div id="hello" class="greeting message" style="color: green;">
<p>Aqui substitui-se uma nova matriz de dados, caso seja necessário refazer a análise com uma matriz gerada nesse código.</p>
</div>
<div class="sourceCode" id="cb573"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m_trab</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">ppbio</span><span class="op">)</span>   <span class="co"># &lt;1&gt;</span></span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Substitua a nova matriz aqui. Caso seja necessário.</li>
</ol>
</div>
<div id="classificação-1-matriz-comunitária" class="section level2" number="19.5">
<h2>
<span class="header-section-number">19.5</span> Classificação 1: Matriz comunitária<a class="anchor" aria-label="anchor" href="#classifica%C3%A7%C3%A3o-1-matriz-comunit%C3%A1ria"><i class="fas fa-link"></i></a>
</h2>
<p>Para conhecermos os dados, vamos criar uma classificação baseada na distância Bray-Curtis e UPGMA como método de fusão, a partir das matrizes de dados de interesse <code>ppbio**</code> com suas devidas relativizações e transformações.</p>
<div id="dendrograma-e-heatmap-1" class="section level3" number="19.5.1">
<h3>
<span class="header-section-number">19.5.1</span> Dendrograma e Heatmap 1<a class="anchor" aria-label="anchor" href="#dendrograma-e-heatmap-1"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb574"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Dendrograma</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/vegandevs/vegan">vegan</a></span><span class="op">)</span></span>
<span><span class="va">m_trns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">asin</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/decostand.html">decostand</a></span><span class="op">(</span><span class="va">m_trab</span>,</span>
<span>                               method<span class="op">=</span><span class="st">"total"</span>, MARGIN <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#m_trns &lt;- sqrt(m_trab)</span></span>
<span><span class="va">vegdist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/vegdist.html">vegdist</a></span><span class="op">(</span><span class="va">m_trns</span>, method <span class="op">=</span> <span class="st">"bray"</span>,</span>
<span>                   diag <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                   upper <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">cluster_uas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span><span class="va">vegdist</span>, method <span class="op">=</span> <span class="st">"average"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span> <span class="op">(</span><span class="va">cluster_uas</span>, main <span class="op">=</span> <span class="st">"Cluster Dendrogram - Bray-Curtis da Matriz Comunitária"</span>,</span>
<span>      hang <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="co">#testar com -.01</span></span>
<span><span class="co">#rect.hclust(cluster_uas, k = 3, h = NULL) </span></span>
<span><span class="co">#h = 0.8 fornece os grupos formados na altura h</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">vegdist</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span></span>
<span></span>
<span><span class="co">#Heatmap</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/talgalili/gplots">"gplots"</a></span><span class="op">)</span></span>
<span><span class="va">heatdist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">vegdist</span><span class="op">)</span></span>
<span><span class="va">col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">heat.colors</a></span><span class="op">(</span><span class="fl">999</span><span class="op">)</span><span class="op">)</span> <span class="co">#rev() reverte as cores do heatmap</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gplots/man/heatmap.2.html">heatmap.2</a></span><span class="op">(</span>x<span class="op">=</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">vegdist</span><span class="op">)</span><span class="op">)</span>, <span class="co">#objetos x objetos</span></span>
<span>          Rowv <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html">as.dendrogram</a></span><span class="op">(</span><span class="va">cluster_uas</span><span class="op">)</span>,</span>
<span>          Colv <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html">as.dendrogram</a></span><span class="op">(</span><span class="va">cluster_uas</span><span class="op">)</span>,</span>
<span>          key <span class="op">=</span> <span class="cn">T</span>, tracecol <span class="op">=</span> <span class="cn">NA</span>, revC <span class="op">=</span> <span class="cn">T</span>,</span>
<span>          col <span class="op">=</span> <span class="va">heat.colors</span>,  <span class="co">#dissimilaridade = 1 - similaridade</span></span>
<span>          density.info <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>          xlab <span class="op">=</span> <span class="st">"UA´s"</span>, ylab <span class="op">=</span> <span class="st">"UA´s"</span>,</span>
<span>          mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">6</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">cluster_spp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/vegdist.html">vegdist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">m_trns</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"bray"</span>,</span>
<span>                            diag <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                            upper <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"average"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span> <span class="op">(</span><span class="va">cluster_spp</span>, main <span class="op">=</span> <span class="st">"Dendrograma dos atributos"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gplots/man/heatmap.2.html">heatmap.2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">m_trns</span><span class="op">)</span><span class="op">)</span>, <span class="co">#objetos x atributos</span></span>
<span>          Colv <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html">as.dendrogram</a></span><span class="op">(</span><span class="va">cluster_uas</span><span class="op">)</span>,</span>
<span>          Rowv <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html">as.dendrogram</a></span><span class="op">(</span><span class="va">cluster_spp</span><span class="op">)</span>,</span>
<span>          key <span class="op">=</span> <span class="cn">T</span>, tracecol <span class="op">=</span> <span class="cn">NA</span>, revC <span class="op">=</span> <span class="cn">T</span>,</span>
<span>          col <span class="op">=</span> <span class="va">col</span>,</span>
<span>          density.info <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>          xlab <span class="op">=</span> <span class="st">"Unidades amostrais"</span>, ylab <span class="op">=</span> <span class="st">"Espécies"</span>,</span>
<span>          mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">6</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.1</span><span class="op">)</span>  <span class="co"># adjust margin size</span></span></code></pre></div>
<pre><code>##           S-R-CT1   S-R-CP1   S-A-TA1   S-R-CT2   S-R-CP2   S-A-TA2
## S-R-CT1 0.0000000 0.8743721 0.9338269 0.6274997 0.8106894 0.9420728
## S-R-CP1 0.8743721 0.0000000 0.6833816 0.7759468 0.7726098 0.7342613
## S-A-TA1 0.9338269 0.6833816 0.0000000 0.8789631 0.9178304 0.5700984
## S-R-CT2 0.6274997 0.7759468 0.8789631 0.0000000 0.7280378 0.8836068
## S-R-CP2 0.8106894 0.7726098 0.9178304 0.7280378 0.0000000 0.8915271
## S-A-TA2 0.9420728 0.7342613 0.5700984 0.8836068 0.8915271 0.0000000</code></pre>
<p><img src="fundamentos_de_ecologia_numerica_files/figure-html/unnamed-chunk-289-1.png" width="768"><img src="fundamentos_de_ecologia_numerica_files/figure-html/unnamed-chunk-289-2.png" width="768"><img src="fundamentos_de_ecologia_numerica_files/figure-html/unnamed-chunk-289-3.png" width="768"><img src="fundamentos_de_ecologia_numerica_files/figure-html/unnamed-chunk-289-4.png" width="768"></p>
</div>
<div id="histórico-das-fusões-1-1" class="section level3" number="19.5.2">
<h3>
<span class="header-section-number">19.5.2</span> Histórico das fusões 1<a class="anchor" aria-label="anchor" href="#hist%C3%B3rico-das-fus%C3%B5es-1-1"><i class="fas fa-link"></i></a>
</h3>
<p>Criamos agora o histórico das fusões dos objetos. Na tabela gerada, as duas primeiras colunas (No. e UA) representam o número (No.) atribuido a cada unidade amostral (UA). As duas colunas subsequentes (Cluster1 e Cluster2) representam o par de objetos (indicado pelo sinal de “-”) ou grupo de objetos (indicado pela ausência do sinall de “-”) que foram agrupadas. A coluna Height, indica o valor de similaridade na qual um dado par de objetos (ou grupo de objetos) foi agrupado. O valor aproximado de Height também pode ser visualizado no eixo do dendrograma. Por último, na coluna Histórico, é mostrada a sequência das fusões da primeira até a <code>m-1</code> última fusão entre os dois últimos grupos. Nesse caso, 22.</p>
<div class="sourceCode" id="cb576"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://gt.rstudio.com">gt</a></span><span class="op">)</span></span>
<span><span class="va">merge</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">cluster_uas</span><span class="op">$</span><span class="va">merge</span><span class="op">)</span></span>
<span><span class="va">merge</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">merge</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,<span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"0"</span>,<span class="st">"0"</span><span class="op">)</span></span>
<span><span class="va">height</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">cluster_uas</span><span class="op">$</span><span class="va">height</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">height</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">height</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,<span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1.0"</span><span class="op">)</span></span>
<span><span class="va">fusoes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Cluster_uas <span class="op">=</span> <span class="va">merge</span>, Height <span class="op">=</span> <span class="va">height</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">fusoes</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Cluster1"</span>, <span class="st">"Cluster2"</span>, <span class="st">"Height"</span><span class="op">)</span></span>
<span><span class="va">UA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">m_trns</span><span class="op">[</span>, <span class="fl">0</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">UA</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"UAs"</span><span class="op">)</span></span>
<span><span class="va">No.UA</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">fusoes</span><span class="op">)</span></span>
<span><span class="va">fusoes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">No.UA</span>, <span class="va">UA</span>, <span class="va">fusoes</span><span class="op">)</span></span>
<span><span class="va">fusoes</span><span class="op">$</span><span class="va">Histórico</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">fusoes</span><span class="op">)</span></span>
<span><span class="co">#fusoes</span></span>
<span><span class="fu"><a href="https://gt.rstudio.com/reference/gt.html">gt</a></span><span class="op">(</span><span class="va">fusoes</span><span class="op">)</span></span></code></pre></div>
<div id="xwrqzpfoxi" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#xwrqzpfoxi table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xwrqzpfoxi thead, #xwrqzpfoxi tbody, #xwrqzpfoxi tfoot, #xwrqzpfoxi tr, #xwrqzpfoxi td, #xwrqzpfoxi th {
  border-style: none;
}

#xwrqzpfoxi p {
  margin: 0;
  padding: 0;
}

#xwrqzpfoxi .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xwrqzpfoxi .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xwrqzpfoxi .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xwrqzpfoxi .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xwrqzpfoxi .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xwrqzpfoxi .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xwrqzpfoxi .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xwrqzpfoxi .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xwrqzpfoxi .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xwrqzpfoxi .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xwrqzpfoxi .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xwrqzpfoxi .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xwrqzpfoxi .gt_spanner_row {
  border-bottom-style: hidden;
}

#xwrqzpfoxi .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xwrqzpfoxi .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xwrqzpfoxi .gt_from_md > :first-child {
  margin-top: 0;
}

#xwrqzpfoxi .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xwrqzpfoxi .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xwrqzpfoxi .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xwrqzpfoxi .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xwrqzpfoxi .gt_row_group_first td {
  border-top-width: 2px;
}

#xwrqzpfoxi .gt_row_group_first th {
  border-top-width: 2px;
}

#xwrqzpfoxi .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xwrqzpfoxi .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xwrqzpfoxi .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xwrqzpfoxi .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xwrqzpfoxi .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xwrqzpfoxi .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xwrqzpfoxi .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xwrqzpfoxi .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xwrqzpfoxi .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xwrqzpfoxi .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xwrqzpfoxi .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xwrqzpfoxi .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xwrqzpfoxi .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xwrqzpfoxi .gt_left {
  text-align: left;
}

#xwrqzpfoxi .gt_center {
  text-align: center;
}

#xwrqzpfoxi .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xwrqzpfoxi .gt_font_normal {
  font-weight: normal;
}

#xwrqzpfoxi .gt_font_bold {
  font-weight: bold;
}

#xwrqzpfoxi .gt_font_italic {
  font-style: italic;
}

#xwrqzpfoxi .gt_super {
  font-size: 65%;
}

#xwrqzpfoxi .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xwrqzpfoxi .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xwrqzpfoxi .gt_indent_1 {
  text-indent: 5px;
}

#xwrqzpfoxi .gt_indent_2 {
  text-indent: 10px;
}

#xwrqzpfoxi .gt_indent_3 {
  text-indent: 15px;
}

#xwrqzpfoxi .gt_indent_4 {
  text-indent: 20px;
}

#xwrqzpfoxi .gt_indent_5 {
  text-indent: 25px;
}
</style>
<div class="inline-table"><table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="No.UA">No.UA</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="UAs">UAs</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Cluster1">Cluster1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Cluster2">Cluster2</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Height">Height</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Histórico">Histórico</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td headers="No.UA" class="gt_row gt_right">1</td>
<td headers="UAs" class="gt_row gt_left">S-R-CT1</td>
<td headers="Cluster1" class="gt_row gt_right">-20</td>
<td headers="Cluster2" class="gt_row gt_right">-23</td>
<td headers="Height" class="gt_row gt_right">0.14</td>
<td headers="Histórico" class="gt_row gt_right">1</td>
</tr>
<tr>
<td headers="No.UA" class="gt_row gt_right">2</td>
<td headers="UAs" class="gt_row gt_left">S-R-CP1</td>
<td headers="Cluster1" class="gt_row gt_right">-8</td>
<td headers="Cluster2" class="gt_row gt_right">-11</td>
<td headers="Height" class="gt_row gt_right">0.26</td>
<td headers="Histórico" class="gt_row gt_right">2</td>
</tr>
<tr>
<td headers="No.UA" class="gt_row gt_right">3</td>
<td headers="UAs" class="gt_row gt_left">S-A-TA1</td>
<td headers="Cluster1" class="gt_row gt_right">-17</td>
<td headers="Cluster2" class="gt_row gt_right">1</td>
<td headers="Height" class="gt_row gt_right">0.28</td>
<td headers="Histórico" class="gt_row gt_right">3</td>
</tr>
<tr>
<td headers="No.UA" class="gt_row gt_right">4</td>
<td headers="UAs" class="gt_row gt_left">S-R-CT2</td>
<td headers="Cluster1" class="gt_row gt_right">-19</td>
<td headers="Cluster2" class="gt_row gt_right">-22</td>
<td headers="Height" class="gt_row gt_right">0.37</td>
<td headers="Histórico" class="gt_row gt_right">4</td>
</tr>
<tr>
<td headers="No.UA" class="gt_row gt_right">5</td>
<td headers="UAs" class="gt_row gt_left">S-R-CP2</td>
<td headers="Cluster1" class="gt_row gt_right">-6</td>
<td headers="Cluster2" class="gt_row gt_right">-12</td>
<td headers="Height" class="gt_row gt_right">0.41</td>
<td headers="Histórico" class="gt_row gt_right">5</td>
</tr>
<tr>
<td headers="No.UA" class="gt_row gt_right">6</td>
<td headers="UAs" class="gt_row gt_left">S-A-TA2</td>
<td headers="Cluster1" class="gt_row gt_right">-4</td>
<td headers="Cluster2" class="gt_row gt_right">-10</td>
<td headers="Height" class="gt_row gt_right">0.46</td>
<td headers="Histórico" class="gt_row gt_right">6</td>
</tr>
<tr>
<td headers="No.UA" class="gt_row gt_right">7</td>
<td headers="UAs" class="gt_row gt_left">S-R-CT3</td>
<td headers="Cluster1" class="gt_row gt_right">-16</td>
<td headers="Cluster2" class="gt_row gt_right">4</td>
<td headers="Height" class="gt_row gt_right">0.48</td>
<td headers="Histórico" class="gt_row gt_right">7</td>
</tr>
<tr>
<td headers="No.UA" class="gt_row gt_right">8</td>
<td headers="UAs" class="gt_row gt_left">S-R-CP3</td>
<td headers="Cluster1" class="gt_row gt_right">-5</td>
<td headers="Cluster2" class="gt_row gt_right">2</td>
<td headers="Height" class="gt_row gt_right">0.53</td>
<td headers="Histórico" class="gt_row gt_right">8</td>
</tr>
<tr>
<td headers="No.UA" class="gt_row gt_right">9</td>
<td headers="UAs" class="gt_row gt_left">S-A-TA3</td>
<td headers="Cluster1" class="gt_row gt_right">-13</td>
<td headers="Cluster2" class="gt_row gt_right">7</td>
<td headers="Height" class="gt_row gt_right">0.56</td>
<td headers="Histórico" class="gt_row gt_right">9</td>
</tr>
<tr>
<td headers="No.UA" class="gt_row gt_right">10</td>
<td headers="UAs" class="gt_row gt_left">S-R-CT4</td>
<td headers="Cluster1" class="gt_row gt_right">-9</td>
<td headers="Cluster2" class="gt_row gt_right">5</td>
<td headers="Height" class="gt_row gt_right">0.57</td>
<td headers="Histórico" class="gt_row gt_right">10</td>
</tr>
<tr>
<td headers="No.UA" class="gt_row gt_right">11</td>
<td headers="UAs" class="gt_row gt_left">S-R-CP4</td>
<td headers="Cluster1" class="gt_row gt_right">-7</td>
<td headers="Cluster2" class="gt_row gt_right">6</td>
<td headers="Height" class="gt_row gt_right">0.59</td>
<td headers="Histórico" class="gt_row gt_right">11</td>
</tr>
<tr>
<td headers="No.UA" class="gt_row gt_right">12</td>
<td headers="UAs" class="gt_row gt_left">S-A-TA4</td>
<td headers="Cluster1" class="gt_row gt_right">-14</td>
<td headers="Cluster2" class="gt_row gt_right">3</td>
<td headers="Height" class="gt_row gt_right">0.61</td>
<td headers="Histórico" class="gt_row gt_right">12</td>
</tr>
<tr>
<td headers="No.UA" class="gt_row gt_right">13</td>
<td headers="UAs" class="gt_row gt_left">B-A-MU1</td>
<td headers="Cluster1" class="gt_row gt_right">-2</td>
<td headers="Cluster2" class="gt_row gt_right">-3</td>
<td headers="Height" class="gt_row gt_right">0.68</td>
<td headers="Histórico" class="gt_row gt_right">13</td>
</tr>
<tr>
<td headers="No.UA" class="gt_row gt_right">14</td>
<td headers="UAs" class="gt_row gt_left">B-A-GU1</td>
<td headers="Cluster1" class="gt_row gt_right">-1</td>
<td headers="Cluster2" class="gt_row gt_right">11</td>
<td headers="Height" class="gt_row gt_right">0.68</td>
<td headers="Histórico" class="gt_row gt_right">14</td>
</tr>
<tr>
<td headers="No.UA" class="gt_row gt_right">15</td>
<td headers="UAs" class="gt_row gt_left">B-R-PC2</td>
<td headers="Cluster1" class="gt_row gt_right">-15</td>
<td headers="Cluster2" class="gt_row gt_right">-18</td>
<td headers="Height" class="gt_row gt_right">0.69</td>
<td headers="Histórico" class="gt_row gt_right">15</td>
</tr>
<tr>
<td headers="No.UA" class="gt_row gt_right">16</td>
<td headers="UAs" class="gt_row gt_left">B-A-MU2</td>
<td headers="Cluster1" class="gt_row gt_right">-21</td>
<td headers="Cluster2" class="gt_row gt_right">14</td>
<td headers="Height" class="gt_row gt_right">0.75</td>
<td headers="Histórico" class="gt_row gt_right">16</td>
</tr>
<tr>
<td headers="No.UA" class="gt_row gt_right">17</td>
<td headers="UAs" class="gt_row gt_left">B-A-GU2</td>
<td headers="Cluster1" class="gt_row gt_right">10</td>
<td headers="Cluster2" class="gt_row gt_right">13</td>
<td headers="Height" class="gt_row gt_right">0.76</td>
<td headers="Histórico" class="gt_row gt_right">17</td>
</tr>
<tr>
<td headers="No.UA" class="gt_row gt_right">18</td>
<td headers="UAs" class="gt_row gt_left">B-R-PC3</td>
<td headers="Cluster1" class="gt_row gt_right">9</td>
<td headers="Cluster2" class="gt_row gt_right">12</td>
<td headers="Height" class="gt_row gt_right">0.79</td>
<td headers="Histórico" class="gt_row gt_right">18</td>
</tr>
<tr>
<td headers="No.UA" class="gt_row gt_right">19</td>
<td headers="UAs" class="gt_row gt_left">B-A-MU3</td>
<td headers="Cluster1" class="gt_row gt_right">8</td>
<td headers="Cluster2" class="gt_row gt_right">16</td>
<td headers="Height" class="gt_row gt_right">0.8</td>
<td headers="Histórico" class="gt_row gt_right">19</td>
</tr>
<tr>
<td headers="No.UA" class="gt_row gt_right">20</td>
<td headers="UAs" class="gt_row gt_left">B-A-GU3</td>
<td headers="Cluster1" class="gt_row gt_right">17</td>
<td headers="Cluster2" class="gt_row gt_right">19</td>
<td headers="Height" class="gt_row gt_right">0.85</td>
<td headers="Histórico" class="gt_row gt_right">20</td>
</tr>
<tr>
<td headers="No.UA" class="gt_row gt_right">21</td>
<td headers="UAs" class="gt_row gt_left">B-R-PC4</td>
<td headers="Cluster1" class="gt_row gt_right">15</td>
<td headers="Cluster2" class="gt_row gt_right">20</td>
<td headers="Height" class="gt_row gt_right">0.89</td>
<td headers="Histórico" class="gt_row gt_right">21</td>
</tr>
<tr>
<td headers="No.UA" class="gt_row gt_right">22</td>
<td headers="UAs" class="gt_row gt_left">B-A-MU4</td>
<td headers="Cluster1" class="gt_row gt_right">18</td>
<td headers="Cluster2" class="gt_row gt_right">21</td>
<td headers="Height" class="gt_row gt_right">0.91</td>
<td headers="Histórico" class="gt_row gt_right">22</td>
</tr>
<tr>
<td headers="No.UA" class="gt_row gt_right">23</td>
<td headers="UAs" class="gt_row gt_left">B-A-GU4</td>
<td headers="Cluster1" class="gt_row gt_right">0</td>
<td headers="Cluster2" class="gt_row gt_right">0</td>
<td headers="Height" class="gt_row gt_right">1.0</td>
<td headers="Histórico" class="gt_row gt_right">23</td>
</tr>
</tbody>
</table></div>
</div>
</div>
</div>
<div id="ordenação" class="section level2" number="19.6">
<h2>
<span class="header-section-number">19.6</span> Ordenação<a class="anchor" aria-label="anchor" href="#ordena%C3%A7%C3%A3o"><i class="fas fa-link"></i></a>
</h2>
<p>O Escalonamento Multidimensional Não-Métrico (NMS ou NMDS) é uma ferramenta comumente usada para examinar a composição da comunidade. Vamos estabelecer algumas bases conceituais. Considere um único eixo de abundância representando uma única espécie <a href="https://jonlefcheck.net/2012/10/24/nmds-tutorial-in-r/">Fonte</a>:</p>
<div class="sourceCode" id="cb577"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">10</span>,<span class="fl">0</span><span class="op">:</span><span class="fl">10</span>,type<span class="op">=</span><span class="st">"n"</span>,axes<span class="op">=</span><span class="cn">F</span>,xlab<span class="op">=</span><span class="st">"Abundância da Espécie 1"</span>,ylab<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fl">8</span>,<span class="fl">0</span>, pch<span class="op">=</span><span class="fl">19</span>,col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="fl">8.5</span>,<span class="fl">1</span>,labels<span class="op">=</span><span class="st">"Comunidade A"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">0</span>, pch<span class="op">=</span><span class="fl">19</span>,col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="fl">3.5</span>,<span class="fl">1</span>,labels<span class="op">=</span><span class="st">"Comunidade B"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>, pch<span class="op">=</span><span class="fl">19</span>,col<span class="op">=</span><span class="st">"green"</span> <span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">1</span>,labels<span class="op">=</span><span class="st">"Comunidade C"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="fundamentos_de_ecologia_numerica_files/figure-html/unnamed-chunk-291-1.png" width="672"></div>
<p>Podemos plotar cada comunidade nesse eixo dependendo da abundância da espécie 1 dentro dela.</p>
<div class="sourceCode" id="cb578"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">'</span></span>
<span><span class="st">|------------|-----|</span></span>
<span><span class="st">| Comunidade | Sp1 |</span></span>
<span><span class="st">|------------|-----|</span></span>
<span><span class="st">| A (verm)   |  8  |</span></span>
<span><span class="st">| B (azul)   |  3  |</span></span>
<span><span class="st">| C (verde)  |  0  |</span></span>
<span><span class="st">|------------|-----|</span></span>
<span><span class="st">'</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## |------------|-----|
## | Comunidade | Sp1 |
## |------------|-----|
## | A (verm)   |  8  |
## | B (azul)   |  3  |
## | C (verde)  |  0  |
## |------------|-----|</code></pre>
<p>Agora, considere um segundo eixo de abundância representando uma espécie diferente. As comunidades podem ser plotadas ao longo de ambos os eixos dependendo da abundância das espécies dentro delas.</p>
<div class="sourceCode" id="cb580"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">'</span></span>
<span><span class="st">|------------|-----|-----|</span></span>
<span><span class="st">| Comunidade | Sp1 | Sp2 |</span></span>
<span><span class="st">|------------|-----|-----|</span></span>
<span><span class="st">| A (verm)   |  8  |  6  |</span></span>
<span><span class="st">| B (azul)   |  3  |  3  |</span></span>
<span><span class="st">| C (verde)  |  0  |  5  |</span></span>
<span><span class="st">|------------|-----|-----|</span></span>
<span><span class="st">'</span><span class="op">)</span></span></code></pre></div>
<p>|————|—–|—–|
| Comunidade | Sp1 | Sp2 |
|————|—–|—–|
| A (verm) | 8 | 6 |
| B (azul) | 3 | 3 |
| C (verde) | 0 | 5 |
|————|—–|—–|</p>
<div class="sourceCode" id="cb581"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">10</span>,<span class="fl">0</span><span class="op">:</span><span class="fl">10</span>,type<span class="op">=</span><span class="st">"n"</span>,xlab<span class="op">=</span><span class="st">"Abundância da Espécie 1"</span>,</span>
<span>     ylab<span class="op">=</span><span class="st">"Abundância da Espécie 2"</span>, frame.plot <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fl">8</span>,<span class="fl">6</span>, pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="fl">8.5</span>,<span class="fl">9</span>,labels<span class="op">=</span><span class="st">"Comunidade A"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span>, pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="fl">3.5</span>,<span class="fl">4</span>,labels<span class="op">=</span><span class="st">"Comunidade B"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span>, pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"green"</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="fl">0.8</span>,<span class="fl">6</span>,labels<span class="op">=</span><span class="st">"Comunidade C"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="fundamentos_de_ecologia_numerica_files/figure-html/unnamed-chunk-294-1.png" width="672"></div>
<p>Agora, considere um TERCEIRO eixo de abundância representando mais uma espécie.</p>
<div class="sourceCode" id="cb582"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">'</span></span>
<span><span class="st">|------------|-----|-----|-----|</span></span>
<span><span class="st">| Comunidade | Sp1 | Sp2 | Sp3 |</span></span>
<span><span class="st">|------------|-----|-----|-----|</span></span>
<span><span class="st">| A (verm)   |  8  |  6  |  7  |</span></span>
<span><span class="st">| B (azul)   |  3  |  3  |  3  |</span></span>
<span><span class="st">| C (verde)  |  0  |  5  |  5  |</span></span>
<span><span class="st">|------------|-----|-----|-----|</span></span>
<span><span class="st">'</span><span class="op">)</span></span></code></pre></div>
<p>|————|—–|—–|—–|
| Comunidade | Sp1 | Sp2 | Sp3 |
|————|—–|—–|—–|
| A (verm) | 8 | 6 | 7 |
| B (azul) | 3 | 3 | 3 |
| C (verde) | 0 | 5 | 5 |
|————|—–|—–|—–|</p>
<p>Para isso, precisaremos carregar outro pacote. Para instalar o pacote, utiliza-se o seguinte comando:</p>
<div class="sourceCode" id="cb583"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"scatterplot3d"</span><span class="op">)</span></span></code></pre></div>
<p>Este comando instalará o pacote “scatterplot3d” em seu ambiente R, permitindo que você crie gráficos tridimensionais para explorar a abundância de múltiplas espécies em suas comunidades.</p>
<div class="sourceCode" id="cb584"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">scatterplot3d</span><span class="op">)</span></span>
<span><span class="va">d</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/scatterplot3d/man/scatterplot3d.html">scatterplot3d</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">10</span>,<span class="fl">0</span><span class="op">:</span><span class="fl">10</span>,<span class="fl">0</span><span class="op">:</span><span class="fl">10</span>,type<span class="op">=</span><span class="st">"n"</span>,</span>
<span>                xlab<span class="op">=</span><span class="st">"Abundância da Espécie 1"</span>,</span>
<span>                ylab<span class="op">=</span><span class="st">"Abundância da Espécie 3"</span>,</span>
<span>                zlab<span class="op">=</span><span class="st">"Abundância da Espécie 2"</span>,</span>
<span>                angle <span class="op">=</span> <span class="fl">40</span><span class="op">)</span></span>
<span><span class="va">d</span><span class="op">$</span><span class="fu">points3d</span><span class="op">(</span><span class="fl">8</span>,<span class="fl">6</span>,<span class="fl">7</span>, pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="fu">xyz.convert</span><span class="op">(</span><span class="fl">9</span>,<span class="fl">6</span>,<span class="fl">8</span><span class="op">)</span>,labels<span class="op">=</span><span class="st">"Comunidade A"</span><span class="op">)</span></span>
<span><span class="va">d</span><span class="op">$</span><span class="fu">points3d</span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">3</span>, pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="fu">xyz.convert</span><span class="op">(</span><span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>,labels<span class="op">=</span><span class="st">"Comunidade B"</span><span class="op">)</span></span>
<span><span class="va">d</span><span class="op">$</span><span class="fu">points3d</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span>,<span class="fl">5</span>, pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"green"</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="fu">xyz.convert</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span>,<span class="fl">6</span><span class="op">)</span>,labels<span class="op">=</span><span class="st">"Comunidade C"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="fundamentos_de_ecologia_numerica_files/figure-html/unnamed-chunk-297-1.png" width="672"></div>
<p>Agora, em uma matriz n x m,</p>
<div class="sourceCode" id="cb585"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">'</span></span>
<span><span class="st">|------------|-----|-----|-----|-----|-----|-----|</span></span>
<span><span class="st">| Comunidade | Sp1 | Sp2 | Sp3 | Sp4 | Sp5 |  m  |</span></span>
<span><span class="st">|------------|-----|-----|-----|-----|-----|-----|</span></span>
<span><span class="st">| A (azul)   |  8  |  6  |  7  |  3  |  5  |  .  |</span></span>
<span><span class="st">| B (verde)  |  3  |  3  |  3  |  2  |  1  |  .  |</span></span>
<span><span class="st">| C (verm)   |  0  |  5  |  5  |  1  |  0  |  .  |</span></span>
<span><span class="st">| D (roxo)   |  2  |  4  |  3  |  0  |  1  |  .  |</span></span>
<span><span class="st">| n          |  .  |  .  |  .  |  .  |  .  |  .  |</span></span>
<span><span class="st">|------------|-----|-----|-----|-----|-----|-----|</span></span>
<span><span class="st">'</span><span class="op">)</span></span></code></pre></div>
<p>|————|—–|—–|—–|—–|—–|—–|
| Comunidade | Sp1 | Sp2 | Sp3 | Sp4 | Sp5 | m |
|————|—–|—–|—–|—–|—–|—–|
| A (azul) | 8 | 6 | 7 | 3 | 5 | . |
| B (verde) | 3 | 3 | 3 | 2 | 1 | . |
| C (verm) | 0 | 5 | 5 | 1 | 0 | . |
| D (roxo) | 2 | 4 | 3 | 0 | 1 | . |
| n | . | . | . | . | . | . |
|————|—–|—–|—–|—–|—–|—–|</p>
<div class="sourceCode" id="cb586"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dmurdoch/rgl">rgl</a></span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning: package 'rgl' was built under R version 4.3.1</code></pre>
<div class="sourceCode" id="cb588"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create the scatterplot3d object</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scatterplot3d/man/scatterplot3d.html">scatterplot3d</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">0</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">0</span><span class="op">:</span><span class="fl">10</span>, type <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>                   xlab <span class="op">=</span> <span class="st">"Abundância da Espécie 1"</span>,</span>
<span>                   ylab <span class="op">=</span> <span class="st">"Abundância da Espécie 3"</span>,</span>
<span>                   zlab <span class="op">=</span> <span class="st">"Abundância da Espécie 2"</span>,</span>
<span>                   xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, zlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, angle <span class="op">=</span> <span class="fl">40</span><span class="op">)</span></span>
<span><span class="co"># Add points and labels</span></span>
<span><span class="va">d</span><span class="op">$</span><span class="fu">points3d</span><span class="op">(</span><span class="fl">8</span>,<span class="fl">6</span>,<span class="fl">7</span>, pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="fu">xyz.convert</span><span class="op">(</span><span class="fl">9</span>, <span class="fl">6</span>, <span class="fl">8</span><span class="op">)</span>, labels <span class="op">=</span> <span class="st">"Comunidade A"</span><span class="op">)</span></span>
<span><span class="va">d</span><span class="op">$</span><span class="fu">points3d</span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span>, pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="fu">xyz.convert</span><span class="op">(</span><span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>, labels <span class="op">=</span> <span class="st">"Comunidade B"</span><span class="op">)</span></span>
<span><span class="va">d</span><span class="op">$</span><span class="fu">points3d</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">5</span>, pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"green"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="fu">xyz.convert</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span>, labels <span class="op">=</span> <span class="st">"Comunidade C"</span><span class="op">)</span></span>
<span><span class="va">d</span><span class="op">$</span><span class="fu">points3d</span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">3</span>, pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"purple"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="fu">xyz.convert</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">2</span><span class="op">)</span>, labels <span class="op">=</span> <span class="st">"Comunidade D"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="fundamentos_de_ecologia_numerica_files/figure-html/unnamed-chunk-299-1.png" width="672"></div>
<p>Podemos tentar um plot em 3D…</p>
<div class="sourceCode" id="cb589"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot the 3D plot</span></span>
<span><span class="co"># Open a new rgl device</span></span>
<span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/open3d.html">open3d</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## wgl 
##   1</code></pre>
<div class="sourceCode" id="cb591"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add points and labels to the 3D plot</span></span>
<span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/material.html">material3d</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, id <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/primitives.html">points3d</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">6</span>, <span class="fl">7</span>, pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/texts.html">text3d</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="st">"Comunidade A"</span>, adj <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/primitives.html">points3d</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span>, pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/texts.html">text3d</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="st">"Comunidade B"</span>, adj <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/primitives.html">points3d</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">5</span>, pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"green"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/texts.html">text3d</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">5</span>, <span class="st">"Comunidade C"</span>, adj <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/primitives.html">points3d</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">10</span>,<span class="fl">10</span>, pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/primitives.html">points3d</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>, pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/primitives.html">points3d</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">3</span>, pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"purple"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/texts.html">text3d</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">3</span>, <span class="st">"Comunidade D"</span>, adj <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Add axes</span></span>
<span><span class="co">#?axes3d</span></span>
<span><span class="co">#axes3d()</span></span>
<span><span class="co"># Put 4 x-axes on the plot</span></span>
<span><span class="co">#axes3d(c('x--', 'x-+', 'x+-', 'x++'))</span></span>
<span><span class="co">## Use fixed axes</span></span>
<span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/axes3d.html">axes3d</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'x'</span>, <span class="st">'y'</span>, <span class="st">'z'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/axes3d.html">axis3d</a></span><span class="op">(</span><span class="st">'y'</span>, pos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="cn">NA</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/axes3d.html">title3d</a></span><span class="op">(</span><span class="st">''</span>, <span class="st">''</span>, <span class="st">'Abundancia da Especie 1'</span>, <span class="st">'Abundancia da Especie 3'</span>, <span class="st">'Abundancia da Especie 2'</span><span class="op">)</span></span>
<span><span class="co"># Rotate the plot interactively</span></span>
<span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/rglwidget.html">rglwidget</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div id="rgl2611" style="width:672px;height:480px;" class="rglWebGL html-widget "></div>
<script type="application/json" data-for="rgl2611">{"x":{"material":{"color":"#000000","alpha":1,"lit":true,"ambient":"#000000","specular":"#FFFFFF","emission":"#000000","shininess":50,"smooth":true,"front":"filled","back":"filled","size":10,"lwd":1,"fog":true,"point_antialias":false,"line_antialias":false,"texture":null,"textype":"rgb","texmode":"modulate","texmipmap":false,"texminfilter":"linear","texmagfilter":"linear","texenvmap":false,"depth_mask":true,"depth_test":"less","isTransparent":false,"polygon_offset":[0,0],"margin":"","floating":false,"tag":"","blend":["src_alpha","one_minus_src_alpha"]},"rootSubscene":7,"objects":{"13":{"id":13,"type":"points","material":{"lit":false},"vertices":"0","colors":"1","centers":"2","ignoreExtent":false,"flags":34816},"14":{"id":14,"type":"text","material":{"lit":false},"vertices":"3","colors":"4","texts":[["Comunidade A"]],"cex":[[1]],"adj":[[-0.1,0,0.5]],"centers":"5","family":[["sans"]],"font":[[1]],"ignoreExtent":false,"flags":33808},"15":{"id":15,"type":"points","material":{"lit":false},"vertices":"6","colors":"7","centers":"8","ignoreExtent":false,"flags":34816},"16":{"id":16,"type":"text","material":{"lit":false},"vertices":"9","colors":"10","texts":[["Comunidade B"]],"cex":[[1]],"adj":[[-0.1,0,0.5]],"centers":"11","family":[["sans"]],"font":[[1]],"ignoreExtent":false,"flags":33808},"17":{"id":17,"type":"points","material":{"lit":false},"vertices":"12","colors":"13","centers":"14","ignoreExtent":false,"flags":34816},"18":{"id":18,"type":"text","material":{"lit":false},"vertices":"15","colors":"16","texts":[["Comunidade C"]],"cex":[[1]],"adj":[[-0.1,0,0.5]],"centers":"17","family":[["sans"]],"font":[[1]],"ignoreExtent":false,"flags":33808},"19":{"id":19,"type":"points","material":{"lit":false},"vertices":"18","colors":"19","centers":"20","ignoreExtent":false,"flags":34816},"20":{"id":20,"type":"points","material":{"lit":false},"vertices":"21","colors":"22","centers":"23","ignoreExtent":false,"flags":34816},"21":{"id":21,"type":"points","material":{"lit":false},"vertices":"24","colors":"25","centers":"26","ignoreExtent":false,"flags":34816},"22":{"id":22,"type":"text","material":{"lit":false},"vertices":"27","colors":"28","texts":[["Comunidade D"]],"cex":[[1]],"adj":[[-0.1,0,0.5]],"centers":"29","family":[["sans"]],"font":[[1]],"ignoreExtent":false,"flags":33808},"23":{"id":23,"type":"lines","material":{"lit":false},"vertices":"30","colors":"31","centers":"32","ignoreExtent":true,"flags":32832},"24":{"id":24,"type":"text","material":{"lit":false},"vertices":"33","colors":"34","texts":[[" 0"],[" 2"],[" 4"],[" 6"],[" 8"],["10"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"35","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"25":{"id":25,"type":"lines","material":{"lit":false},"vertices":"36","colors":"37","centers":"38","ignoreExtent":true,"flags":32832},"26":{"id":26,"type":"text","material":{"lit":false},"vertices":"39","colors":"40","texts":[[" 0"],[" 2"],[" 4"],[" 6"],[" 8"],["10"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"41","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"27":{"id":27,"type":"lines","material":{"lit":false},"vertices":"42","colors":"43","centers":"44","ignoreExtent":true,"flags":32832},"28":{"id":28,"type":"text","material":{"lit":false},"vertices":"45","colors":"46","texts":[[" 0"],[" 2"],[" 4"],[" 6"],[" 8"],["10"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"47","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"29":{"id":29,"type":"lines","material":{"lit":false},"vertices":"48","colors":"49","centers":"50","ignoreExtent":true,"flags":32832},"30":{"id":30,"type":"text","material":{"lit":false},"vertices":"51","colors":"52","texts":[[" 0"],[" 2"],[" 4"],[" 6"],[" 8"],["10"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"53","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"32":{"id":32,"type":"text","material":{"lit":false,"margin":0,"edge":[0,1,1]},"vertices":"54","colors":"55","texts":[[""]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"56","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"33":{"id":33,"type":"text","material":{"lit":false,"margin":0,"edge":[0,-1,-1]},"vertices":"57","colors":"58","texts":[[""]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"59","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"34":{"id":34,"type":"text","material":{"lit":false,"margin":0,"floating":true,"edge":[0,1,1]},"vertices":"60","colors":"61","texts":[["Abundancia da Especie 1"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"62","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"35":{"id":35,"type":"text","material":{"lit":false,"margin":1,"floating":true,"edge":[1,1,1]},"vertices":"63","colors":"64","texts":[["Abundancia da Especie 3"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"65","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"36":{"id":36,"type":"text","material":{"lit":false,"margin":2,"floating":true,"edge":[1,1,1]},"vertices":"66","colors":"67","texts":[["Abundancia da Especie 2"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"68","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"11":{"id":11,"type":"light","vertices":[[0,0,1]],"colors":[[1,1,1,1],[1,1,1,1],[1,1,1,1]],"viewpoint":true,"finite":false},"10":{"id":10,"type":"background","material":{"size":3},"colors":"69","centers":"70","sphere":false,"fogtype":"none","fogscale":1,"flags":32768},"12":{"id":12,"type":"background","material":{"lit":false,"back":"lines","size":3},"colors":"71","centers":"72","sphere":false,"fogtype":"none","fogscale":1,"flags":32768},"31":{"id":31,"type":"bboxdeco","material":{"front":"culled","back":"culled"},"colors":"73","axes":{"mode":["none","none","none"],"step":[-1,-1,-1],"nticks":[0,0,0],"marklen":[15,15,15],"expand":[1.02999997138977,1.02999997138977,1.02999997138977]},"draw_front":false,"flags":32769},"7":{"id":7,"type":"subscene","par3d":{"antialias":8,"FOV":30,"ignoreExtent":false,"listeners":7,"mouseMode":{"none":"none","left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,42.383487701416],"modelMatrix":[[1,0,0,-5],[0,0.342020153999329,0.939692616462708,-6.4085636138916],[0,-0.939692616462708,0.342020153999329,-39.3951263427734],[0,0,0,1]],"projMatrix":[[3.73205065727234,0,0,0],[0,3.73205065727234,0,0],[0,0,-3.86370325088501,-152.787567138672],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.342020143325668,0.939692620785909,0],[0,-0.939692620785909,0.342020143325668,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[1,1,1],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":1,"bbox":[0,10,0,10,0,10],"windowRect":[190,213,446,469],"family":"sans","font":1,"cex":1,"useFreeType":false,"fontname":"TT Arial","maxClipPlanes":8,"glVersion":4.6,"activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"replace"},"objects":[12,31,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,32,33,34,35,36,11],"subscenes":[],"flags":36177}},"crosstalk":{"key":[],"group":[],"id":[],"options":[]},"width":672,"height":480,"buffer":{"accessors":[{"bufferView":0,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":1,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":2,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":3,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":4,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":5,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":6,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":7,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":8,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":9,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":10,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":11,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":12,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":13,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":14,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":15,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":16,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":17,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":18,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":19,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":20,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":21,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":22,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":23,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":24,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":25,"componentType":5126,"count":1,"type":"VEC4"},{"bufferView":26,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":27,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":28,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":29,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":30,"componentType":5126,"count":14,"type":"VEC3"},{"bufferView":31,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":32,"componentType":5126,"count":7,"type":"VEC3"},{"bufferView":33,"componentType":5126,"count":6,"type":"VEC3"},{"bufferView":34,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":35,"componentType":5126,"count":6,"type":"VEC3"},{"bufferView":36,"componentType":5126,"count":14,"type":"VEC3"},{"bufferView":37,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":38,"componentType":5126,"count":7,"type":"VEC3"},{"bufferView":39,"componentType":5126,"count":6,"type":"VEC3"},{"bufferView":40,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":41,"componentType":5126,"count":6,"type":"VEC3"},{"bufferView":42,"componentType":5126,"count":14,"type":"VEC3"},{"bufferView":43,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":44,"componentType":5126,"count":7,"type":"VEC3"},{"bufferView":45,"componentType":5126,"count":6,"type":"VEC3"},{"bufferView":46,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":47,"componentType":5126,"count":6,"type":"VEC3"},{"bufferView":48,"componentType":5126,"count":14,"type":"VEC3"},{"bufferView":49,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":50,"componentType":5126,"count":7,"type":"VEC3"},{"bufferView":51,"componentType":5126,"count":6,"type":"VEC3"},{"bufferView":52,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":53,"componentType":5126,"count":6,"type":"VEC3"},{"bufferView":54,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":55,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":56,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":57,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":58,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":59,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":60,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":61,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":62,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":63,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":64,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":65,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":66,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":67,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":68,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":69,"componentType":5126,"count":1,"type":"VEC4"},{"bufferView":70,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":71,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":72,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":73,"componentType":5121,"count":1,"type":"VEC4"}],"bufferViews":[{"buffer":0,"byteLength":3,"byteOffset":0},{"buffer":0,"byteLength":4,"byteOffset":3},{"buffer":0,"byteLength":3,"byteOffset":7},{"buffer":0,"byteLength":3,"byteOffset":10},{"buffer":0,"byteLength":4,"byteOffset":13},{"buffer":0,"byteLength":3,"byteOffset":17},{"buffer":0,"byteLength":3,"byteOffset":20},{"buffer":0,"byteLength":4,"byteOffset":23},{"buffer":0,"byteLength":3,"byteOffset":27},{"buffer":0,"byteLength":3,"byteOffset":30},{"buffer":0,"byteLength":4,"byteOffset":33},{"buffer":0,"byteLength":3,"byteOffset":37},{"buffer":0,"byteLength":3,"byteOffset":40},{"buffer":0,"byteLength":4,"byteOffset":43},{"buffer":0,"byteLength":3,"byteOffset":47},{"buffer":0,"byteLength":3,"byteOffset":50},{"buffer":0,"byteLength":4,"byteOffset":53},{"buffer":0,"byteLength":3,"byteOffset":57},{"buffer":0,"byteLength":3,"byteOffset":60},{"buffer":0,"byteLength":4,"byteOffset":63},{"buffer":0,"byteLength":3,"byteOffset":67},{"buffer":0,"byteLength":3,"byteOffset":70},{"buffer":0,"byteLength":4,"byteOffset":73},{"buffer":0,"byteLength":3,"byteOffset":77},{"buffer":0,"byteLength":3,"byteOffset":80},{"buffer":0,"byteLength":16,"byteOffset":84},{"buffer":0,"byteLength":3,"byteOffset":100},{"buffer":0,"byteLength":3,"byteOffset":103},{"buffer":0,"byteLength":4,"byteOffset":106},{"buffer":0,"byteLength":3,"byteOffset":110},{"buffer":0,"byteLength":168,"byteOffset":116},{"buffer":0,"byteLength":4,"byteOffset":284},{"buffer":0,"byteLength":84,"byteOffset":288},{"buffer":0,"byteLength":72,"byteOffset":372},{"buffer":0,"byteLength":4,"byteOffset":444},{"buffer":0,"byteLength":72,"byteOffset":448},{"buffer":0,"byteLength":168,"byteOffset":520},{"buffer":0,"byteLength":4,"byteOffset":688},{"buffer":0,"byteLength":84,"byteOffset":692},{"buffer":0,"byteLength":72,"byteOffset":776},{"buffer":0,"byteLength":4,"byteOffset":848},{"buffer":0,"byteLength":72,"byteOffset":852},{"buffer":0,"byteLength":168,"byteOffset":924},{"buffer":0,"byteLength":4,"byteOffset":1092},{"buffer":0,"byteLength":84,"byteOffset":1096},{"buffer":0,"byteLength":72,"byteOffset":1180},{"buffer":0,"byteLength":4,"byteOffset":1252},{"buffer":0,"byteLength":72,"byteOffset":1256},{"buffer":0,"byteLength":168,"byteOffset":1328},{"buffer":0,"byteLength":4,"byteOffset":1496},{"buffer":0,"byteLength":84,"byteOffset":1500},{"buffer":0,"byteLength":72,"byteOffset":1584},{"buffer":0,"byteLength":4,"byteOffset":1656},{"buffer":0,"byteLength":72,"byteOffset":1660},{"buffer":0,"byteLength":12,"byteOffset":1732},{"buffer":0,"byteLength":4,"byteOffset":1744},{"buffer":0,"byteLength":12,"byteOffset":1748},{"buffer":0,"byteLength":12,"byteOffset":1760},{"buffer":0,"byteLength":4,"byteOffset":1772},{"buffer":0,"byteLength":12,"byteOffset":1776},{"buffer":0,"byteLength":12,"byteOffset":1788},{"buffer":0,"byteLength":4,"byteOffset":1800},{"buffer":0,"byteLength":12,"byteOffset":1804},{"buffer":0,"byteLength":12,"byteOffset":1816},{"buffer":0,"byteLength":4,"byteOffset":1828},{"buffer":0,"byteLength":12,"byteOffset":1832},{"buffer":0,"byteLength":12,"byteOffset":1844},{"buffer":0,"byteLength":4,"byteOffset":1856},{"buffer":0,"byteLength":12,"byteOffset":1860},{"buffer":0,"byteLength":16,"byteOffset":1872},{"buffer":0,"byteLength":3,"byteOffset":1888},{"buffer":0,"byteLength":4,"byteOffset":1891},{"buffer":0,"byteLength":3,"byteOffset":1895},{"buffer":0,"byteLength":4,"byteOffset":1898}],"buffers":[{"byteLength":1902,"bytes":"CAYHAQAAAQgGBwgGBwAAAAEIBgcDAwMAAAEBAwMDAwMDAAAAAQMDAwAFBQABAAEABQUABQUA\nAAABAAUFCgoKAQEBAQoKCgAAAAEBAQEAAAACBAMAoaAgP4GAAD7x8HA/AACAPwIEAwIEAwAA\nAAECBAMAAAAAAAAAmpkZvpqZGb4AACBBmpkZvpqZGb4AAAAAmpkZvpqZGb4AAAAA16PQvtej\n0L4AAABAmpkZvpqZGb4AAABA16PQvtej0L4AAIBAmpkZvpqZGb4AAIBA16PQvtej0L4AAMBA\nmpkZvpqZGb4AAMBA16PQvtej0L4AAABBmpkZvpqZGb4AAABB16PQvtej0L4AACBBmpkZvpqZ\nGb4AACBB16PQvtej0L4AAAABAACgQJqZGb6amRm+AAAAAFK4jr5SuI6+AAAAQFK4jr5SuI6+\nAACAQFK4jr5SuI6+AADAQFK4jr5SuI6+AAAAQVK4jr5SuI6+AAAgQVK4jr5SuI6+AAAAAPYo\nbL/2KGy/AAAAQPYobL/2KGy/AACAQPYobL/2KGy/AADAQPYobL/2KGy/AAAAQfYobL/2KGy/\nAAAgQfYobL/2KGy/AAAAAQAAAAD2KGy/9ihsvwAAAED2KGy/9ihsvwAAgED2KGy/9ihsvwAA\nwED2KGy/9ihsvwAAAEH2KGy/9ihsvwAAIEH2KGy/9ihsv5qZGb4AAAAAmpkZvpqZGb4AACBB\nmpkZvpqZGb4AAAAAmpkZvtej0L4AAAAA16PQvpqZGb4AAABAmpkZvtej0L4AAABA16PQvpqZ\nGb4AAIBAmpkZvtej0L4AAIBA16PQvpqZGb4AAMBAmpkZvtej0L4AAMBA16PQvpqZGb4AAABB\nmpkZvtej0L4AAABB16PQvpqZGb4AACBBmpkZvtej0L4AACBB16PQvgAAAAGamRm+AACgQJqZ\nGb5SuI6+AAAAAFK4jr5SuI6+AAAAQFK4jr5SuI6+AACAQFK4jr5SuI6+AADAQFK4jr5SuI6+\nAAAAQVK4jr5SuI6+AAAgQVK4jr72KGy/AAAAAPYobL/2KGy/AAAAQPYobL/2KGy/AACAQPYo\nbL/2KGy/AADAQPYobL/2KGy/AAAAQfYobL/2KGy/AAAgQfYobL8AAAAB9ihsvwAAAAD2KGy/\n9ihsvwAAAED2KGy/9ihsvwAAgED2KGy/9ihsvwAAwED2KGy/9ihsvwAAAEH2KGy/9ihsvwAA\nIEH2KGy/mpkZvpqZGb4AAAAAmpkZvpqZGb4AACBBmpkZvpqZGb4AAAAA16PQvtej0L4AAAAA\nmpkZvpqZGb4AAABA16PQvtej0L4AAABAmpkZvpqZGb4AAIBA16PQvtej0L4AAIBAmpkZvpqZ\nGb4AAMBA16PQvtej0L4AAMBAmpkZvpqZGb4AAABB16PQvtej0L4AAABBmpkZvpqZGb4AACBB\n16PQvtej0L4AACBBAAAAAZqZGb6amRm+AACgQFK4jr5SuI6+AAAAAFK4jr5SuI6+AAAAQFK4\njr5SuI6+AACAQFK4jr5SuI6+AADAQFK4jr5SuI6+AAAAQVK4jr5SuI6+AAAgQfYobL/2KGy/\nAAAAAPYobL/2KGy/AAAAQPYobL/2KGy/AACAQPYobL/2KGy/AADAQPYobL/2KGy/AAAAQfYo\nbL/2KGy/AAAgQQAAAAH2KGy/9ihsvwAAAAD2KGy/9ihsvwAAAED2KGy/9ihsvwAAgED2KGy/\n9ihsvwAAwED2KGy/9ihsvwAAAEH2KGy/9ihsvwAAIEEAAKBAAAAAAAAAoEAAAKBAAAAgQQAA\noEAAAKBAAAAAAAAAoECPwpdAAAAAAI/Cl0AAAKBAAAAAQAAAoECPwpdAAAAAQI/Cl0AAAKBA\nAACAQAAAoECPwpdAAACAQI/Cl0AAAKBAAADAQAAAoECPwpdAAADAQI/Cl0AAAKBAAAAAQQAA\noECPwpdAAAAAQY/Cl0AAAKBAAAAgQQAAoECPwpdAAAAgQY/Cl0AAAAABAACgQAAAoEAAAKBA\nSOGbQAAAAABI4ZtASOGbQAAAAEBI4ZtASOGbQAAAgEBI4ZtASOGbQAAAwEBI4ZtASOGbQAAA\nAEFI4ZtASOGbQAAAIEFI4ZtArkeHQAAAAACuR4dArkeHQAAAAECuR4dArkeHQAAAgECuR4dA\nrkeHQAAAwECuR4dArkeHQAAAAEGuR4dArkeHQAAAIEGuR4dAAAAAAa5Hh0AAAAAArkeHQK5H\nh0AAAABArkeHQK5Hh0AAAIBArkeHQK5Hh0AAAMBArkeHQK5Hh0AAAABBrkeHQK5Hh0AAACBB\nrkeHQAAAwH8AAABAAAAAQAAAAAEAAMB/AAAAQAAAAEAAAMB/AAAAQAAAAAAAAAABAADAfwAA\nAEAAAAAAAADAfwAAgEAAAIA/AAAAAQAAwH8AAIBAAACAPwAAwH8AAIBAAACAPwAAAAEAAMB/\nAACAQAAAgD8AAMB/AACAQAAAgD8AAAABAADAfwAAgEAAAIA/mZiYPpmYmD6ZmJg+AACAPwAA\nAAEBAQEAAAAAAAAB"}]},"context":{"shiny":false,"rmarkdown":"bookdown::gitbook"},"vertexShader":"#line 2 1\n// File 1 is the vertex shader\n#ifdef GL_ES\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n#endif\n\nattribute vec3 aPos;\nattribute vec4 aCol;\nuniform mat4 mvMatrix;\nuniform mat4 prMatrix;\nvarying vec4 vCol;\nvarying vec4 vPosition;\n\n#ifdef NEEDS_VNORMAL\nattribute vec3 aNorm;\nuniform mat4 normMatrix;\nvarying vec4 vNormal;\n#endif\n\n#if defined(HAS_TEXTURE) || defined (IS_TEXT)\nattribute vec2 aTexcoord;\nvarying vec2 vTexcoord;\n#endif\n\n#ifdef FIXED_SIZE\nuniform vec3 textScale;\n#endif\n\n#ifdef FIXED_QUADS\nattribute vec3 aOfs;\n#endif\n\n#ifdef IS_TWOSIDED\n#ifdef HAS_NORMALS\nvarying float normz;\nuniform mat4 invPrMatrix;\n#else\nattribute vec3 aPos1;\nattribute vec3 aPos2;\nvarying float normz;\n#endif\n#endif // IS_TWOSIDED\n\n#ifdef FAT_LINES\nattribute vec3 aNext;\nattribute vec2 aPoint;\nvarying vec2 vPoint;\nvarying float vLength;\nuniform float uAspect;\nuniform float uLwd;\n#endif\n\n#ifdef USE_ENVMAP\nvarying vec3 vReflection;\n#endif\n\nvoid main(void) {\n  \n#ifndef IS_BRUSH\n#if defined(NCLIPPLANES) || !defined(FIXED_QUADS) || defined(HAS_FOG) || defined(USE_ENVMAP)\n  vPosition = mvMatrix * vec4(aPos, 1.);\n#endif\n  \n#ifndef FIXED_QUADS\n  gl_Position = prMatrix * vPosition;\n#endif\n#endif // !IS_BRUSH\n  \n#ifdef IS_POINTS\n  gl_PointSize = POINTSIZE;\n#endif\n  \n  vCol = aCol;\n  \n// USE_ENVMAP implies NEEDS_VNORMAL\n\n#ifdef NEEDS_VNORMAL\n  vNormal = normMatrix * vec4(-aNorm, dot(aNorm, aPos));\n#endif\n\n#ifdef USE_ENVMAP\n  vReflection = normalize(reflect(vPosition.xyz/vPosition.w, \n                        normalize(vNormal.xyz/vNormal.w)));\n#endif\n  \n#ifdef IS_TWOSIDED\n#ifdef HAS_NORMALS\n  /* normz should be calculated *after* projection */\n  normz = (invPrMatrix*vNormal).z;\n#else\n  vec4 pos1 = prMatrix*(mvMatrix*vec4(aPos1, 1.));\n  pos1 = pos1/pos1.w - gl_Position/gl_Position.w;\n  vec4 pos2 = prMatrix*(mvMatrix*vec4(aPos2, 1.));\n  pos2 = pos2/pos2.w - gl_Position/gl_Position.w;\n  normz = pos1.x*pos2.y - pos1.y*pos2.x;\n#endif\n#endif // IS_TWOSIDED\n  \n#ifdef NEEDS_VNORMAL\n  vNormal = vec4(normalize(vNormal.xyz/vNormal.w), 1);\n#endif\n  \n#if defined(HAS_TEXTURE) || defined(IS_TEXT)\n  vTexcoord = aTexcoord;\n#endif\n  \n#if defined(FIXED_SIZE) && !defined(ROTATING)\n  vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);\n  pos = pos/pos.w;\n  gl_Position = pos + vec4(aOfs*textScale, 0.);\n#endif\n  \n#if defined(IS_SPRITES) && !defined(FIXED_SIZE)\n  vec4 pos = mvMatrix * vec4(aPos, 1.);\n  pos = pos/pos.w + vec4(aOfs,  0.);\n  gl_Position = prMatrix*pos;\n#endif\n  \n#ifdef FAT_LINES\n  /* This code was inspired by Matt Deslauriers' code in \n   https://mattdesl.svbtle.com/drawing-lines-is-hard */\n  vec2 aspectVec = vec2(uAspect, 1.0);\n  mat4 projViewModel = prMatrix * mvMatrix;\n  vec4 currentProjected = projViewModel * vec4(aPos, 1.0);\n  currentProjected = currentProjected/currentProjected.w;\n  vec4 nextProjected = projViewModel * vec4(aNext, 1.0);\n  vec2 currentScreen = currentProjected.xy * aspectVec;\n  vec2 nextScreen = (nextProjected.xy / nextProjected.w) * aspectVec;\n  float len = uLwd;\n  vec2 dir = vec2(1.0, 0.0);\n  vPoint = aPoint;\n  vLength = length(nextScreen - currentScreen)/2.0;\n  vLength = vLength/(vLength + len);\n  if (vLength > 0.0) {\n    dir = normalize(nextScreen - currentScreen);\n  }\n  vec2 normal = vec2(-dir.y, dir.x);\n  dir.x /= uAspect;\n  normal.x /= uAspect;\n  vec4 offset = vec4(len*(normal*aPoint.x*aPoint.y - dir), 0.0, 0.0);\n  gl_Position = currentProjected + offset;\n#endif\n  \n#ifdef IS_BRUSH\n  gl_Position = vec4(aPos, 1.);\n#endif\n}","fragmentShader":"#line 2 2\n// File 2 is the fragment shader\n#ifdef GL_ES\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n#endif\nvarying vec4 vCol; // carries alpha\nvarying vec4 vPosition;\n#if defined(HAS_TEXTURE) || defined (IS_TEXT)\nvarying vec2 vTexcoord;\nuniform sampler2D uSampler;\n#endif\n\n#ifdef HAS_FOG\nuniform int uFogMode;\nuniform vec3 uFogColor;\nuniform vec4 uFogParms;\n#endif\n\n#if defined(IS_LIT) && !defined(FIXED_QUADS)\nvarying vec4 vNormal;\n#endif\n\n#if NCLIPPLANES > 0\nuniform vec4 vClipplane[NCLIPPLANES];\n#endif\n\n#if NLIGHTS > 0\nuniform mat4 mvMatrix;\n#endif\n\n#ifdef IS_LIT\nuniform vec3 emission;\nuniform float shininess;\n#if NLIGHTS > 0\nuniform vec3 ambient[NLIGHTS];\nuniform vec3 specular[NLIGHTS]; // light*material\nuniform vec3 diffuse[NLIGHTS];\nuniform vec3 lightDir[NLIGHTS];\nuniform bool viewpoint[NLIGHTS];\nuniform bool finite[NLIGHTS];\n#endif\n#endif // IS_LIT\n\n#ifdef IS_TWOSIDED\nuniform bool front;\nvarying float normz;\n#endif\n\n#ifdef FAT_LINES\nvarying vec2 vPoint;\nvarying float vLength;\n#endif\n\n#ifdef USE_ENVMAP\nvarying vec3 vReflection;\n#endif\n\nvoid main(void) {\n  vec4 fragColor;\n#ifdef FAT_LINES\n  vec2 point = vPoint;\n  bool neg = point.y < 0.0;\n  point.y = neg ? (point.y + vLength)/(1.0 - vLength) :\n                 -(point.y - vLength)/(1.0 - vLength);\n#if defined(IS_TRANSPARENT) && defined(IS_LINESTRIP)\n  if (neg && length(point) <= 1.0) discard;\n#endif\n  point.y = min(point.y, 0.0);\n  if (length(point) > 1.0) discard;\n#endif // FAT_LINES\n  \n#ifdef ROUND_POINTS\n  vec2 coord = gl_PointCoord - vec2(0.5);\n  if (length(coord) > 0.5) discard;\n#endif\n  \n#if NCLIPPLANES > 0\n  for (int i = 0; i < NCLIPPLANES; i++)\n    if (dot(vPosition, vClipplane[i]) < 0.0) discard;\n#endif\n    \n#ifdef FIXED_QUADS\n    vec3 n = vec3(0., 0., 1.);\n#elif defined(IS_LIT)\n    vec3 n = normalize(vNormal.xyz);\n#endif\n    \n#ifdef IS_TWOSIDED\n    if ((normz <= 0.) != front) discard;\n#endif\n\n#ifdef IS_LIT\n    vec3 eye = normalize(-vPosition.xyz/vPosition.w);\n    vec3 lightdir;\n    vec4 colDiff;\n    vec3 halfVec;\n    vec4 lighteffect = vec4(emission, 0.);\n    vec3 col;\n    float nDotL;\n#ifdef FIXED_QUADS\n    n = -faceforward(n, n, eye);\n#endif\n    \n#if NLIGHTS > 0\n    for (int i=0;i<NLIGHTS;i++) {\n      colDiff = vec4(vCol.rgb * diffuse[i], vCol.a);\n      lightdir = lightDir[i];\n      if (!viewpoint[i])\n        lightdir = (mvMatrix * vec4(lightdir, 1.)).xyz;\n      if (!finite[i]) {\n        halfVec = normalize(lightdir + eye);\n      } else {\n        lightdir = normalize(lightdir - vPosition.xyz/vPosition.w);\n        halfVec = normalize(lightdir + eye);\n      }\n      col = ambient[i];\n      nDotL = dot(n, lightdir);\n      col = col + max(nDotL, 0.) * colDiff.rgb;\n      col = col + pow(max(dot(halfVec, n), 0.), shininess) * specular[i];\n      lighteffect = lighteffect + vec4(col, colDiff.a);\n    }\n#endif\n    \n#else // not IS_LIT\n    vec4 colDiff = vCol;\n    vec4 lighteffect = colDiff;\n#endif\n    \n#ifdef IS_TEXT\n    vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);\n#endif\n    \n#ifdef HAS_TEXTURE\n\n// These calculations use the definitions from \n// https://docs.gl/gl3/glTexEnv\n\n#ifdef USE_ENVMAP\n    float m = 2.0 * sqrt(dot(vReflection, vReflection) + 2.0*vReflection.z + 1.0);\n    vec4 textureColor = texture2D(uSampler, vReflection.xy / m + vec2(0.5, 0.5));\n#else\n    vec4 textureColor = texture2D(uSampler, vTexcoord);\n#endif\n\n#ifdef TEXTURE_rgb\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(textureColor.rgb, lighteffect.a);\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = lighteffect*vec4(textureColor.rgb, 1.);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - textureColor.rgb) * lighteffect.rgb, lighteffect.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(lighteffect.rgb + textureColor.rgb, lighteffect.a);\n#endif\n\n#endif //TEXTURE_rgb\n        \n#ifdef TEXTURE_rgba\n\n#ifdef TEXMODE_replace\n// already done\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = lighteffect*textureColor;\n#endif\n\n#ifdef TEXMODE_decal\n    textureColor = vec4((1. - textureColor.a)*lighteffect.rgb) +\n                     textureColor.a*textureColor.rgb, \n                     lighteffect.a);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - textureColor.rgb) * lighteffect.rgb,\n                    lighteffect.a*textureColor.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(lighteffect.rgb + textureColor.rgb,\n                    lighteffect.a*textureColor.a);\n#endif\n    \n#endif //TEXTURE_rgba\n    \n#ifdef TEXTURE_alpha\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(lighteffect.rgb, textureColor.a);\n#endif \n\n#if defined(TEXMODE_modulate) || defined(TEXMODE_blend) || defined(TEXMODE_add)\n    textureColor = vec4(lighteffect.rgb, lighteffect.a*textureColor.a);\n#endif\n \n#endif\n    \n// The TEXTURE_luminance values are not from that reference    \n#ifdef TEXTURE_luminance\n    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(luminance, luminance, luminance, lighteffect.a);\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = vec4(luminance*lighteffect.rgb, lighteffect.a);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - luminance)*lighteffect.rgb,\n                        lighteffect.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(luminance + lighteffect.rgb, lighteffect.a);\n#endif\n\n#endif // TEXTURE_luminance\n \n    \n#ifdef TEXTURE_luminance_alpha\n    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(luminance, luminance, luminance, textureColor.a);\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = vec4(luminance*lighteffect.rgb, \n                        textureColor.a*lighteffect.a);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - luminance)*lighteffect.rgb,\n                        textureColor.a*lighteffect.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(luminance + lighteffect.rgb, \n                        textureColor.a*lighteffect.a);\n\n#endif\n\n#endif // TEXTURE_luminance_alpha\n    \n    fragColor = textureColor;\n\n#elif defined(IS_TEXT)\n    if (textureColor.a < 0.1)\n      discard;\n    else\n      fragColor = textureColor;\n#else\n    fragColor = lighteffect;\n#endif // HAS_TEXTURE\n    \n#ifdef HAS_FOG\n    // uFogParms elements: x = near, y = far, z = fogscale, w = (1-sin(FOV/2))/(1+sin(FOV/2))\n    // In Exp and Exp2: use density = density/far\n    // fogF will be the proportion of fog\n    // Initialize it to the linear value\n    float fogF;\n    if (uFogMode > 0) {\n      fogF = (uFogParms.y - vPosition.z/vPosition.w)/(uFogParms.y - uFogParms.x);\n      if (uFogMode > 1)\n        fogF = mix(uFogParms.w, 1.0, fogF);\n      fogF = fogF*uFogParms.z;\n      if (uFogMode == 2)\n        fogF = 1.0 - exp(-fogF);\n      // Docs are wrong: use (density*c)^2, not density*c^2\n      // https://gitlab.freedesktop.org/mesa/mesa/-/blob/master/src/mesa/swrast/s_fog.c#L58\n      else if (uFogMode == 3)\n        fogF = 1.0 - exp(-fogF*fogF);\n      fogF = clamp(fogF, 0.0, 1.0);\n      gl_FragColor = vec4(mix(fragColor.rgb, uFogColor, fogF), fragColor.a);\n    } else gl_FragColor = fragColor;\n#else\n    gl_FragColor = fragColor;\n#endif // HAS_FOG\n    \n}","players":[],"webGLoptions":{"preserveDrawingBuffer":true}},"evals":[],"jsHooks":[]}</script><div class="sourceCode" id="cb592"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Origin"</span>, <span class="st">"Sp1"</span>, <span class="st">"Sp3"</span>, <span class="st">"Sp2"</span><span class="op">)</span></span>
<span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">8</span>,<span class="fl">6</span>,<span class="fl">7</span><span class="op">)</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#*3d interface</span></span>
<span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/open3d.html">open3d</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## wgl 
##   3</code></pre>
<div class="sourceCode" id="cb594"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/texts.html">text3d</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,<span class="va">z</span>,<span class="va">labels</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/primitives.html">points3d</a></span><span class="op">(</span><span class="va">A</span>,col <span class="op">=</span> <span class="st">'blue'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/primitives.html">points3d</a></span><span class="op">(</span><span class="va">B</span>,col <span class="op">=</span> <span class="st">'green'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/primitives.html">points3d</a></span><span class="op">(</span><span class="va">C</span>,col <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/texts.html">text3d</a></span><span class="op">(</span><span class="fl">8</span>,<span class="fl">6</span>,<span class="fl">7</span>, <span class="st">"Comunidade A"</span>, adj <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/texts.html">text3d</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">3</span>, <span class="st">"Comunidade B"</span>, adj <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/texts.html">text3d</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span>,<span class="fl">5</span>, <span class="st">"Comunidade C"</span>, adj <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/primitives.html">segments3d</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">y</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">z</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/rglwidget.html">rglwidget</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div id="rgl69335" style="width:672px;height:480px;" class="rglWebGL html-widget "></div>
<script type="application/json" data-for="rgl69335">{"x":{"material":{"color":"#000000","alpha":1,"lit":true,"ambient":"#000000","specular":"#FFFFFF","emission":"#000000","shininess":50,"smooth":true,"front":"filled","back":"filled","size":3,"lwd":1,"fog":true,"point_antialias":false,"line_antialias":false,"texture":null,"textype":"rgb","texmode":"modulate","texmipmap":false,"texminfilter":"linear","texmagfilter":"linear","texenvmap":false,"depth_mask":true,"depth_test":"less","isTransparent":false,"polygon_offset":[0,0],"margin":"","floating":false,"tag":"","blend":["src_alpha","one_minus_src_alpha"]},"rootSubscene":43,"objects":{"49":{"id":49,"type":"text","material":{"lit":false},"vertices":"0","colors":"1","texts":[["Origin"],["Sp1"],["Sp3"],["Sp2"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"2","family":[["sans"]],"font":[[1]],"ignoreExtent":false,"flags":33808},"50":{"id":50,"type":"points","material":{"lit":false},"vertices":"3","colors":"4","centers":"5","ignoreExtent":false,"flags":34816},"51":{"id":51,"type":"points","material":{"lit":false},"vertices":"6","colors":"7","centers":"8","ignoreExtent":false,"flags":34816},"52":{"id":52,"type":"points","material":{"lit":false},"vertices":"9","colors":"10","centers":"11","ignoreExtent":false,"flags":34816},"53":{"id":53,"type":"text","material":{"lit":false},"vertices":"12","colors":"13","texts":[["Comunidade A"]],"cex":[[1]],"adj":[[-0.1,0,0.5]],"centers":"14","family":[["sans"]],"font":[[1]],"ignoreExtent":false,"flags":33808},"54":{"id":54,"type":"text","material":{"lit":false},"vertices":"15","colors":"16","texts":[["Comunidade B"]],"cex":[[1]],"adj":[[-0.1,0,0.5]],"centers":"17","family":[["sans"]],"font":[[1]],"ignoreExtent":false,"flags":33808},"55":{"id":55,"type":"text","material":{"lit":false},"vertices":"18","colors":"19","texts":[["Comunidade C"]],"cex":[[1]],"adj":[[-0.1,0,0.5]],"centers":"20","family":[["sans"]],"font":[[1]],"ignoreExtent":false,"flags":33808},"56":{"id":56,"type":"lines","material":{"lit":false},"vertices":"21","colors":"22","centers":"23","ignoreExtent":false,"flags":32832},"47":{"id":47,"type":"light","vertices":[[0,0,1]],"colors":[[1,1,1,1],[1,1,1,1],[1,1,1,1]],"viewpoint":true,"finite":false},"46":{"id":46,"type":"background","material":{},"colors":"24","centers":"25","sphere":false,"fogtype":"none","fogscale":1,"flags":32768},"48":{"id":48,"type":"background","material":{"lit":false,"back":"lines"},"colors":"26","centers":"27","sphere":false,"fogtype":"none","fogscale":1,"flags":32768},"43":{"id":43,"type":"subscene","par3d":{"antialias":8,"FOV":30,"ignoreExtent":false,"listeners":43,"mouseMode":{"none":"none","left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,33.4606552124023],"modelMatrix":[[1,0,0,-5],[0,0.342020153999329,0.939692616462708,-6.4085636138916],[0,-0.939692616462708,0.342020153999329,-30.4722938537598],[0,0,0,1]],"projMatrix":[[3.73205089569092,0,0,0],[0,3.73205089569092,0,0],[0,0,-3.86370301246643,-120.621788024902],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.342020143325668,0.939692620785909,0],[0,-0.939692620785909,0.342020143325668,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[1,1,1],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":1,"bbox":[0,10,0,10,0,10],"windowRect":[34,57,290,313],"family":"sans","font":1,"cex":1,"useFreeType":false,"fontname":"TT Arial","maxClipPlanes":8,"glVersion":4.6,"activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"replace"},"objects":[48,49,50,51,52,53,54,55,56,47],"subscenes":[],"flags":36176}},"crosstalk":{"key":[],"group":[],"id":[],"options":[]},"width":672,"height":480,"buffer":{"accessors":[{"bufferView":0,"componentType":5121,"count":4,"type":"VEC3"},{"bufferView":1,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":2,"componentType":5121,"count":4,"type":"VEC3"},{"bufferView":3,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":4,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":5,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":6,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":7,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":8,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":9,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":10,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":11,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":12,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":13,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":14,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":15,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":16,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":17,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":18,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":19,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":20,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":21,"componentType":5121,"count":6,"type":"VEC3"},{"bufferView":22,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":23,"componentType":5121,"count":3,"type":"VEC3"},{"bufferView":24,"componentType":5126,"count":1,"type":"VEC4"},{"bufferView":25,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":26,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":27,"componentType":5121,"count":1,"type":"VEC3"}],"bufferViews":[{"buffer":0,"byteLength":12,"byteOffset":0},{"buffer":0,"byteLength":4,"byteOffset":12},{"buffer":0,"byteLength":12,"byteOffset":16},{"buffer":0,"byteLength":3,"byteOffset":28},{"buffer":0,"byteLength":4,"byteOffset":31},{"buffer":0,"byteLength":3,"byteOffset":35},{"buffer":0,"byteLength":3,"byteOffset":38},{"buffer":0,"byteLength":4,"byteOffset":41},{"buffer":0,"byteLength":3,"byteOffset":45},{"buffer":0,"byteLength":3,"byteOffset":48},{"buffer":0,"byteLength":4,"byteOffset":51},{"buffer":0,"byteLength":3,"byteOffset":55},{"buffer":0,"byteLength":3,"byteOffset":58},{"buffer":0,"byteLength":4,"byteOffset":61},{"buffer":0,"byteLength":3,"byteOffset":65},{"buffer":0,"byteLength":3,"byteOffset":68},{"buffer":0,"byteLength":4,"byteOffset":71},{"buffer":0,"byteLength":3,"byteOffset":75},{"buffer":0,"byteLength":3,"byteOffset":78},{"buffer":0,"byteLength":4,"byteOffset":81},{"buffer":0,"byteLength":3,"byteOffset":85},{"buffer":0,"byteLength":18,"byteOffset":88},{"buffer":0,"byteLength":4,"byteOffset":106},{"buffer":0,"byteLength":9,"byteOffset":110},{"buffer":0,"byteLength":16,"byteOffset":120},{"buffer":0,"byteLength":3,"byteOffset":136},{"buffer":0,"byteLength":4,"byteOffset":139},{"buffer":0,"byteLength":3,"byteOffset":143}],"buffers":[{"byteLength":146,"bytes":"AAAACgAAAAoAAAAKAAAAAQAAAAoAAAAKAAAACggGBwAAAQEIBgcDAwMAAQABAwMDAAUFAQAA\nAQAFBQgGBwAAAAEIBgcDAwMAAAABAwMDAAUFAAAAAQAFBQAAAAoAAAAAAAAKAAAAAAAACgAA\nAAEFAAAABQAAAAUAmZiYPpmYmD6ZmJg+AACAPwAAAAEBAQEAAAA="}]},"context":{"shiny":false,"rmarkdown":"bookdown::gitbook"},"vertexShader":"#line 2 1\n// File 1 is the vertex shader\n#ifdef GL_ES\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n#endif\n\nattribute vec3 aPos;\nattribute vec4 aCol;\nuniform mat4 mvMatrix;\nuniform mat4 prMatrix;\nvarying vec4 vCol;\nvarying vec4 vPosition;\n\n#ifdef NEEDS_VNORMAL\nattribute vec3 aNorm;\nuniform mat4 normMatrix;\nvarying vec4 vNormal;\n#endif\n\n#if defined(HAS_TEXTURE) || defined (IS_TEXT)\nattribute vec2 aTexcoord;\nvarying vec2 vTexcoord;\n#endif\n\n#ifdef FIXED_SIZE\nuniform vec3 textScale;\n#endif\n\n#ifdef FIXED_QUADS\nattribute vec3 aOfs;\n#endif\n\n#ifdef IS_TWOSIDED\n#ifdef HAS_NORMALS\nvarying float normz;\nuniform mat4 invPrMatrix;\n#else\nattribute vec3 aPos1;\nattribute vec3 aPos2;\nvarying float normz;\n#endif\n#endif // IS_TWOSIDED\n\n#ifdef FAT_LINES\nattribute vec3 aNext;\nattribute vec2 aPoint;\nvarying vec2 vPoint;\nvarying float vLength;\nuniform float uAspect;\nuniform float uLwd;\n#endif\n\n#ifdef USE_ENVMAP\nvarying vec3 vReflection;\n#endif\n\nvoid main(void) {\n  \n#ifndef IS_BRUSH\n#if defined(NCLIPPLANES) || !defined(FIXED_QUADS) || defined(HAS_FOG) || defined(USE_ENVMAP)\n  vPosition = mvMatrix * vec4(aPos, 1.);\n#endif\n  \n#ifndef FIXED_QUADS\n  gl_Position = prMatrix * vPosition;\n#endif\n#endif // !IS_BRUSH\n  \n#ifdef IS_POINTS\n  gl_PointSize = POINTSIZE;\n#endif\n  \n  vCol = aCol;\n  \n// USE_ENVMAP implies NEEDS_VNORMAL\n\n#ifdef NEEDS_VNORMAL\n  vNormal = normMatrix * vec4(-aNorm, dot(aNorm, aPos));\n#endif\n\n#ifdef USE_ENVMAP\n  vReflection = normalize(reflect(vPosition.xyz/vPosition.w, \n                        normalize(vNormal.xyz/vNormal.w)));\n#endif\n  \n#ifdef IS_TWOSIDED\n#ifdef HAS_NORMALS\n  /* normz should be calculated *after* projection */\n  normz = (invPrMatrix*vNormal).z;\n#else\n  vec4 pos1 = prMatrix*(mvMatrix*vec4(aPos1, 1.));\n  pos1 = pos1/pos1.w - gl_Position/gl_Position.w;\n  vec4 pos2 = prMatrix*(mvMatrix*vec4(aPos2, 1.));\n  pos2 = pos2/pos2.w - gl_Position/gl_Position.w;\n  normz = pos1.x*pos2.y - pos1.y*pos2.x;\n#endif\n#endif // IS_TWOSIDED\n  \n#ifdef NEEDS_VNORMAL\n  vNormal = vec4(normalize(vNormal.xyz/vNormal.w), 1);\n#endif\n  \n#if defined(HAS_TEXTURE) || defined(IS_TEXT)\n  vTexcoord = aTexcoord;\n#endif\n  \n#if defined(FIXED_SIZE) && !defined(ROTATING)\n  vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);\n  pos = pos/pos.w;\n  gl_Position = pos + vec4(aOfs*textScale, 0.);\n#endif\n  \n#if defined(IS_SPRITES) && !defined(FIXED_SIZE)\n  vec4 pos = mvMatrix * vec4(aPos, 1.);\n  pos = pos/pos.w + vec4(aOfs,  0.);\n  gl_Position = prMatrix*pos;\n#endif\n  \n#ifdef FAT_LINES\n  /* This code was inspired by Matt Deslauriers' code in \n   https://mattdesl.svbtle.com/drawing-lines-is-hard */\n  vec2 aspectVec = vec2(uAspect, 1.0);\n  mat4 projViewModel = prMatrix * mvMatrix;\n  vec4 currentProjected = projViewModel * vec4(aPos, 1.0);\n  currentProjected = currentProjected/currentProjected.w;\n  vec4 nextProjected = projViewModel * vec4(aNext, 1.0);\n  vec2 currentScreen = currentProjected.xy * aspectVec;\n  vec2 nextScreen = (nextProjected.xy / nextProjected.w) * aspectVec;\n  float len = uLwd;\n  vec2 dir = vec2(1.0, 0.0);\n  vPoint = aPoint;\n  vLength = length(nextScreen - currentScreen)/2.0;\n  vLength = vLength/(vLength + len);\n  if (vLength > 0.0) {\n    dir = normalize(nextScreen - currentScreen);\n  }\n  vec2 normal = vec2(-dir.y, dir.x);\n  dir.x /= uAspect;\n  normal.x /= uAspect;\n  vec4 offset = vec4(len*(normal*aPoint.x*aPoint.y - dir), 0.0, 0.0);\n  gl_Position = currentProjected + offset;\n#endif\n  \n#ifdef IS_BRUSH\n  gl_Position = vec4(aPos, 1.);\n#endif\n}","fragmentShader":"#line 2 2\n// File 2 is the fragment shader\n#ifdef GL_ES\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n#endif\nvarying vec4 vCol; // carries alpha\nvarying vec4 vPosition;\n#if defined(HAS_TEXTURE) || defined (IS_TEXT)\nvarying vec2 vTexcoord;\nuniform sampler2D uSampler;\n#endif\n\n#ifdef HAS_FOG\nuniform int uFogMode;\nuniform vec3 uFogColor;\nuniform vec4 uFogParms;\n#endif\n\n#if defined(IS_LIT) && !defined(FIXED_QUADS)\nvarying vec4 vNormal;\n#endif\n\n#if NCLIPPLANES > 0\nuniform vec4 vClipplane[NCLIPPLANES];\n#endif\n\n#if NLIGHTS > 0\nuniform mat4 mvMatrix;\n#endif\n\n#ifdef IS_LIT\nuniform vec3 emission;\nuniform float shininess;\n#if NLIGHTS > 0\nuniform vec3 ambient[NLIGHTS];\nuniform vec3 specular[NLIGHTS]; // light*material\nuniform vec3 diffuse[NLIGHTS];\nuniform vec3 lightDir[NLIGHTS];\nuniform bool viewpoint[NLIGHTS];\nuniform bool finite[NLIGHTS];\n#endif\n#endif // IS_LIT\n\n#ifdef IS_TWOSIDED\nuniform bool front;\nvarying float normz;\n#endif\n\n#ifdef FAT_LINES\nvarying vec2 vPoint;\nvarying float vLength;\n#endif\n\n#ifdef USE_ENVMAP\nvarying vec3 vReflection;\n#endif\n\nvoid main(void) {\n  vec4 fragColor;\n#ifdef FAT_LINES\n  vec2 point = vPoint;\n  bool neg = point.y < 0.0;\n  point.y = neg ? (point.y + vLength)/(1.0 - vLength) :\n                 -(point.y - vLength)/(1.0 - vLength);\n#if defined(IS_TRANSPARENT) && defined(IS_LINESTRIP)\n  if (neg && length(point) <= 1.0) discard;\n#endif\n  point.y = min(point.y, 0.0);\n  if (length(point) > 1.0) discard;\n#endif // FAT_LINES\n  \n#ifdef ROUND_POINTS\n  vec2 coord = gl_PointCoord - vec2(0.5);\n  if (length(coord) > 0.5) discard;\n#endif\n  \n#if NCLIPPLANES > 0\n  for (int i = 0; i < NCLIPPLANES; i++)\n    if (dot(vPosition, vClipplane[i]) < 0.0) discard;\n#endif\n    \n#ifdef FIXED_QUADS\n    vec3 n = vec3(0., 0., 1.);\n#elif defined(IS_LIT)\n    vec3 n = normalize(vNormal.xyz);\n#endif\n    \n#ifdef IS_TWOSIDED\n    if ((normz <= 0.) != front) discard;\n#endif\n\n#ifdef IS_LIT\n    vec3 eye = normalize(-vPosition.xyz/vPosition.w);\n    vec3 lightdir;\n    vec4 colDiff;\n    vec3 halfVec;\n    vec4 lighteffect = vec4(emission, 0.);\n    vec3 col;\n    float nDotL;\n#ifdef FIXED_QUADS\n    n = -faceforward(n, n, eye);\n#endif\n    \n#if NLIGHTS > 0\n    for (int i=0;i<NLIGHTS;i++) {\n      colDiff = vec4(vCol.rgb * diffuse[i], vCol.a);\n      lightdir = lightDir[i];\n      if (!viewpoint[i])\n        lightdir = (mvMatrix * vec4(lightdir, 1.)).xyz;\n      if (!finite[i]) {\n        halfVec = normalize(lightdir + eye);\n      } else {\n        lightdir = normalize(lightdir - vPosition.xyz/vPosition.w);\n        halfVec = normalize(lightdir + eye);\n      }\n      col = ambient[i];\n      nDotL = dot(n, lightdir);\n      col = col + max(nDotL, 0.) * colDiff.rgb;\n      col = col + pow(max(dot(halfVec, n), 0.), shininess) * specular[i];\n      lighteffect = lighteffect + vec4(col, colDiff.a);\n    }\n#endif\n    \n#else // not IS_LIT\n    vec4 colDiff = vCol;\n    vec4 lighteffect = colDiff;\n#endif\n    \n#ifdef IS_TEXT\n    vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);\n#endif\n    \n#ifdef HAS_TEXTURE\n\n// These calculations use the definitions from \n// https://docs.gl/gl3/glTexEnv\n\n#ifdef USE_ENVMAP\n    float m = 2.0 * sqrt(dot(vReflection, vReflection) + 2.0*vReflection.z + 1.0);\n    vec4 textureColor = texture2D(uSampler, vReflection.xy / m + vec2(0.5, 0.5));\n#else\n    vec4 textureColor = texture2D(uSampler, vTexcoord);\n#endif\n\n#ifdef TEXTURE_rgb\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(textureColor.rgb, lighteffect.a);\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = lighteffect*vec4(textureColor.rgb, 1.);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - textureColor.rgb) * lighteffect.rgb, lighteffect.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(lighteffect.rgb + textureColor.rgb, lighteffect.a);\n#endif\n\n#endif //TEXTURE_rgb\n        \n#ifdef TEXTURE_rgba\n\n#ifdef TEXMODE_replace\n// already done\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = lighteffect*textureColor;\n#endif\n\n#ifdef TEXMODE_decal\n    textureColor = vec4((1. - textureColor.a)*lighteffect.rgb) +\n                     textureColor.a*textureColor.rgb, \n                     lighteffect.a);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - textureColor.rgb) * lighteffect.rgb,\n                    lighteffect.a*textureColor.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(lighteffect.rgb + textureColor.rgb,\n                    lighteffect.a*textureColor.a);\n#endif\n    \n#endif //TEXTURE_rgba\n    \n#ifdef TEXTURE_alpha\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(lighteffect.rgb, textureColor.a);\n#endif \n\n#if defined(TEXMODE_modulate) || defined(TEXMODE_blend) || defined(TEXMODE_add)\n    textureColor = vec4(lighteffect.rgb, lighteffect.a*textureColor.a);\n#endif\n \n#endif\n    \n// The TEXTURE_luminance values are not from that reference    \n#ifdef TEXTURE_luminance\n    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(luminance, luminance, luminance, lighteffect.a);\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = vec4(luminance*lighteffect.rgb, lighteffect.a);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - luminance)*lighteffect.rgb,\n                        lighteffect.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(luminance + lighteffect.rgb, lighteffect.a);\n#endif\n\n#endif // TEXTURE_luminance\n \n    \n#ifdef TEXTURE_luminance_alpha\n    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(luminance, luminance, luminance, textureColor.a);\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = vec4(luminance*lighteffect.rgb, \n                        textureColor.a*lighteffect.a);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - luminance)*lighteffect.rgb,\n                        textureColor.a*lighteffect.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(luminance + lighteffect.rgb, \n                        textureColor.a*lighteffect.a);\n\n#endif\n\n#endif // TEXTURE_luminance_alpha\n    \n    fragColor = textureColor;\n\n#elif defined(IS_TEXT)\n    if (textureColor.a < 0.1)\n      discard;\n    else\n      fragColor = textureColor;\n#else\n    fragColor = lighteffect;\n#endif // HAS_TEXTURE\n    \n#ifdef HAS_FOG\n    // uFogParms elements: x = near, y = far, z = fogscale, w = (1-sin(FOV/2))/(1+sin(FOV/2))\n    // In Exp and Exp2: use density = density/far\n    // fogF will be the proportion of fog\n    // Initialize it to the linear value\n    float fogF;\n    if (uFogMode > 0) {\n      fogF = (uFogParms.y - vPosition.z/vPosition.w)/(uFogParms.y - uFogParms.x);\n      if (uFogMode > 1)\n        fogF = mix(uFogParms.w, 1.0, fogF);\n      fogF = fogF*uFogParms.z;\n      if (uFogMode == 2)\n        fogF = 1.0 - exp(-fogF);\n      // Docs are wrong: use (density*c)^2, not density*c^2\n      // https://gitlab.freedesktop.org/mesa/mesa/-/blob/master/src/mesa/swrast/s_fog.c#L58\n      else if (uFogMode == 3)\n        fogF = 1.0 - exp(-fogF*fogF);\n      fogF = clamp(fogF, 0.0, 1.0);\n      gl_FragColor = vec4(mix(fragColor.rgb, uFogColor, fogF), fragColor.a);\n    } else gl_FragColor = fragColor;\n#else\n    gl_FragColor = fragColor;\n#endif // HAS_FOG\n    \n}","players":[],"webGLoptions":{"preserveDrawingBuffer":true}},"evals":[],"jsHooks":[]}</script><p>considere tantos eixos quanto espécies existentes em uma comunidade. Obviamente, não podemos visualizar isso além de 3 dimensões.</p>
<p>O objetivo do NMDS é representar a posição original das comunidades em um espaço multidimensional da forma mais precisa possível, usando um número reduzido de dimensões que podem ser facilmente plotadas e visualizadas.</p>
<p>Por ser uma ordenação <strong>não-métrica</strong> o NMDS não utiliza as abundâncias absolutas das espécies nas comunidades, mas sim a ordem do seu “rank” estatístico (ou sua “ordenação). O uso de”ranks” ou ordenações omite alguns dos problemas associados ao uso de distâncias absolutas (por exemplo, sensibilidade à transformação) e, como resultado, é uma técnica muito mais flexível, que aceita uma variedade de tipos de dados.</p>
<p>O procedimento NMDS segue um algorítimo iterativo que ocorre em várias etapas:</p>
<ol style="list-style-type: decimal">
<li>Definir as posições originais das comunidades em espaço multidimensional</li>
<li>Especificar o número m de dimensões reduzidas (tipicamente 2)</li>
<li>Construir uma configuração inicial das amostras em 2 dimensões</li>
<li>Regressar distâncias nesta configuração inicial contra as distâncias observadas (medidas)</li>
<li>Determinar o stress (discordância entre a configuração 2-D e os valores previstos da regressão).
Se a configuração 2-D preservar perfeitamente os ranks originais de classificação, então um gráfico de um vs. o outro deve ser monotonicamente crescente (gráfico de Shepard). A extensão com que os pontos na configuração 2-D diferem dessa linha monotonicamente crescente determina o grau de stress</li>
<li>Se o stress for alto, reposicione os pontos em m dimensões na direção do stress decrescente e repita até que o stress esteja abaixo de um certo limite.</li>
</ol>
<p>Geralmente, stress &lt; 0.05 fornece uma excelente representação em dimensões reduzidas, &lt; 0.1 é ótimo, &lt; 0.2 é bom, e stress &gt; 0.3 fornece uma representação ruim.</p>
<p>NOTA: A configuração final pode diferir dependendo da configuração inicial (que normalmente é aleatória) e do número de iterações do algorítmo, então é aconselhável executar o NMDS várias vezes e comparar a interpretação das soluções de menor stress.</p>
<p>Para começar, o NMDS requer uma matriz de distâncias (ou uma matriz de dissimilaridades). Distâncias Euclidianas brutas não são ideais para este propósito: elas são sensíveis às abundâncias totais, então podem tratar locais com um número semelhante de espécies como mais semelhantes, mesmo que as identidades das espécies sejam diferentes. Elas também são sensíveis às ausências de espécies, então podem tratar locais com o mesmo número de espécies ausentes como mais semelhantes.</p>
<p>Consequentemente, os ecologistas usam o cálculo de dissimilaridade de Bray-Curtis, que possui muitas propriedades ideais:</p>
<ul>
<li>É invariante a mudanças em unidades</li>
<li>Não é afetado por adições/remoções de espécies que não estão presentes em duas comunidades</li>
<li>Não é afetado pela adição de uma nova comunidade</li>
<li>Pode reconhecer diferenças nas abundâncias totais quando as abundâncias relativas são iguais.</li>
</ul>
<p>Para executar a NMDS, usa-se a função <code>metaMDS</code> do pacote <code>vegan</code>.</p>
<div class="sourceCode" id="cb595"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/vegandevs/vegan">vegan</a></span><span class="op">)</span></span></code></pre></div>
<p><code>metaMDS</code> requer uma matriz de comunidade-por-espécies (CBE, “community-by-species”). De momento, cria-se essa matrizcom dados amostradoes aleatóriamente de um cojunto arbitrário de valores.</p>
<div class="sourceCode" id="cb596"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">community_matrix</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,<span class="fl">300</span>,replace<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">10</span>,</span>
<span>                        dimnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"community"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,sep<span class="op">=</span><span class="st">""</span><span class="op">)</span>,</span>
<span>                                      <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"sp"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">30</span>,sep<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>A função <code>metaMDS</code> vai calcular as distâncias, executar o algorítimo iterativo, determna o stress ou fitting entre os conjuntos de dados e etc. Precisa-se apenas definir a matriz de comunidade-por-espécies. Nesse caso:</p>
<div class="sourceCode" id="cb597"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_NMDS</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/metaMDS.html">metaMDS</a></span><span class="op">(</span><span class="va">community_matrix</span>, <span class="co">#matriz CBS, definida anteriormente</span></span>
<span>                     k<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="co">#no. de redução de dimensões</span></span></code></pre></div>
<pre><code>## Square root transformation
## Wisconsin double standardization
## Run 0 stress 0.1486475 
## Run 1 stress 0.1913689 
## Run 2 stress 0.1908303 
## Run 3 stress 0.1908305 
## Run 4 stress 0.1849153 
## Run 5 stress 0.1906937 
## Run 6 stress 0.1486477 
## ... Procrustes: rmse 0.0002739181  max resid 0.000426955 
## ... Similar to previous best
## Run 7 stress 0.1849759 
## Run 8 stress 0.1688829 
## Run 9 stress 0.1650751 
## Run 10 stress 0.1486475 
## ... Procrustes: rmse 8.715875e-05  max resid 0.0001400462 
## ... Similar to previous best
## Run 11 stress 0.164544 
## Run 12 stress 0.3153591 
## Run 13 stress 0.2198889 
## Run 14 stress 0.2237308 
## Run 15 stress 0.1699872 
## Run 16 stress 0.1650804 
## Run 17 stress 0.1906937 
## Run 18 stress 0.1906937 
## Run 19 stress 0.1494912 
## Run 20 stress 0.1650751 
## *** Best solution repeated 2 times</code></pre>
<p>Deve-se observar cada iteração do NMDS até que uma solução seja alcançada (ou seja, o stress foi minimizado após algum número de reconfigurações dos pontos em 2 dimensões). Pode-se aumentar o número padrão de iterações usando o argumento <code>trymax =</code>. Isso pode ajudar a aliviar problemas de não convergência. Se o stress for alto, pode-se aumentar o número de dimensões para <code>k = 3</code>.</p>
<div class="sourceCode" id="cb599"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_NMDS</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/metaMDS.html">metaMDS</a></span><span class="op">(</span><span class="va">community_matrix</span>,k<span class="op">=</span><span class="fl">2</span>,trymax<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Square root transformation
## Wisconsin double standardization
## Run 0 stress 0.1486475 
## Run 1 stress 0.1906937 
## Run 2 stress 0.1486475 
## ... New best solution
## ... Procrustes: rmse 4.504062e-05  max resid 7.46737e-05 
## ... Similar to previous best
## Run 3 stress 0.164544 
## Run 4 stress 0.2043556 
## Run 5 stress 0.1486475 
## ... New best solution
## ... Procrustes: rmse 3.786411e-05  max resid 5.798541e-05 
## ... Similar to previous best
## Run 6 stress 0.1686179 
## Run 7 stress 0.1486487 
## ... Procrustes: rmse 0.001296765  max resid 0.002408379 
## ... Similar to previous best
## Run 8 stress 0.1881025 
## Run 9 stress 0.1751078 
## Run 10 stress 0.1650804 
## Run 11 stress 0.1486475 
## ... Procrustes: rmse 0.0001191068  max resid 0.0001867147 
## ... Similar to previous best
## Run 12 stress 0.1663641 
## Run 13 stress 0.1744082 
## Run 14 stress 0.1717124 
## Run 15 stress 0.1751081 
## Run 16 stress 0.1769791 
## Run 17 stress 0.1906937 
## Run 18 stress 0.1974143 
## Run 19 stress 0.1650751 
## Run 20 stress 0.1486475 
## ... Procrustes: rmse 0.0001122687  max resid 0.0001737893 
## ... Similar to previous best
## *** Best solution repeated 4 times</code></pre>
<p>Pode-se agora examinar o objeto NMDS.</p>
<div class="sourceCode" id="cb601"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_NMDS</span> </span></code></pre></div>
<pre><code>## 
## Call:
## metaMDS(comm = community_matrix, k = 2, trymax = 100) 
## 
## global Multidimensional Scaling using monoMDS
## 
## Data:     wisconsin(sqrt(community_matrix)) 
## Distance: bray 
## 
## Dimensions: 2 
## Stress:     0.1486475 
## Stress type 1, weak ties
## Best solution was repeated 4 times in 20 tries
## The best solution was from try 5 (random start)
## Scaling: centring, PC rotation, halfchange scaling 
## Species: expanded scores based on 'wisconsin(sqrt(community_matrix))'</code></pre>
<p>Nesse exemplo, <code>metaMDS</code> aplicou automaticamente uma transformação da raiz quadrada e calculou as distâncias de Bray-Curtis para a matriz de comunidade-por-local.</p>
<p>É necessário examinar o <strong>Gráfico de Shepard</strong>, que mostra a dispersão em torno da regressão entre as distâncias entre pontos da configuração final (distâncias entre cada par de comunidades) <em>versus</em> as dissimilaridades originais.</p>
<div class="sourceCode" id="cb603"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/goodness.metaMDS.html">stressplot</a></span><span class="op">(</span><span class="va">example_NMDS</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="fundamentos_de_ecologia_numerica_files/figure-html/unnamed-chunk-306-1.png" width="672"></div>
<p>Uma dispersão grande ao redor da linha sugere que as dissimilaridades originais não são bem preservadas no número reduzido de dimensões.</p>
<p>Agora podemos plotar a NMDS</p>
<p>A ordenação mostra tanto as comunidades (“locais”, círculos abertos) quanto as espécies (cruzes vermelhas).</p>
<p>Aqui, pode-se usar as funções <code>ordiplot</code> e <code>orditorp</code> para adicionar texto ao gráfico no lugar dos pontos.</p>
<div class="sourceCode" id="cb604"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">example_NMDS</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="fundamentos_de_ecologia_numerica_files/figure-html/unnamed-chunk-308-1.png" width="672"></div>
<div class="sourceCode" id="cb605"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/ordiplot.html">ordiplot</a></span><span class="op">(</span><span class="va">example_NMDS</span>,type<span class="op">=</span><span class="st">"n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/orditorp.html">orditorp</a></span><span class="op">(</span><span class="va">example_NMDS</span>,display<span class="op">=</span><span class="st">"species"</span>,col<span class="op">=</span><span class="st">"red"</span>,air<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/orditorp.html">orditorp</a></span><span class="op">(</span><span class="va">example_NMDS</span>,display<span class="op">=</span><span class="st">"sites"</span>,cex<span class="op">=</span><span class="fl">1.25</span>,air<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="fundamentos_de_ecologia_numerica_files/figure-html/unnamed-chunk-308-2.png" width="672"></div>
<p>Existem algumas funções adicionais que podem ser de interesse. Pode-se desenhar polígonos convexos conectando os vértices dos pontos feitos por certos grupos de comunidades no gráfico.</p>
<p>Para isso, cria-se um vetor de valores de tratamento.</p>
<div class="sourceCode" id="cb606"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">example_NMDS</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="fundamentos_de_ecologia_numerica_files/figure-html/unnamed-chunk-309-1.png" width="672"></div>
<div class="sourceCode" id="cb607"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">treat</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Treatment1"</span>,<span class="fl">5</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Treatment2"</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/ordiplot.html">ordiplot</a></span><span class="op">(</span><span class="va">example_NMDS</span>,type<span class="op">=</span><span class="st">"n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/ordihull.html">ordihull</a></span><span class="op">(</span><span class="va">example_NMDS</span>,groups<span class="op">=</span><span class="va">treat</span>,draw<span class="op">=</span><span class="st">"polygon"</span>,col<span class="op">=</span><span class="st">"grey90"</span>,</span>
<span>         label<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/orditorp.html">orditorp</a></span><span class="op">(</span><span class="va">example_NMDS</span>,display<span class="op">=</span><span class="st">"species"</span>,col<span class="op">=</span><span class="st">"red"</span>,air<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/orditorp.html">orditorp</a></span><span class="op">(</span><span class="va">example_NMDS</span>,display<span class="op">=</span><span class="st">"sites"</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"green"</span>,<span class="fl">5</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"blue"</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         air<span class="op">=</span><span class="fl">0.01</span>,cex<span class="op">=</span><span class="fl">1.25</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="fundamentos_de_ecologia_numerica_files/figure-html/unnamed-chunk-309-2.png" width="672"></div>
<p>Essa é uma maneira intuitiva de entender como as comunidades e espécies se agrupam com base nos tratamentos possveis. Nesse caso, comunidades 1-5 em verde e comunidades 6-10 em azul. Também é possível plotar elipses e “gráficos de aranha” usando as funções <code>ordiellipse</code> e <code>orderspider</code>, que enfatizam o centróide das comunidades em cada tratamento.</p>
<p>Outra alternativa é plotar uma “árvore de abrangência mínima” (da função <code>hclust</code>), que agrupa as comunidades com base em suas dissimilaridades originais e projeta o dendrograma no gráfico 2D.</p>
<div class="sourceCode" id="cb608"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">example_NMDS</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="fundamentos_de_ecologia_numerica_files/figure-html/unnamed-chunk-310-1.png" width="672"></div>
<div class="sourceCode" id="cb609"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/ordiplot.html">ordiplot</a></span><span class="op">(</span><span class="va">example_NMDS</span>,type<span class="op">=</span><span class="st">"n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/orditorp.html">orditorp</a></span><span class="op">(</span><span class="va">example_NMDS</span>,display<span class="op">=</span><span class="st">"species"</span>,col<span class="op">=</span><span class="st">"red"</span>,air<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/orditorp.html">orditorp</a></span><span class="op">(</span><span class="va">example_NMDS</span>,display<span class="op">=</span><span class="st">"sites"</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"green"</span>,<span class="fl">5</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"blue"</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         air<span class="op">=</span><span class="fl">0.01</span>,cex<span class="op">=</span><span class="fl">1.25</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/ordihull.html">ordicluster</a></span><span class="op">(</span><span class="va">example_NMDS</span>,<span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/vegdist.html">vegdist</a></span><span class="op">(</span><span class="va">community_matrix</span>,<span class="st">"bray"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<div class="inline-figure"><img src="fundamentos_de_ecologia_numerica_files/figure-html/unnamed-chunk-310-2.png" width="672"></div>
<p>Observe que o agrupamento é baseado em distâncias de Bray-Curtis. Este é um método sugerido para verificar a precisão do gráfico 2D.</p>
<p>Pode-se ainda plotar os polígonos convexos, elipses, gráficos de aranha, etc., coloridos com base nos tratamentos. Mas primeiro, cria-se um vetor de valores de cor com a mesma extensão do vetor de valores de tratamento.</p>
<div class="sourceCode" id="cb610"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">example_NMDS</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="fundamentos_de_ecologia_numerica_files/figure-html/unnamed-chunk-311-1.png" width="672"></div>
<div class="sourceCode" id="cb611"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">colors</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"red"</span>,<span class="fl">5</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"blue"</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/ordiplot.html">ordiplot</a></span><span class="op">(</span><span class="va">example_NMDS</span>,type<span class="op">=</span><span class="st">"n"</span><span class="op">)</span></span>
<span><span class="co">#Plot convex hulls with colors baesd on treatment</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">treat</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/ordihull.html">ordihull</a></span><span class="op">(</span><span class="va">example_NMDS</span><span class="op">$</span><span class="va">point</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span><span class="op">(</span><span class="va">i</span>,<span class="va">treat</span><span class="op">)</span>,<span class="op">]</span>,draw<span class="op">=</span><span class="st">"polygon"</span>,groups<span class="op">=</span><span class="va">treat</span><span class="op">[</span><span class="va">treat</span><span class="op">==</span><span class="va">i</span><span class="op">]</span>,col<span class="op">=</span><span class="va">colors</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span><span class="op">(</span><span class="va">i</span>,<span class="va">treat</span><span class="op">)</span><span class="op">]</span>,label<span class="op">=</span><span class="cn">F</span><span class="op">)</span> <span class="op">}</span> </span>
<span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/orditorp.html">orditorp</a></span><span class="op">(</span><span class="va">example_NMDS</span>,display<span class="op">=</span><span class="st">"species"</span>,col<span class="op">=</span><span class="st">"red"</span>,air<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/orditorp.html">orditorp</a></span><span class="op">(</span><span class="va">example_NMDS</span>,display<span class="op">=</span><span class="st">"sites"</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"green"</span>,<span class="fl">5</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"blue"</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         air<span class="op">=</span><span class="fl">0.01</span>,cex<span class="op">=</span><span class="fl">1.25</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="fundamentos_de_ecologia_numerica_files/figure-html/unnamed-chunk-311-2.png" width="672"></div>
<p>Esse agrupamento é baseado em distâncias de Bray-Curtis. Este é um método sugerido para verificar a precisão do gráfico 2D.</p>
<p>Pode-se plotar os polígonos convexos, elipses, gráficos de aranha, etc., coloridos com base nos tratamentos. Primeiro, cria-se um vetor de valores de cor com a mesma extensão do vetor de valores de tratamento.</p>
<p>Se o tratamento for uma variável contínua, deve-se considerar linhas de mapeamento de contorno sobrepostas no gráfico. Para este exemplo, considera-se que os tratamentos foram aplicados ao longo de um gradiente de elevação. Podemos definir elevações aleatórias para o mesmo exemplo.</p>
<div class="sourceCode" id="cb612"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">example_NMDS</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="fundamentos_de_ecologia_numerica_files/figure-html/unnamed-chunk-312-1.png" width="672"></div>
<div class="sourceCode" id="cb613"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">elevation</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">0.5</span>,<span class="fl">1.5</span><span class="op">)</span></span></code></pre></div>
<p>Agora usa-se a função <code>ordisurf</code> para plotar as linhas de contorno. A quantidade de linhas de contorno é definida pelo comando <code>knots =</code>. Se <code>knots = 0</code> ou <code>knots = 1</code> a função <code>ordisurf</code> ajustará uma tendencia linear a superfície, e se <code>knots = 2</code> a função ajustará uma tendência quadrática, ao inves de linhas retas.</p>
<div class="sourceCode" id="cb614"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">example_NMDS</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="fundamentos_de_ecologia_numerica_files/figure-html/unnamed-chunk-313-1.png" width="672"></div>
<div class="sourceCode" id="cb615"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/ordisurf.html">ordisurf</a></span><span class="op">(</span><span class="va">example_NMDS</span>,<span class="va">elevation</span>,main<span class="op">=</span><span class="st">""</span>,col<span class="op">=</span><span class="st">"forestgreen"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="fundamentos_de_ecologia_numerica_files/figure-html/unnamed-chunk-313-2.png" width="672"></div>
<pre><code>## 
## Family: gaussian 
## Link function: identity 
## 
## Formula:
## y ~ s(x1, x2, k = 10, bs = "tp", fx = FALSE)
## 
## Estimated degrees of freedom:
## 0.189  total = 1.19 
## 
## REML score: 1.428577</code></pre>
<p>Por fim, exibe-se as espécies no gráfico.</p>
<div class="sourceCode" id="cb617"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">example_NMDS</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/orditorp.html">orditorp</a></span><span class="op">(</span><span class="va">example_NMDS</span>,display<span class="op">=</span><span class="st">"species"</span>,col<span class="op">=</span><span class="st">"grey30"</span>,air<span class="op">=</span><span class="fl">0.1</span>,cex<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="fundamentos_de_ecologia_numerica_files/figure-html/unnamed-chunk-314-1.png" width="672"></div>
<p>Refaça a análise com os dados fornecidos.</p>
</div>
<div id="apêndices-15" class="section level2 unnumbered">
<h2>Apêndices<a class="anchor" aria-label="anchor" href="#ap%C3%AAndices-15"><i class="fas fa-link"></i></a>
</h2>
</div>
<div id="sites-consultados-9" class="section level2 unnumbered">
<h2>Sites consultados<a class="anchor" aria-label="anchor" href="#sites-consultados-9"><i class="fas fa-link"></i></a>
</h2>
<p><a href="https://youtu.be/OMrtxobDhrM" class="uri">https://youtu.be/OMrtxobDhrM</a>
<a href="https://youtu.be/zjxE2KwNO0M" class="uri">https://youtu.be/zjxE2KwNO0M</a>
<a href="https://youtu.be/Kl49qI3XJKY" class="uri">https://youtu.be/Kl49qI3XJKY</a>
<a href="https://youtu.be/paO9-PLXwD0" class="uri">https://youtu.be/paO9-PLXwD0</a>
<a href="https://youtu.be/QljEeBei-JA" class="uri">https://youtu.be/QljEeBei-JA</a>
<a href="https://youtu.be/4tQJI-g9wao" class="uri">https://youtu.be/4tQJI-g9wao</a>
<a href="https://youtu.be/M-Ing955VEI" class="uri">https://youtu.be/M-Ing955VEI</a></p>
</div>
<div id="referências-16" class="section level2 unnumbered">
<h2>Referências<a class="anchor" aria-label="anchor" href="#refer%C3%AAncias-16"><i class="fas fa-link"></i></a>
</h2>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="pca.html"><span class="header-section-number">18</span> R Módulo 9 - Análise de Componentes Principais - PCA</a></div>
<div class="next"><a href="nmds2.html"><span class="header-section-number">20</span> R Modulo 10.2 - Análise de Ordenação - NMDS</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li>
<a class="nav-link" href="#nmds"><span class="header-section-number">19</span> R Módulo 10.1 - Análise de Ordenação - NMDS</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#resumo-15">RESUMO</a></li>
<li><a class="nav-link" href="#apresenta%C3%A7%C3%A3o-16">Apresentação</a></li>
</ul>
</li>
<li><a class="nav-link" href="#algoritmo-da-nmds"><span class="header-section-number">19.1</span> Algoritmo da NMDS</a></li>
<li><a class="nav-link" href="#organiza%C3%A7%C3%A3o-b%C3%A1sica-13"><span class="header-section-number">19.2</span> Organização básica</a></li>
<li><a class="nav-link" href="#pacotes-do-m%C3%B3dulo-1"><span class="header-section-number">19.3</span> Pacotes do módulo</a></li>
<li><a class="nav-link" href="#rein%C3%ADcio-1-1"><span class="header-section-number">19.4</span> REINÍCIO 1</a></li>
<li>
<a class="nav-link" href="#classifica%C3%A7%C3%A3o-1-matriz-comunit%C3%A1ria"><span class="header-section-number">19.5</span> Classificação 1: Matriz comunitária</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#dendrograma-e-heatmap-1"><span class="header-section-number">19.5.1</span> Dendrograma e Heatmap 1</a></li>
<li><a class="nav-link" href="#hist%C3%B3rico-das-fus%C3%B5es-1-1"><span class="header-section-number">19.5.2</span> Histórico das fusões 1</a></li>
</ul>
</li>
<li><a class="nav-link" href="#ordena%C3%A7%C3%A3o"><span class="header-section-number">19.6</span> Ordenação</a></li>
<li><a class="nav-link" href="#ap%C3%AAndices-15">Apêndices</a></li>
<li><a class="nav-link" href="#sites-consultados-9">Sites consultados</a></li>
<li><a class="nav-link" href="#refer%C3%AAncias-16">Referências</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Fundamentos de Ecologia Numérica</strong>: Disciplina de Ecologia Numérica do Curso de Ciências Biológicas do Campus V da UEPB" was written by Prof. Elvio S. F. Medeiros, Laboratório de Ecologia, Universidade Estadual da Paraíba, Campus V, João Pessoa, PB. It was last built on Last updated: 09/02/2026 18:47:40.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
