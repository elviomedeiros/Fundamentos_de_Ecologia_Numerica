<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> 16 R Modulo 7 - Análise de Classificação Hierárquica - SAHN | Fundamentos de Ecologia Numérica</title>
  <meta name="description" content="…. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.38 and GitBook 2.6.7" />

  <meta property="og:title" content=" 16 R Modulo 7 - Análise de Classificação Hierárquica - SAHN | Fundamentos de Ecologia Numérica" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="…. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="rstudio/fundamentos_de_ecologia_numerica" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 16 R Modulo 7 - Análise de Classificação Hierárquica - SAHN | Fundamentos de Ecologia Numérica" />
  
  <meta name="twitter:description" content="…. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Prof. Elvio S. F. Medeiros" />
<meta name="author" content="Laboratório de Ecologia" />
<meta name="author" content="Universidade Estadual da Paraíba" />
<meta name="author" content="Campus V, João Pessoa, PB" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="outcentr.html"/>
<link rel="next" href="bibliografia.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 1em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Fundamentos de Ecologia Numérica</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Apresentação</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#motivação"><i class="fa fa-check"></i><b>1.1</b> Motivação</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#organização-do-livro"><i class="fa fa-check"></i><b>1.2</b> Organização do livro</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#como-estudar-por-esse-livro"><i class="fa fa-check"></i><b>1.3</b> Como estudar por esse livro?</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#para-um-estudo-aprofundado"><i class="fa fa-check"></i><b>1.3.1</b> Para um estudo aprofundado</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introdução ao R/RStudio</a>
<ul>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#resumo"><i class="fa fa-check"></i>RESUMO</a></li>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#plano-de-estudo"><i class="fa fa-check"></i><b>2.1</b> Plano de estudo</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#pré-requisitos"><i class="fa fa-check"></i><b>2.2</b> Pré-requisitos</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#principais-conceitos"><i class="fa fa-check"></i><b>2.3</b> Principais conceitos</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="intro.html"><a href="intro.html#o-ambiente-de-programação-do-r"><i class="fa fa-check"></i><b>2.3.1</b> O ambiente de programação do R</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#o-que-é-o-r-studio"><i class="fa fa-check"></i><b>2.4</b> O que é o R Studio?</a></li>
<li class="chapter" data-level="2.5" data-path="intro.html"><a href="intro.html#o-essencial"><i class="fa fa-check"></i><b>2.5</b> O essencial</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="intro.html"><a href="intro.html#licença-de-software"><i class="fa fa-check"></i><b>2.5.1</b> Licença de software</a></li>
<li class="chapter" data-level="2.5.2" data-path="intro.html"><a href="intro.html#interface-do-usuário"><i class="fa fa-check"></i><b>2.5.2</b> Interface do usuário</a></li>
<li class="chapter" data-level="2.5.3" data-path="intro.html"><a href="intro.html#interface-do-usuário-do-rstudio"><i class="fa fa-check"></i><b>2.5.3</b> Interface do usuário do RStudio</a></li>
<li class="chapter" data-level="2.5.4" data-path="intro.html"><a href="intro.html#projetos"><i class="fa fa-check"></i><b>2.5.4</b> Projetos</a></li>
<li class="chapter" data-level="2.5.5" data-path="intro.html"><a href="intro.html#nomes-de-arquivos"><i class="fa fa-check"></i><b>2.5.5</b> Nomes de arquivos</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="intro.html"><a href="intro.html#preparação-dos-arquivos"><i class="fa fa-check"></i><b>2.6</b> Preparação dos arquivos</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="intro.html"><a href="intro.html#formatos-de-arquivo-de-dados"><i class="fa fa-check"></i><b>2.6.1</b> Formatos de arquivo de dados</a></li>
<li class="chapter" data-level="2.6.2" data-path="intro.html"><a href="intro.html#o-arquivo-de-espécies"><i class="fa fa-check"></i><b>2.6.2</b> O arquivo de espécies</a></li>
<li class="chapter" data-level="2.6.3" data-path="intro.html"><a href="intro.html#formato-de-valores-separados-por-vírgula-.csv"><i class="fa fa-check"></i><b>2.6.3</b> Formato de valores separados por vírgula (.csv)</a></li>
<li class="chapter" data-level="2.6.4" data-path="intro.html"><a href="intro.html#editando-a-matriz-de-dados"><i class="fa fa-check"></i><b>2.6.4</b> Editando a matriz de dados</a></li>
<li class="chapter" data-level="2.6.5" data-path="intro.html"><a href="intro.html#arquivos-de-resultados"><i class="fa fa-check"></i><b>2.6.5</b> Arquivos de resultados</a></li>
<li class="chapter" data-level="2.6.6" data-path="intro.html"><a href="intro.html#gráficos"><i class="fa fa-check"></i><b>2.6.6</b> Gráficos</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="intro.html"><a href="intro.html#conclusão"><i class="fa fa-check"></i><b>2.7</b> Conclusão</a></li>
<li class="chapter" data-level="2.8" data-path="intro.html"><a href="intro.html#sequência-típica-na-preparação-e-análise-de-dados"><i class="fa fa-check"></i><b>2.8</b> Sequência típica na preparação e análise de dados</a></li>
<li class="chapter" data-level="2.9" data-path="intro.html"><a href="intro.html#material-de-apoio"><i class="fa fa-check"></i><b>2.9</b> Material de apoio</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#apêndices"><i class="fa fa-check"></i>Apêndices</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#sites-consultados"><i class="fa fa-check"></i>Sites consultados</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#leitura-suplementar"><i class="fa fa-check"></i>Leitura suplementar</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#referências"><i class="fa fa-check"></i>Referências</a></li>
</ul></li>
<li class="part"><span><b>I BASES DE DADOS</b></span></li>
<li class="chapter" data-level="3" data-path="bases.html"><a href="bases.html"><i class="fa fa-check"></i><b>3</b> Bases de Dados. Dados do PPBio Semiárido</a>
<ul>
<li class="chapter" data-level="" data-path="bases.html"><a href="bases.html#exemplos-de-conjunto-de-dados-ecológicos-do-programa-de-pesquisa-em-biodiversidade-ppbio-do-semiárido"><i class="fa fa-check"></i>Exemplos de conjunto de dados ecológicos do Programa de Pesquisa em Biodiversidade (PPBio) do Semiárido</a></li>
<li class="chapter" data-level="" data-path="bases.html"><a href="bases.html#resumo-1"><i class="fa fa-check"></i>RESUMO</a></li>
<li class="chapter" data-level="3.1" data-path="bases.html"><a href="bases.html#sobre-os-dados-do-ppbio"><i class="fa fa-check"></i><b>3.1</b> Sobre os dados do PPBio</a></li>
<li class="chapter" data-level="3.2" data-path="bases.html"><a href="bases.html#arqs"><i class="fa fa-check"></i><b>3.2</b> Arquivos disponíveis</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="bases.html"><a href="bases.html#codificação-das-variáveis"><i class="fa fa-check"></i><b>3.2.1</b> Codificação das variáveis</a></li>
<li class="chapter" data-level="3.2.2" data-path="bases.html"><a href="bases.html#abrev"><i class="fa fa-check"></i><b>3.2.2</b> Abreviações</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bases.html"><a href="bases.html#referências-1"><i class="fa fa-check"></i>Referências</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="basepeixes.html"><a href="basepeixes.html"><i class="fa fa-check"></i><b>4</b> Base de Dados I - Peixes</a>
<ul>
<li class="chapter" data-level="" data-path="basepeixes.html"><a href="basepeixes.html#estrutura-da-comunidade-peixes-no-semiárido"><i class="fa fa-check"></i>Estrutura da Comunidade: Peixes no semiárido</a></li>
<li class="chapter" data-level="" data-path="basepeixes.html"><a href="basepeixes.html#apresentação-1"><i class="fa fa-check"></i>Apresentação</a></li>
<li class="chapter" data-level="" data-path="basepeixes.html"><a href="basepeixes.html#resumo-2"><i class="fa fa-check"></i>RESUMO</a></li>
<li class="chapter" data-level="4.1" data-path="basepeixes.html"><a href="basepeixes.html#introdução"><i class="fa fa-check"></i><b>4.1</b> Introdução</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="basepeixes.html"><a href="basepeixes.html#desenho-amostral"><i class="fa fa-check"></i><b>4.1.1</b> Desenho Amostral</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="basepeixes.html"><a href="basepeixes.html#codificação-das-variáveis-1"><i class="fa fa-check"></i><b>4.2</b> Codificação das variáveis</a></li>
<li class="chapter" data-level="4.3" data-path="basepeixes.html"><a href="basepeixes.html#amostragem-dos-dados"><i class="fa fa-check"></i><b>4.3</b> Amostragem dos dados</a></li>
<li class="chapter" data-level="4.4" data-path="basepeixes.html"><a href="basepeixes.html#análises-estatísticas"><i class="fa fa-check"></i><b>4.4</b> Análises estatísticas</a></li>
<li class="chapter" data-level="4.5" data-path="basepeixes.html"><a href="basepeixes.html#discussão"><i class="fa fa-check"></i><b>4.5</b> Discussão</a></li>
<li class="chapter" data-level="" data-path="basepeixes.html"><a href="basepeixes.html#apêndices-1"><i class="fa fa-check"></i>Apêndices</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="basepeixes.html"><a href="basepeixes.html#tabelas-e-figuras"><i class="fa fa-check"></i><b>4.5.1</b> Tabelas e Figuras</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="basepeixes.html"><a href="basepeixes.html#referências-2"><i class="fa fa-check"></i>Referências</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="basehab.html"><a href="basehab.html"><i class="fa fa-check"></i><b>5</b> Base de Dados II - Habitat</a>
<ul>
<li class="chapter" data-level="" data-path="basehab.html"><a href="basehab.html#estrutura-do-habitat-variáveis-ambientais-no-semiárido"><i class="fa fa-check"></i>Estrutura do Habitat: Variáveis ambientais no semiárido</a></li>
<li class="chapter" data-level="" data-path="basehab.html"><a href="basehab.html#apresentação-2"><i class="fa fa-check"></i>Apresentação</a></li>
<li class="chapter" data-level="" data-path="basehab.html"><a href="basehab.html#resumo-3"><i class="fa fa-check"></i>RESUMO</a></li>
<li class="chapter" data-level="5.1" data-path="basehab.html"><a href="basehab.html#introdução-1"><i class="fa fa-check"></i><b>5.1</b> Introdução</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="basehab.html"><a href="basehab.html#desenho-amostral-1"><i class="fa fa-check"></i><b>5.1.1</b> Desenho Amostral</a></li>
<li class="chapter" data-level="5.1.2" data-path="basehab.html"><a href="basehab.html#sobre-os-dados-do-ppbio-1"><i class="fa fa-check"></i><b>5.1.2</b> Sobre os dados do PPBio</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="basehab.html"><a href="basehab.html#codificação-para-variáveis"><i class="fa fa-check"></i><b>5.2</b> Codificação para variáveis</a></li>
<li class="chapter" data-level="5.3" data-path="basehab.html"><a href="basehab.html#área-de-estudo-e-amostragem-dos-dados"><i class="fa fa-check"></i><b>5.3</b> Área de estudo e amostragem dos dados</a></li>
<li class="chapter" data-level="5.4" data-path="basehab.html"><a href="basehab.html#análises-estatísticas-1"><i class="fa fa-check"></i><b>5.4</b> Análises estatísticas</a></li>
<li class="chapter" data-level="5.5" data-path="basehab.html"><a href="basehab.html#resultados"><i class="fa fa-check"></i><b>5.5</b> Resultados</a></li>
<li class="chapter" data-level="5.6" data-path="basehab.html"><a href="basehab.html#discussão-1"><i class="fa fa-check"></i><b>5.6</b> Discussão</a></li>
<li class="chapter" data-level="" data-path="basehab.html"><a href="basehab.html#apêndices-2"><i class="fa fa-check"></i>Apêndices</a></li>
<li class="chapter" data-level="" data-path="basehab.html"><a href="basehab.html#referências-3"><i class="fa fa-check"></i>Referências</a></li>
</ul></li>
<li class="part"><span><b>II ESTATÍSTICAS DESCRITIVAS</b></span></li>
<li class="chapter" data-level="6" data-path="xls.html"><a href="xls.html"><i class="fa fa-check"></i><b>6</b> R Modulo 1 - Importando planilhas de dados</a>
<ul>
<li class="chapter" data-level="" data-path="xls.html"><a href="xls.html#resumo-4"><i class="fa fa-check"></i>RESUMO</a></li>
<li class="chapter" data-level="" data-path="xls.html"><a href="xls.html#apresentação-3"><i class="fa fa-check"></i>Apresentação</a></li>
<li class="chapter" data-level="6.1" data-path="xls.html"><a href="xls.html#instalação-do-r-e-rstudio"><i class="fa fa-check"></i><b>6.1</b> Instalação do R e RStudio</a></li>
<li class="chapter" data-level="6.2" data-path="xls.html"><a href="xls.html#r-base"><i class="fa fa-check"></i><b>6.2</b> R base</a></li>
<li class="chapter" data-level="6.3" data-path="xls.html"><a href="xls.html#rstudio"><i class="fa fa-check"></i><b>6.3</b> RStudio</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="xls.html"><a href="xls.html#rstudio-na-nuvem"><i class="fa fa-check"></i><b>6.3.1</b> RStudio na nuvem</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="xls.html"><a href="xls.html#sobre-os-dados-do-ppbio-2"><i class="fa fa-check"></i><b>6.4</b> Sobre os dados do PPBio</a></li>
<li class="chapter" data-level="6.5" data-path="xls.html"><a href="xls.html#importando-a-planilha-de-trabalho"><i class="fa fa-check"></i><b>6.5</b> Importando a planilha de trabalho</a></li>
<li class="chapter" data-level="6.6" data-path="xls.html"><a href="xls.html#mensagens-de-erro-e-avisos-no-r"><i class="fa fa-check"></i><b>6.6</b> Mensagens de erro e avisos no R</a></li>
<li class="chapter" data-level="6.7" data-path="xls.html"><a href="xls.html#organização-básica"><i class="fa fa-check"></i><b>6.7</b> Organização básica</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="xls.html"><a href="xls.html#prefira-sempre-códigos-e-scripts-do-que-mouse-e-menus-de-janelas-no-r"><i class="fa fa-check"></i><b>6.7.1</b> Prefira sempre códigos e scripts do que mouse e menus de janelas no R</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="xls.html"><a href="xls.html#importando-a-planilha"><i class="fa fa-check"></i><b>6.8</b> Importando a planilha</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="xls.html"><a href="xls.html#outra-forma-de-achar-e-importar-uma-planilha"><i class="fa fa-check"></i><b>6.8.1</b> Outra forma de achar e importar uma planilha</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="xls.html"><a href="xls.html#importando-.ods-do-libreoffice-calc"><i class="fa fa-check"></i><b>6.9</b> Importando <code>.ods</code> do LibreOffice Calc</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="xls.html"><a href="xls.html#colunas-com-o-mesmo-nome"><i class="fa fa-check"></i><b>6.9.1</b> Colunas com o mesmo nome</a></li>
<li class="chapter" data-level="6.9.2" data-path="xls.html"><a href="xls.html#removendo-linhas-ou-colunas-por-nome"><i class="fa fa-check"></i><b>6.9.2</b> Removendo linhas ou colunas por nome</a></li>
<li class="chapter" data-level="6.9.3" data-path="xls.html"><a href="xls.html#criando-uma-matriz-de-médias"><i class="fa fa-check"></i><b>6.9.3</b> Criando uma matriz de médias</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="xls.html"><a href="xls.html#apêndices-3"><i class="fa fa-check"></i>Apêndices</a>
<ul>
<li class="chapter" data-level="" data-path="xls.html"><a href="xls.html#sites-consultados-1"><i class="fa fa-check"></i>Sites consultados</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="xls.html"><a href="xls.html#script-limpo"><i class="fa fa-check"></i>Script limpo</a></li>
<li class="chapter" data-level="" data-path="xls.html"><a href="xls.html#referências-4"><i class="fa fa-check"></i>Referências</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="tiposR.html"><a href="tiposR.html"><i class="fa fa-check"></i><b>7</b> R Modulo 2 - Tipos de Dados no R</a>
<ul>
<li class="chapter" data-level="" data-path="tiposR.html"><a href="tiposR.html#apresentação-4"><i class="fa fa-check"></i>Apresentação</a></li>
<li class="chapter" data-level="7.1" data-path="tiposR.html"><a href="tiposR.html#tipos-e-estruturas-de-dados-no-r"><i class="fa fa-check"></i><b>7.1</b> Tipos e estruturas de dados no R</a></li>
<li class="chapter" data-level="7.2" data-path="tiposR.html"><a href="tiposR.html#mensagens-de-erro-e-avisos-no-r-1"><i class="fa fa-check"></i><b>7.2</b> Mensagens de erro e avisos no R</a></li>
<li class="chapter" data-level="7.3" data-path="tiposR.html"><a href="tiposR.html#o-que-é-um-script-e-qual-sua-diferença-para-um-código"><i class="fa fa-check"></i><b>7.3</b> O que é um <code>script</code> e qual sua diferença para um <code>código</code>?</a></li>
<li class="chapter" data-level="7.4" data-path="tiposR.html"><a href="tiposR.html#tipos-e-estruturas-de-dados-no-r-1"><i class="fa fa-check"></i><b>7.4</b> Tipos e estruturas de dados no R</a></li>
<li class="chapter" data-level="7.5" data-path="tiposR.html"><a href="tiposR.html#tipos-de-dados-no-r"><i class="fa fa-check"></i><b>7.5</b> Tipos de dados no R</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="tiposR.html"><a href="tiposR.html#variáveis-e-tipos-básicos-de-dados-figura-reffignucleos"><i class="fa fa-check"></i><b>7.5.1</b> Variáveis e tipos básicos de dados (Figura @ref(fig:nucleos))</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="tiposR.html"><a href="tiposR.html#estruturas-de-dados-no-r"><i class="fa fa-check"></i><b>7.6</b> Estruturas de dados no R</a></li>
<li class="chapter" data-level="7.7" data-path="tiposR.html"><a href="tiposR.html#como-pedir-ajuda"><i class="fa fa-check"></i><b>7.7</b> Como pedir ajuda?</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="tiposR.html"><a href="tiposR.html#dentro-do-r"><i class="fa fa-check"></i><b>7.7.1</b> Dentro do R</a></li>
<li class="chapter" data-level="7.7.2" data-path="tiposR.html"><a href="tiposR.html#fora-do-r"><i class="fa fa-check"></i><b>7.7.2</b> Fora do R</a></li>
<li class="chapter" data-level="7.7.3" data-path="tiposR.html"><a href="tiposR.html#chatgpt"><i class="fa fa-check"></i><b>7.7.3</b> ChatGPT</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="tiposR.html"><a href="tiposR.html#work-flow"><i class="fa fa-check"></i><b>7.8</b> Work flow</a></li>
<li class="chapter" data-level="7.9" data-path="tiposR.html"><a href="tiposR.html#reconhecendo-a-estrutura-dos-dados-do-r-em-uma-matriz-multivariada"><i class="fa fa-check"></i><b>7.9</b> Reconhecendo a estrutura dos dados do R em uma matriz multivariada</a>
<ul>
<li class="chapter" data-level="7.9.1" data-path="tiposR.html"><a href="tiposR.html#organização-básica-1"><i class="fa fa-check"></i><b>7.9.1</b> Organização básica</a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="tiposR.html"><a href="tiposR.html#importando-a-planilha-1"><i class="fa fa-check"></i><b>7.10</b> Importando a planilha</a></li>
<li class="chapter" data-level="" data-path="tiposR.html"><a href="tiposR.html#apêndices-4"><i class="fa fa-check"></i>Apêndices</a>
<ul>
<li class="chapter" data-level="" data-path="tiposR.html"><a href="tiposR.html#snippet-e-chunk"><i class="fa fa-check"></i>Snippet e chunk</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tiposR.html"><a href="tiposR.html#sites-consultados-2"><i class="fa fa-check"></i>Sites consultados</a></li>
<li class="chapter" data-level="" data-path="tiposR.html"><a href="tiposR.html#script-limpo-1"><i class="fa fa-check"></i>Script limpo</a></li>
<li class="chapter" data-level="" data-path="tiposR.html"><a href="tiposR.html#referências-5"><i class="fa fa-check"></i>Referências</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="univ.html"><a href="univ.html"><i class="fa fa-check"></i><b>8</b> R Modulo 3.1 - Estatísticas descritivas e Normalidade</a>
<ul>
<li class="chapter" data-level="" data-path="univ.html"><a href="univ.html#resumo-5"><i class="fa fa-check"></i>RESUMO</a></li>
<li class="chapter" data-level="" data-path="univ.html"><a href="univ.html#apresentação-5"><i class="fa fa-check"></i>Apresentação</a></li>
<li class="chapter" data-level="8.1" data-path="univ.html"><a href="univ.html#sobre-os-dados"><i class="fa fa-check"></i><b>8.1</b> Sobre os dados</a></li>
<li class="chapter" data-level="8.2" data-path="univ.html"><a href="univ.html#organização-básica-2"><i class="fa fa-check"></i><b>8.2</b> Organização básica</a></li>
<li class="chapter" data-level="8.3" data-path="univ.html"><a href="univ.html#importando-a-planilha-2"><i class="fa fa-check"></i><b>8.3</b> Importando a planilha</a></li>
<li class="chapter" data-level="8.4" data-path="univ.html"><a href="univ.html#gráficos-de-histograma-e-boxplot"><i class="fa fa-check"></i><b>8.4</b> Gráficos de histograma e boxplot</a></li>
<li class="chapter" data-level="8.5" data-path="univ.html"><a href="univ.html#sumário-estatístico-geral"><i class="fa fa-check"></i><b>8.5</b> Sumário estatístico geral</a></li>
<li class="chapter" data-level="" data-path="univ.html"><a href="univ.html#apêndices-5"><i class="fa fa-check"></i>Apêndices</a></li>
<li class="chapter" data-level="" data-path="univ.html"><a href="univ.html#sites-consultados-3"><i class="fa fa-check"></i>Sites consultados</a></li>
<li class="chapter" data-level="" data-path="univ.html"><a href="univ.html#script-limpo-2"><i class="fa fa-check"></i>Script limpo</a></li>
<li class="chapter" data-level="" data-path="univ.html"><a href="univ.html#referências-6"><i class="fa fa-check"></i>Referências</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="univ2.html"><a href="univ2.html"><i class="fa fa-check"></i><b>9</b> R Modulo 3.2 - Testes Estatísticos</a>
<ul>
<li class="chapter" data-level="" data-path="univ2.html"><a href="univ2.html#resumo-6"><i class="fa fa-check"></i>RESUMO</a></li>
<li class="chapter" data-level="" data-path="univ2.html"><a href="univ2.html#apresentação-6"><i class="fa fa-check"></i>Apresentação</a></li>
<li class="chapter" data-level="9.1" data-path="univ2.html"><a href="univ2.html#sobre-os-dados-1"><i class="fa fa-check"></i><b>9.1</b> Sobre os dados</a></li>
<li class="chapter" data-level="9.2" data-path="univ2.html"><a href="univ2.html#organização-básica-3"><i class="fa fa-check"></i><b>9.2</b> Organização básica</a></li>
<li class="chapter" data-level="9.3" data-path="univ2.html"><a href="univ2.html#importando-a-planilha-3"><i class="fa fa-check"></i><b>9.3</b> Importando a planilha</a></li>
<li class="chapter" data-level="9.4" data-path="univ2.html"><a href="univ2.html#gráficos-de-histograma-e-boxplot-1"><i class="fa fa-check"></i><b>9.4</b> Gráficos de histograma e boxplot</a></li>
<li class="chapter" data-level="9.5" data-path="univ2.html"><a href="univ2.html#sumário-estatístico-geral-1"><i class="fa fa-check"></i><b>9.5</b> Sumário estatístico geral</a></li>
<li class="chapter" data-level="9.6" data-path="univ2.html"><a href="univ2.html#testando-normalidade"><i class="fa fa-check"></i><b>9.6</b> Testando normalidade</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="univ2.html"><a href="univ2.html#q-q-plots"><i class="fa fa-check"></i><b>9.6.1</b> Q-Q plots</a></li>
<li class="chapter" data-level="9.6.2" data-path="univ2.html"><a href="univ2.html#testes-de-shapiro-wilk-e-kolmogorov-smirnov"><i class="fa fa-check"></i><b>9.6.2</b> Testes de Shapiro-Wilk e Kolmogorov-Smirnov</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="univ2.html"><a href="univ2.html#testando-diferenças-entre-médias"><i class="fa fa-check"></i><b>9.7</b> Testando diferenças entre médias</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="univ2.html"><a href="univ2.html#testando-homogeneidade-de-variâncias"><i class="fa fa-check"></i><b>9.7.1</b> Testando homogeneidade de variâncias</a></li>
<li class="chapter" data-level="9.7.2" data-path="univ2.html"><a href="univ2.html#teste-entre-duas-médias-t-student"><i class="fa fa-check"></i><b>9.7.2</b> Teste entre duas médias (t-Student)</a></li>
<li class="chapter" data-level="9.7.3" data-path="univ2.html"><a href="univ2.html#teste-entre-três-médias-anova"><i class="fa fa-check"></i><b>9.7.3</b> Teste entre três médias (ANOVA)</a></li>
<li class="chapter" data-level="9.7.4" data-path="univ2.html"><a href="univ2.html#teste-entre-três-médias-e-dois-fatores-two-way-anova"><i class="fa fa-check"></i><b>9.7.4</b> Teste entre três médias e dois fatores (Two-Way ANOVA)</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="univ2.html"><a href="univ2.html#correlação-e-regressão-simples"><i class="fa fa-check"></i><b>9.8</b> Correlação e regressão simples</a></li>
<li class="chapter" data-level="" data-path="univ2.html"><a href="univ2.html#apêndices-6"><i class="fa fa-check"></i>Apêndices</a></li>
<li class="chapter" data-level="" data-path="univ2.html"><a href="univ2.html#sites-consultados-4"><i class="fa fa-check"></i>Sites consultados</a></li>
<li class="chapter" data-level="" data-path="univ2.html"><a href="univ2.html#script-limpo-3"><i class="fa fa-check"></i>Script limpo</a></li>
<li class="chapter" data-level="" data-path="univ2.html"><a href="univ2.html#referências-7"><i class="fa fa-check"></i>Referências</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="unigr.html"><a href="unigr.html"><i class="fa fa-check"></i><b>10</b> R Modulo 3.3 - Gráficos univariados</a>
<ul>
<li class="chapter" data-level="" data-path="unigr.html"><a href="unigr.html#resumo-7"><i class="fa fa-check"></i>RESUMO</a></li>
<li class="chapter" data-level="" data-path="unigr.html"><a href="unigr.html#apresentação-7"><i class="fa fa-check"></i>Apresentação</a></li>
<li class="chapter" data-level="10.1" data-path="unigr.html"><a href="unigr.html#sobre-os-dados-2"><i class="fa fa-check"></i><b>10.1</b> Sobre os dados</a></li>
<li class="chapter" data-level="10.2" data-path="unigr.html"><a href="unigr.html#organização-básica-4"><i class="fa fa-check"></i><b>10.2</b> Organização básica</a></li>
<li class="chapter" data-level="10.3" data-path="unigr.html"><a href="unigr.html#importando-a-planilha-4"><i class="fa fa-check"></i><b>10.3</b> Importando a planilha</a></li>
<li class="chapter" data-level="10.4" data-path="unigr.html"><a href="unigr.html#reset-point"><i class="fa fa-check"></i><b>10.4</b> Reset point</a></li>
<li class="chapter" data-level="10.5" data-path="unigr.html"><a href="unigr.html#gráficos-de-dispersão"><i class="fa fa-check"></i><b>10.5</b> Gráficos de dispersão</a></li>
<li class="chapter" data-level="10.6" data-path="unigr.html"><a href="unigr.html#gráficos-de-linha"><i class="fa fa-check"></i><b>10.6</b> Gráficos de linha</a></li>
<li class="chapter" data-level="10.7" data-path="unigr.html"><a href="unigr.html#gráficos-de-barra"><i class="fa fa-check"></i><b>10.7</b> Gráficos de barra</a></li>
<li class="chapter" data-level="10.8" data-path="unigr.html"><a href="unigr.html#gráficos-de-grupos"><i class="fa fa-check"></i><b>10.8</b> Gráficos de grupos</a></li>
<li class="chapter" data-level="" data-path="unigr.html"><a href="unigr.html#apêndices-7"><i class="fa fa-check"></i>Apêndices</a></li>
<li class="chapter" data-level="" data-path="unigr.html"><a href="unigr.html#sites-consultados-5"><i class="fa fa-check"></i>Sites consultados</a></li>
<li class="chapter" data-level="" data-path="unigr.html"><a href="unigr.html#script-limpo-4"><i class="fa fa-check"></i>Script limpo</a></li>
<li class="chapter" data-level="" data-path="unigr.html"><a href="unigr.html#referências-8"><i class="fa fa-check"></i>Referências</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="estrcom.html"><a href="estrcom.html"><i class="fa fa-check"></i><b>11</b> R Modulo 4.1 - Estrutura da Comunidade</a>
<ul>
<li class="chapter" data-level="" data-path="estrcom.html"><a href="estrcom.html#resumo-8"><i class="fa fa-check"></i>RESUMO</a></li>
<li class="chapter" data-level="" data-path="estrcom.html"><a href="estrcom.html#apresentação-8"><i class="fa fa-check"></i>Apresentação</a></li>
<li class="chapter" data-level="11.1" data-path="estrcom.html"><a href="estrcom.html#sobre-os-dados-3"><i class="fa fa-check"></i><b>11.1</b> Sobre os dados</a></li>
<li class="chapter" data-level="11.2" data-path="estrcom.html"><a href="estrcom.html#organização-básica-5"><i class="fa fa-check"></i><b>11.2</b> Organização básica</a></li>
<li class="chapter" data-level="11.3" data-path="estrcom.html"><a href="estrcom.html#importando-a-planilha-5"><i class="fa fa-check"></i><b>11.3</b> Importando a planilha</a></li>
<li class="chapter" data-level="11.4" data-path="estrcom.html"><a href="estrcom.html#reset-point-1"><i class="fa fa-check"></i><b>11.4</b> Reset point</a></li>
<li class="chapter" data-level="11.5" data-path="estrcom.html"><a href="estrcom.html#transpor-a-matriz-para-trabalhar-com-as-espécies"><i class="fa fa-check"></i><b>11.5</b> Transpor a matriz para trabalhar com as espécies</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="estrcom.html"><a href="estrcom.html#informações-básicas-da-matriz"><i class="fa fa-check"></i><b>11.5.1</b> Informações básicas da matriz</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="estrcom.html"><a href="estrcom.html#calculando-os-descritores-da-comunidade"><i class="fa fa-check"></i><b>11.6</b> Calculando os descritores da comunidade</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="estrcom.html"><a href="estrcom.html#variabilidade"><i class="fa fa-check"></i><b>11.6.1</b> Variabilidade</a></li>
<li class="chapter" data-level="11.6.2" data-path="estrcom.html"><a href="estrcom.html#riqueza"><i class="fa fa-check"></i><b>11.6.2</b> Riqueza</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="estrcom.html"><a href="estrcom.html#índices-de-diversidade"><i class="fa fa-check"></i><b>11.7</b> Índices de Diversidade</a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="estrcom.html"><a href="estrcom.html#shannon"><i class="fa fa-check"></i><b>11.7.1</b> Shannon</a></li>
<li class="chapter" data-level="11.7.2" data-path="estrcom.html"><a href="estrcom.html#simpson"><i class="fa fa-check"></i><b>11.7.2</b> Simpson</a></li>
<li class="chapter" data-level="11.7.3" data-path="estrcom.html"><a href="estrcom.html#equitabilidade-de-pielou"><i class="fa fa-check"></i><b>11.7.3</b> Equitabilidade de Pielou</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="estrcom.html"><a href="estrcom.html#gráficos-descritivos"><i class="fa fa-check"></i><b>11.8</b> Gráficos descritivos</a>
<ul>
<li class="chapter" data-level="11.8.1" data-path="estrcom.html"><a href="estrcom.html#série-de-hill-e-pefil-da-diversidade"><i class="fa fa-check"></i><b>11.8.1</b> Série de Hill e pefil da diversidade</a></li>
</ul></li>
<li class="chapter" data-level="11.9" data-path="estrcom.html"><a href="estrcom.html#distribuição-de-abundância"><i class="fa fa-check"></i><b>11.9</b> Distribuição de abundância</a></li>
<li class="chapter" data-level="11.10" data-path="estrcom.html"><a href="estrcom.html#curva-de-rarefação"><i class="fa fa-check"></i><b>11.10</b> Curva de rarefação</a>
<ul>
<li class="chapter" data-level="11.10.1" data-path="estrcom.html"><a href="estrcom.html#interpretando-a-curva-de-rarefação"><i class="fa fa-check"></i><b>11.10.1</b> Interpretando a curva de rarefação</a></li>
</ul></li>
<li class="chapter" data-level="11.11" data-path="estrcom.html"><a href="estrcom.html#curva-de-acumulação-de-espécies"><i class="fa fa-check"></i><b>11.11</b> Curva de acumulação de espécies</a>
<ul>
<li class="chapter" data-level="11.11.1" data-path="estrcom.html"><a href="estrcom.html#plot-locais"><i class="fa fa-check"></i><b>11.11.1</b> Plot locais</a></li>
</ul></li>
<li class="chapter" data-level="11.12" data-path="estrcom.html"><a href="estrcom.html#plot-indivíduos"><i class="fa fa-check"></i><b>11.12</b> Plot indivíduos</a></li>
<li class="chapter" data-level="" data-path="estrcom.html"><a href="estrcom.html#apêndices-8"><i class="fa fa-check"></i>Apêndices</a>
<ul>
<li class="chapter" data-level="" data-path="estrcom.html"><a href="estrcom.html#criando-uma-tabela-de-espécies"><i class="fa fa-check"></i>Criando uma tabela de espécies</a></li>
<li class="chapter" data-level="" data-path="estrcom.html"><a href="estrcom.html#descruas"><i class="fa fa-check"></i>Descritores da estrutura da comunidade: UA’s</a></li>
<li class="chapter" data-level="" data-path="estrcom.html"><a href="estrcom.html#descritores-da-normalidade-1"><i class="fa fa-check"></i>Descritores da normalidade</a></li>
<li class="chapter" data-level="" data-path="estrcom.html"><a href="estrcom.html#salvando-as-tabelas-criadas-em-txt-direto-no-diretório-de-trabalho"><i class="fa fa-check"></i>Salvando as tabelas criadas em txt direto no diretório de trabalho</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="estrcom.html"><a href="estrcom.html#sites-consultados-6"><i class="fa fa-check"></i>Sites consultados</a></li>
<li class="chapter" data-level="" data-path="estrcom.html"><a href="estrcom.html#script-limpo-5"><i class="fa fa-check"></i>Script limpo</a></li>
<li class="chapter" data-level="" data-path="estrcom.html"><a href="estrcom.html#referências-9"><i class="fa fa-check"></i>Referências</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="partdiv.html"><a href="partdiv.html"><i class="fa fa-check"></i><b>12</b> R Modulo 4.2 - Decomposição da diversidade</a>
<ul>
<li class="chapter" data-level="" data-path="partdiv.html"><a href="partdiv.html#resumo-9"><i class="fa fa-check"></i>RESUMO</a></li>
<li class="chapter" data-level="" data-path="partdiv.html"><a href="partdiv.html#apresentação-9"><i class="fa fa-check"></i>Apresentação</a></li>
<li class="chapter" data-level="12.1" data-path="partdiv.html"><a href="partdiv.html#sobre-os-dados-4"><i class="fa fa-check"></i><b>12.1</b> Sobre os dados</a></li>
<li class="chapter" data-level="12.2" data-path="partdiv.html"><a href="partdiv.html#organização-básica-6"><i class="fa fa-check"></i><b>12.2</b> Organização básica</a></li>
<li class="chapter" data-level="" data-path="partdiv.html"><a href="partdiv.html#apêndices-9"><i class="fa fa-check"></i>Apêndices</a>
<ul>
<li class="chapter" data-level="" data-path="partdiv.html"><a href="partdiv.html#sites-consultados-7"><i class="fa fa-check"></i>Sites consultados</a></li>
<li class="chapter" data-level="" data-path="partdiv.html"><a href="partdiv.html#script-limpo-6"><i class="fa fa-check"></i>Script limpo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="partdiv.html"><a href="partdiv.html#referências-10"><i class="fa fa-check"></i>Referências</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="estrhab.html"><a href="estrhab.html"><i class="fa fa-check"></i><b>13</b> R Modulo 4.2 - Estrutura do habitat</a>
<ul>
<li class="chapter" data-level="" data-path="estrhab.html"><a href="estrhab.html#resumo-10"><i class="fa fa-check"></i>RESUMO</a></li>
<li class="chapter" data-level="" data-path="estrhab.html"><a href="estrhab.html#apresentação-10"><i class="fa fa-check"></i>Apresentação</a></li>
<li class="chapter" data-level="13.1" data-path="estrhab.html"><a href="estrhab.html#sobre-os-dados-5"><i class="fa fa-check"></i><b>13.1</b> Sobre os dados</a></li>
<li class="chapter" data-level="13.2" data-path="estrhab.html"><a href="estrhab.html#organização-básica-7"><i class="fa fa-check"></i><b>13.2</b> Organização básica</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="estrhab.html"><a href="estrhab.html#instalando-os-pacotes-necessários-para-esse-módulo."><i class="fa fa-check"></i><b>13.2.1</b> Instalando os pacotes necessários para esse módulo.</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="estrhab.html"><a href="estrhab.html#importando-a-planilha-6"><i class="fa fa-check"></i><b>13.3</b> Importando a planilha</a></li>
<li class="chapter" data-level="13.4" data-path="estrhab.html"><a href="estrhab.html#reset-point-2"><i class="fa fa-check"></i><b>13.4</b> Reset point</a></li>
<li class="chapter" data-level="13.5" data-path="estrhab.html"><a href="estrhab.html#correlograma-e-remoção-de-variáveis-redundantes-ou-desnecessárias"><i class="fa fa-check"></i><b>13.5</b> Correlograma e remoção de variáveis redundantes ou desnecessárias</a></li>
<li class="chapter" data-level="13.6" data-path="estrhab.html"><a href="estrhab.html#deletando-variáveis-colineares"><i class="fa fa-check"></i><b>13.6</b> Deletando variáveis colineares</a></li>
<li class="chapter" data-level="13.7" data-path="estrhab.html"><a href="estrhab.html#somando-variáveis-redundantes"><i class="fa fa-check"></i><b>13.7</b> Somando variáveis redundantes</a></li>
<li class="chapter" data-level="13.8" data-path="estrhab.html"><a href="estrhab.html#tabela-de-dados-ambientais"><i class="fa fa-check"></i><b>13.8</b> Tabela de dados ambientais</a></li>
<li class="chapter" data-level="" data-path="estrhab.html"><a href="estrhab.html#apêndices-10"><i class="fa fa-check"></i>Apêndices</a></li>
<li class="chapter" data-level="" data-path="estrhab.html"><a href="estrhab.html#sites-consultados-8"><i class="fa fa-check"></i>Sites consultados</a></li>
<li class="chapter" data-level="" data-path="estrhab.html"><a href="estrhab.html#script-limpo-7"><i class="fa fa-check"></i>Script limpo</a></li>
<li class="chapter" data-level="" data-path="estrhab.html"><a href="estrhab.html#referências-11"><i class="fa fa-check"></i>Referências</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="reltrns.html"><a href="reltrns.html"><i class="fa fa-check"></i><b>14</b> R Modulo 5 - Relativizações e transformações</a>
<ul>
<li class="chapter" data-level="" data-path="reltrns.html"><a href="reltrns.html#resumo-11"><i class="fa fa-check"></i>RESUMO</a></li>
<li class="chapter" data-level="" data-path="reltrns.html"><a href="reltrns.html#apresentação-11"><i class="fa fa-check"></i>Apresentação</a></li>
<li class="chapter" data-level="14.1" data-path="reltrns.html"><a href="reltrns.html#organização-básica-8"><i class="fa fa-check"></i><b>14.1</b> Organização básica</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="reltrns.html"><a href="reltrns.html#importando-a-planilha-7"><i class="fa fa-check"></i><b>14.1.1</b> Importando a planilha</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="reltrns.html"><a href="reltrns.html#tamanho-da-matriz"><i class="fa fa-check"></i><b>14.2</b> Tamanho da matriz</a></li>
<li class="chapter" data-level="14.3" data-path="reltrns.html"><a href="reltrns.html#reset-point-1-1"><i class="fa fa-check"></i><b>14.3</b> Reset point 1</a></li>
<li class="chapter" data-level="14.4" data-path="reltrns.html"><a href="reltrns.html#cálculo-da-matriz-de-distâncias"><i class="fa fa-check"></i><b>14.4</b> Cálculo da matriz de distâncias</a></li>
<li class="chapter" data-level="14.5" data-path="reltrns.html"><a href="reltrns.html#distribuição-de-frequência-da-matriz-de-distâncias"><i class="fa fa-check"></i><b>14.5</b> Distribuição de frequência da matriz de distâncias</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="reltrns.html"><a href="reltrns.html#calculando-alguns-parâmetros-básicos"><i class="fa fa-check"></i><b>14.5.1</b> Calculando alguns parâmetros básicos</a></li>
<li class="chapter" data-level="14.5.2" data-path="reltrns.html"><a href="reltrns.html#calculando-a-assimetria-e-a-curtose"><i class="fa fa-check"></i><b>14.5.2</b> Calculando a assimetria e a curtose</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="reltrns.html"><a href="reltrns.html#distribuição-de-frequências-da-matriz-de-distâncias"><i class="fa fa-check"></i><b>14.6</b> Distribuição de frequências da matriz de distâncias</a></li>
<li class="chapter" data-level="14.7" data-path="reltrns.html"><a href="reltrns.html#relativizando-e-transformando-a-base-de-dados"><i class="fa fa-check"></i><b>14.7</b> Relativizando e transformando a base de dados</a>
<ul>
<li class="chapter" data-level="14.7.1" data-path="reltrns.html"><a href="reltrns.html#relativização-pelo-total"><i class="fa fa-check"></i><b>14.7.1</b> Relativização pelo total</a></li>
<li class="chapter" data-level="14.7.2" data-path="reltrns.html"><a href="reltrns.html#transformação-pelo-arcoseno-da-raiz-quadrada"><i class="fa fa-check"></i><b>14.7.2</b> Transformação pelo arcoseno da raiz quadrada</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="reltrns.html"><a href="reltrns.html#reset-point-2-1"><i class="fa fa-check"></i><b>14.8</b> Reset point 2</a></li>
<li class="chapter" data-level="" data-path="reltrns.html"><a href="reltrns.html#apêndices-11"><i class="fa fa-check"></i>Apêndices</a>
<ul>
<li class="chapter" data-level="" data-path="reltrns.html"><a href="reltrns.html#relativizações"><i class="fa fa-check"></i>Relativizações</a></li>
<li class="chapter" data-level="" data-path="reltrns.html"><a href="reltrns.html#transformações"><i class="fa fa-check"></i>Transformações</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="reltrns.html"><a href="reltrns.html#script-limpo-8"><i class="fa fa-check"></i>Script limpo</a></li>
<li class="chapter" data-level="" data-path="reltrns.html"><a href="reltrns.html#referências-12"><i class="fa fa-check"></i>Referências</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="outcentr.html"><a href="outcentr.html"><i class="fa fa-check"></i><b>15</b> R Modulo 6 - Análise de outliers baseada no desvio padrão do centróide</a>
<ul>
<li class="chapter" data-level="" data-path="outcentr.html"><a href="outcentr.html#apresentação-12"><i class="fa fa-check"></i>Apresentação</a></li>
<li class="chapter" data-level="15.1" data-path="outcentr.html"><a href="outcentr.html#sobre-os-dados-do-ppbio-3"><i class="fa fa-check"></i><b>15.1</b> Sobre os dados do PPBio</a></li>
<li class="chapter" data-level="15.2" data-path="outcentr.html"><a href="outcentr.html#organização-básica-9"><i class="fa fa-check"></i><b>15.2</b> Organização básica</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="outcentr.html"><a href="outcentr.html#importando-a-planilha-8"><i class="fa fa-check"></i><b>15.2.1</b> Importando a planilha</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="outcentr.html"><a href="outcentr.html#reset-point-3"><i class="fa fa-check"></i><b>15.3</b> Reset point</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="outcentr.html"><a href="outcentr.html#tamanho-da-matriz-1"><i class="fa fa-check"></i><b>15.3.1</b> Tamanho da matriz</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="outcentr.html"><a href="outcentr.html#cálculo-de-matriz-de-distâncias-euclidiana-euclid"><i class="fa fa-check"></i><b>15.4</b> Cálculo de matriz de distâncias Euclidiana (<code>euclid</code>)</a></li>
<li class="chapter" data-level="15.5" data-path="outcentr.html"><a href="outcentr.html#calculando-o-centróide-da-matriz-de-distâncias-euclid"><i class="fa fa-check"></i><b>15.5</b> Calculando o centróide da matriz de distâncias <code>euclid</code></a></li>
<li class="chapter" data-level="15.6" data-path="outcentr.html"><a href="outcentr.html#distribuição-de-frequências-da-matriz-de-distâncias-euclid"><i class="fa fa-check"></i><b>15.6</b> Distribuição de frequências da matriz de distâncias <code>euclid</code></a></li>
<li class="chapter" data-level="15.7" data-path="outcentr.html"><a href="outcentr.html#procurando-outliers"><i class="fa fa-check"></i><b>15.7</b> Procurando outliers</a>
<ul>
<li class="chapter" data-level="15.7.1" data-path="outcentr.html"><a href="outcentr.html#listas-de-distâncias"><i class="fa fa-check"></i><b>15.7.1</b> Listas de distâncias</a></li>
<li class="chapter" data-level="15.7.2" data-path="outcentr.html"><a href="outcentr.html#distribuição-de-frequências-das-distâncias-médias-para-o-centróide-av.dist"><i class="fa fa-check"></i><b>15.7.2</b> Distribuição de frequências das distâncias médias para o centróide <code>av.dist</code></a></li>
</ul></li>
<li class="chapter" data-level="15.8" data-path="outcentr.html"><a href="outcentr.html#lista-final-de-outliers"><i class="fa fa-check"></i><b>15.8</b> Lista final de outliers</a></li>
<li class="chapter" data-level="15.9" data-path="outcentr.html"><a href="outcentr.html#particionando-a-matriz"><i class="fa fa-check"></i><b>15.9</b> Particionando a matriz</a></li>
<li class="chapter" data-level="15.10" data-path="outcentr.html"><a href="outcentr.html#exportando-a-matrix-final-de-trabalho"><i class="fa fa-check"></i><b>15.10</b> Exportando a matrix final de trabalho</a></li>
<li class="chapter" data-level="" data-path="outcentr.html"><a href="outcentr.html#apêndices-12"><i class="fa fa-check"></i>Apêndices</a>
<ul>
<li class="chapter" data-level="" data-path="outcentr.html"><a href="outcentr.html#outras-formas-de-fazer-a-partição"><i class="fa fa-check"></i>Outras formas de fazer a partição</a></li>
<li class="chapter" data-level="" data-path="outcentr.html"><a href="outcentr.html#código"><i class="fa fa-check"></i>Código</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="outcentr.html"><a href="outcentr.html#script-limpo-9"><i class="fa fa-check"></i>Script limpo</a></li>
<li class="chapter" data-level="" data-path="outcentr.html"><a href="outcentr.html#referências-13"><i class="fa fa-check"></i>Referências</a></li>
</ul></li>
<li class="part"><span><b>III ANÁLISES MULTIVARIADAS</b></span></li>
<li class="chapter" data-level="16" data-path="upgma.html"><a href="upgma.html"><i class="fa fa-check"></i><b>16</b> R Modulo 7 - Análise de Classificação Hierárquica - SAHN</a>
<ul>
<li class="chapter" data-level="" data-path="upgma.html"><a href="upgma.html#resumo-12"><i class="fa fa-check"></i>RESUMO</a></li>
<li class="chapter" data-level="" data-path="upgma.html"><a href="upgma.html#apresentação-13"><i class="fa fa-check"></i>Apresentação</a></li>
<li class="chapter" data-level="16.1" data-path="upgma.html"><a href="upgma.html#organização-básica-10"><i class="fa fa-check"></i><b>16.1</b> Organização básica</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="upgma.html"><a href="upgma.html#pacotes"><i class="fa fa-check"></i><b>16.1.1</b> Pacotes</a></li>
<li class="chapter" data-level="16.1.2" data-path="upgma.html"><a href="upgma.html#sobre-os-dados-do-ppbio-4"><i class="fa fa-check"></i><b>16.1.2</b> Sobre os dados do PPBio</a></li>
<li class="chapter" data-level="16.1.3" data-path="upgma.html"><a href="upgma.html#importando-a-planilha-de-trabalho-1"><i class="fa fa-check"></i><b>16.1.3</b> Importando a planilha de trabalho</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="upgma.html"><a href="upgma.html#reset-point-4"><i class="fa fa-check"></i><b>16.2</b> Reset point</a></li>
<li class="chapter" data-level="16.3" data-path="upgma.html"><a href="upgma.html#nomenclatura-das-matrizes-em-amd"><i class="fa fa-check"></i><b>16.3</b> Nomenclatura das matrizes em AMD</a></li>
<li class="chapter" data-level="16.4" data-path="upgma.html"><a href="upgma.html#cluster-1-piloto-automático"><i class="fa fa-check"></i><b>16.4</b> Cluster 1: Piloto automático</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="upgma.html"><a href="upgma.html#histórico-das-fusões"><i class="fa fa-check"></i><b>16.4.1</b> Histórico das fusões</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="upgma.html"><a href="upgma.html#cluster-2-criando-a-matriz-de-distâncias-euclidiana"><i class="fa fa-check"></i><b>16.5</b> Cluster 2: Criando a matriz de distâncias Euclidiana</a>
<ul>
<li class="chapter" data-level="16.5.1" data-path="upgma.html"><a href="upgma.html#comparação-dos-resultados-obtidos-até-aqui"><i class="fa fa-check"></i><b>16.5.1</b> Comparação dos resultados obtidos até aqui</a></li>
</ul></li>
<li class="chapter" data-level="16.6" data-path="upgma.html"><a href="upgma.html#cluster-3-relativização-pelo-total-da-coluna"><i class="fa fa-check"></i><b>16.6</b> Cluster 3: Relativização pelo total da coluna</a>
<ul>
<li class="chapter" data-level="16.6.1" data-path="upgma.html"><a href="upgma.html#gráfico-de-clustering-relativizado"><i class="fa fa-check"></i><b>16.6.1</b> Gráfico de clustering relativizado</a></li>
</ul></li>
<li class="chapter" data-level="16.7" data-path="upgma.html"><a href="upgma.html#cluster-4-transformação-pelo-arcoseno-da-raiz-quadrada"><i class="fa fa-check"></i><b>16.7</b> Cluster 4: Transformação pelo arcoseno da raiz quadrada</a>
<ul>
<li class="chapter" data-level="16.7.1" data-path="upgma.html"><a href="upgma.html#gráfico-de-clustering-relativizadotransformado"><i class="fa fa-check"></i><b>16.7.1</b> Gráfico de clustering relativizado/transformado</a></li>
</ul></li>
<li class="chapter" data-level="16.8" data-path="upgma.html"><a href="upgma.html#cluster-5-controle-total-dos-parâmetros"><i class="fa fa-check"></i><b>16.8</b> Cluster 5: Controle total dos parâmetros</a></li>
<li class="chapter" data-level="16.9" data-path="upgma.html"><a href="upgma.html#construindo-uma-prancha-de-gráficos-comparativos"><i class="fa fa-check"></i><b>16.9</b> Construindo uma prancha de gráficos comparativos</a></li>
<li class="chapter" data-level="16.10" data-path="upgma.html"><a href="upgma.html#construindo-heatmaps"><i class="fa fa-check"></i><b>16.10</b> Construindo <code>heatmaps</code></a>
<ul>
<li class="chapter" data-level="16.10.1" data-path="upgma.html"><a href="upgma.html#percentual-de-encadeamento-chaining"><i class="fa fa-check"></i><b>16.10.1</b> Percentual de encadeamento (% chaining)</a></li>
<li class="chapter" data-level="16.10.2" data-path="upgma.html"><a href="upgma.html#função-loop-para-comparar-os-encadeamentos"><i class="fa fa-check"></i><b>16.10.2</b> Função <code>loop</code> para comparar os encadeamentos</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="upgma.html"><a href="upgma.html#apêndices-13"><i class="fa fa-check"></i>Apêndices</a></li>
<li class="chapter" data-level="" data-path="upgma.html"><a href="upgma.html#sites-consultados-9"><i class="fa fa-check"></i>Sites consultados</a>
<ul>
<li class="chapter" data-level="" data-path="upgma.html"><a href="upgma.html#outras-formas-de-fazer-a-partição-1"><i class="fa fa-check"></i>Outras formas de fazer a partição</a></li>
<li class="chapter" data-level="" data-path="upgma.html"><a href="upgma.html#código-1"><i class="fa fa-check"></i>Código</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="upgma.html"><a href="upgma.html#script-limpo-10"><i class="fa fa-check"></i>Script limpo</a></li>
<li class="chapter" data-level="" data-path="upgma.html"><a href="upgma.html#referências-14"><i class="fa fa-check"></i>Referências</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bibliografia.html"><a href="bibliografia.html"><i class="fa fa-check"></i>Bibliografia</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Fundamentos de Ecologia Numérica</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="upgma" class="section level1 hasAnchor" number="16">
<h1><span class="header-section-number"> 16</span> R Modulo 7 - Análise de Classificação Hierárquica - SAHN<a href="upgma.html#upgma" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="resumo-12" class="section level3 unnumbered hasAnchor">
<h3>RESUMO<a href="upgma.html#resumo-12" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Análise de Classificação Hierárquica (SAHN) é um método de análise de dados utilizado para identificar grupos ou clusters de objetos com base em sua similaridade. É amplamente utilizada em várias áreas, incluindo bioinformática, análise de dados espaciais, agronomia, entre outros. A análise de classificação hierárquica é uma técnica exploratória importante que pode ajudar a identificar padrões e relações em dados não estruturados. No entanto, é importante lembrar que a interpretação dos resultados pode ser subjetiva e depender do contexto da aplicação.</p>
</div>
<div id="apresentação-13" class="section level3 unnumbered hasAnchor">
<h3>Apresentação<a href="upgma.html#apresentação-13" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Análise de Classificação Hierárquica (do inglês, “Hierarchical Agglomerative Clustering Analysis”, ou simplesmente “SAHN”) é um método de análise de dados utilizado para identificar grupos ou “clusters” de objetos com base em sua similaridade. Nessa análise, os objetos são inicialmente considerados como clusters individuais e, em seguida, os objetos mais similares são agrupados em um cluster maior, e assim por diante, até que todos os objetos estejam em um único cluster. Isso resulta em uma árvore hierárquica, conhecida como dendrograma, que mostra a relação de similaridade entre os objetos.</p>
<p>Existem dois tipos principais de classificação hierárquica: aglomerativa e divisiva. O método aglomerativo é mais comum e começa com cada objeto em seu próprio cluster, e sucessivamente agrupa os objetos mais próximos, enquanto o método divisivo começa com todos os objetos em um único cluster e sucessivamente divide-os em grupos menores.</p>
<p>Análises de classificação são amplamente utilizadas em várias áreas, incluindo bioinformática, análise de dados espaciais, agronomia, entre outros. Além disso, pode ser utilizada com diferentes medidas de distância e diferentes métodos de agrupamento, como, por exemplo, o método “complete-linkage”, “single-linkage”, “average-linkage”, entre outros.</p>
<p>A Análise de Classificação Hierárquica é uma técnica exploratória importante que pode ajudar a identificar padrões e relações em dados não estruturados. No entanto, é importante lembrar que a interpretação dos resultados pode ser subjetiva e depender do contexto da aplicação.</p>
</div>
<div id="organização-básica-10" class="section level2 hasAnchor" number="16.1">
<h2><span class="header-section-number">16.1</span> Organização básica<a href="upgma.html#organização-básica-10" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="upgma.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>() <span class="co">#apaga os graficos, se houver algum</span></span>
<span id="cb1-2"><a href="upgma.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>(<span class="at">all=</span><span class="cn">TRUE</span>)) <span class="do">##LIMPA A MEMORIA</span></span>
<span id="cb1-3"><a href="upgma.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\014</span><span class="st">&quot;</span>) <span class="co">#limpa o console </span></span>
<span id="cb1-4"><a href="upgma.html#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#rm(list=ls(all=TRUE)); cat(&quot;\014&quot;); dev.off() # tudo na mesma linha</span></span></code></pre></div>
<div id="pacotes" class="section level3 hasAnchor" number="16.1.1">
<h3><span class="header-section-number">16.1.1</span> Pacotes<a href="upgma.html#pacotes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Instalando os pacotes necessários para esse módulo</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="upgma.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>)</span>
<span id="cb2-2"><a href="upgma.html#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;openxlsx&quot;</span>)</span>
<span id="cb2-3"><a href="upgma.html#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;vegan&quot;</span>)</span>
<span id="cb2-4"><a href="upgma.html#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;dplyr&quot;</span>)</span>
<span id="cb2-5"><a href="upgma.html#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;RColorBrewer&quot;</span>)</span>
<span id="cb2-6"><a href="upgma.html#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;gplots&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="upgma.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## Warning: package &#39;ggplot2&#39; was built under R version 4.3.3</code></pre>
<pre><code>## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
## ✔ dplyr     1.1.2     ✔ readr     2.1.4
## ✔ forcats   1.0.0     ✔ stringr   1.5.0
## ✔ ggplot2   3.5.1     ✔ tibble    3.2.1
## ✔ lubridate 1.9.2     ✔ tidyr     1.3.0
## ✔ purrr     1.0.1     
## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()
## ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
<p>Os códigos acima, são usados para instalar os pacotes necessários para este módulo. Esses códigos são comandos para instalar pacotes no R. Um pacote é uma coleção de funções, dados e documentação que ampliam as capacidades do R (<a href="https://cran.r-project.org/">R CRAN</a> e <a href="https://posit.co/download/rstudio-desktop/">RStudio</a>). Depois de instalar um pacote, você precisa carregá-lo na sua sessão R com a função <code>library()</code>. Por exemplo, no código acima, carregamos o pacote <code>tidyverse</code>, usando a função <code>library(openxlsx)</code>. Isso irá permitir que você use as funções do pacote na sua sessão R. Você precisa carregar um pacote toda vez que iniciar uma nova sessão R e quiser usar um pacote instalado. Os demais pacotes instalados serão carregados ao longo desse tutorial a medida que cada pacote for sendo necessário.</p>
<p>Agora vamos <strong>definir o diretório de trabalho</strong>. Esse código é usado para obter e definir o diretório de trabalho atual no R. O comando <code>getwd()</code> retorna o caminho do diretório onde o R está lendo e salvando arquivos. O comando <code>setwd()</code> muda esse diretório de trabalho para o caminho especificado entre aspas. No seu caso, você deve ajustar o caminho para o seu próprio diretório de trabalho. <strong>Lembre de usar a barra “/” entre os diretórios. E não a contra-barra “\”.</strong></p>
<p>Definindo o diretório de trabalho e instalando os pacotes necessários:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="upgma.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span>
<span id="cb6-2"><a href="upgma.html#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&quot;C:/Seu/Diretório/De/Trabalho&quot;</span>)</span></code></pre></div>
<p>Alternativamente você pode ir na barra de tarefas e escolhes as opções:<br />
SESSION -&gt; SET WORKING DIRECTORY -&gt; CHOOSE DIRECTORY</p>
</div>
<div id="sobre-os-dados-do-ppbio-4" class="section level3 hasAnchor" number="16.1.2">
<h3><span class="header-section-number">16.1.2</span> Sobre os dados do PPBio<a href="upgma.html#sobre-os-dados-do-ppbio-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A planilha <code>ppbio</code> contém os dados de abundância de espécies em diferentes unidades amostrais (UA’s) (Figura <a href="upgma.html#fig:27ppbio">16.1</a> (Veja <a href="https://ppbio.inpa.gov.br/Sobre">Programa de Pesquisa em Biodiversidade – PPBio</a>). Essa é a <strong>matriz bruta de dados</strong>, porque os valores ainda não foram ajustados para os valores de Captura Por Unidade de Esforço (CPUE), nem foram relativizados ou transformados.</p>
<div class="figure"><span style="display:block;" id="fig:27ppbio"></span>
<img src="imagens/ppbio.png" alt="Parte da planilha de dados brutos do PPBio." width="476" />
<p class="caption">
Figura 16.1: Parte da planilha de dados brutos do PPBio.
</p>
</div>
</div>
<div id="importando-a-planilha-de-trabalho-1" class="section level3 hasAnchor" number="16.1.3">
<h3><span class="header-section-number">16.1.3</span> Importando a planilha de trabalho<a href="upgma.html#importando-a-planilha-de-trabalho-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Note que o sómbolo <code>#</code> em programação R significa que o texto que vem depois dele é um comentário e não será executado pelo programa. Isso é útil para explicar o código ou deixar anotações. Ajuste a segunda linha do código abaixo para refletir <span style="color:blue">“C:/Seu/Diretório/De/Trabalho/Planilha.xlsx”</span>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="upgma.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)</span></code></pre></div>
<pre><code>## Warning: package &#39;openxlsx&#39; was built under R version 4.3.2</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="upgma.html#cb9-1" aria-hidden="true" tabindex="-1"></a>ppbio <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(<span class="st">&quot;D:/Elvio/OneDrive/Disciplinas/_EcoNumerica/5.Matrizes/ppbio06p-peixes.xlsx&quot;</span>,</span>
<span id="cb9-2"><a href="upgma.html#cb9-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">rowNames =</span> T,</span>
<span id="cb9-3"><a href="upgma.html#cb9-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">colNames =</span> T,</span>
<span id="cb9-4"><a href="upgma.html#cb9-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sheet =</span> <span class="st">&quot;Sheet1&quot;</span>)</span>
<span id="cb9-5"><a href="upgma.html#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(ppbio)</span>
<span id="cb9-6"><a href="upgma.html#cb9-6" aria-hidden="true" tabindex="-1"></a>ppbio_ma <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(ppbio) <span class="co">#lê ppbio como uma matriz</span></span>
<span id="cb9-7"><a href="upgma.html#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(ppbio_ma)</span>
<span id="cb9-8"><a href="upgma.html#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co">#ppbio</span></span>
<span id="cb9-9"><a href="upgma.html#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co">#ppbio_ma</span></span></code></pre></div>
</div>
</div>
<div id="reset-point-4" class="section level2 hasAnchor" number="16.2">
<h2><span class="header-section-number">16.2</span> Reset point<a href="upgma.html#reset-point-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="hello" class="greeting message" style="color: green;">
<p><span style="color:red">ATENÇÃO</span>
Aqui substitui-se uma nova matriz de dados, relativizada e/ou transformada, pela matriz de trabalho inicial.</p>
</div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="upgma.html#cb10-1" aria-hidden="true" tabindex="-1"></a>m_trab <span class="ot">&lt;-</span> (ppbio)   <span class="co"># &lt;1&gt;</span></span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Aqui usaremos as matrizes transposta/relativizada/transformada/particionada</li>
</ol>
<div id="outra-forma-de-achar-e-importar-uma-planilha-1" class="section level4 hasAnchor" number="16.2.0.1">
<h4><span class="header-section-number">16.2.0.1</span> Outra forma de achar e importar uma planilha<a href="upgma.html#outra-forma-de-achar-e-importar-uma-planilha-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="upgma.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span>
<span id="cb11-2"><a href="upgma.html#cb11-2" aria-hidden="true" tabindex="-1"></a>ppbio <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(<span class="fu">file.choose</span>(),</span>
<span id="cb11-3"><a href="upgma.html#cb11-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">rowNames =</span> T, <span class="at">colNames =</span> T,</span>
<span id="cb11-4"><a href="upgma.html#cb11-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sheet =</span> <span class="st">&quot;Sheet1&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="nomenclatura-das-matrizes-em-amd" class="section level2 hasAnchor" number="16.3">
<h2><span class="header-section-number">16.3</span> Nomenclatura das matrizes em AMD<a href="upgma.html#nomenclatura-das-matrizes-em-amd" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>No tocante aos tipos de atributos e seu tratamento pré-análises, uma matriz de de dados pode ser dos tipos apresentados na tabela abaixo (Tabela @ref(tab:tbl-m_)).</p>
<pre><code>## 
## Attaching package: &#39;kableExtra&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     group_rows</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
(#tab:tbl-m_)Nomenclatura das matrizes em AMD em relação aos atributos das colunas.
</caption>
<thead>
<tr>
<th style="text-align:left;">
Nome
</th>
<th style="text-align:center;">
Atributos (colunas)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;width: 2cm; ">
Matriz comunitaria
</td>
<td style="text-align:center;width: 2cm; ">
Os atributos são táxons (ex. espécies, gêneros, morfotipos)
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
Matriz ambiental
</td>
<td style="text-align:center;width: 2cm; ">
Os atributos são dados ambientais (ex. pH, condutividade, temperatura)
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
Matriz bruta
</td>
<td style="text-align:center;width: 2cm; ">
Os atributos ainda não receberam nenhum tipo de tratamento estatísco (valores brutos, como coletados)
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
Matriz transposta
</td>
<td style="text-align:center;width: 2cm; ">
Os atributos foram transpostos para as linhas
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
Matriz relativizada
</td>
<td style="text-align:center;width: 2cm; ">
Os atributos foram relativizados por um critério de tamanho ou de variação (ex. dividir os valores de cada coluna pela soma)
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
Matriz transformada
</td>
<td style="text-align:center;width: 2cm; ">
Foi aplicado um operador matemático a todos os atributos (ex. raiz quadrada, log)
</td>
</tr>
</tbody>
</table>
</div>
<div id="cluster-1-piloto-automático" class="section level2 hasAnchor" number="16.4">
<h2><span class="header-section-number">16.4</span> Cluster 1: Piloto automático<a href="upgma.html#cluster-1-piloto-automático" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="hello" class="greeting message" style="color: red;">
<p><span style="color:red">ATENÇÃO</span>
NÃO RECOMENDADO</p>
</div>
<p>Aqui fazemos uma Análise Cluster no piloto automático. Não decidimos nenhum dos parâmetros importântes para uma Classificação.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="upgma.html#cb14-1" aria-hidden="true" tabindex="-1"></a>cluster1 <span class="ot">&lt;-</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(m_trab))</span>
<span id="cb14-2"><a href="upgma.html#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cluster1, <span class="at">main =</span> <span class="st">&quot;Cluster Dendrogram - Piloto automatico&quot;</span>)</span>
<span id="cb14-3"><a href="upgma.html#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rect.hclust</span>(cluster1, <span class="at">k=</span><span class="dv">3</span>, <span class="at">h =</span> <span class="cn">NULL</span>)</span>
<span id="cb14-4"><a href="upgma.html#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co">#?dist</span></span>
<span id="cb14-5"><a href="upgma.html#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co">#?hclust</span></span></code></pre></div>
<p><img src="fundamentos_de_ecologia_numerica_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>É possivel definir uma caixa mostrado os principais grupos formados. Isso pode ser feito estabelecendo quantos grupos se quer mostrar, usando a função <code>k = no. de grupos</code>. Ou pode-se definir os grupos formados até uma determinanda distância, usando a função <code>h = altura dos grupos</code> no eixo das distâncias.</p>
<div id="histórico-das-fusões" class="section level3 hasAnchor" number="16.4.1">
<h3><span class="header-section-number">16.4.1</span> Histórico das fusões<a href="upgma.html#histórico-das-fusões" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="upgma.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb15-2"><a href="upgma.html#cb15-2" aria-hidden="true" tabindex="-1"></a>cluster1<span class="sc">$</span>merge <span class="co">#mostra o histórico das fusões</span></span>
<span id="cb15-3"><a href="upgma.html#cb15-3" aria-hidden="true" tabindex="-1"></a>idrow <span class="ot">&lt;-</span> <span class="fu">mutate</span>(m_trab, <span class="at">id =</span> <span class="fu">row_number</span>()) <span class="co">#cria um df com os numeros das linhas </span></span>
<span id="cb15-4"><a href="upgma.html#cb15-4" aria-hidden="true" tabindex="-1"></a>idrow <span class="sc">%&gt;%</span> <span class="fu">relocate</span>(id)</span>
<span id="cb15-5"><a href="upgma.html#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co">#?relocate</span></span></code></pre></div>
<pre><code>##       [,1] [,2]
##  [1,]   -2   -3
##  [2,]  -14    1
##  [3,]   -8    2
##  [4,]   -5  -11
##  [5,]    3    4
##  [6,]  -15  -18
##  [7,]  -21    5
##  [8,]  -17  -23
##  [9,]  -16    7
## [10,]   -9  -12
## [11,]    6    9
## [12,]  -10   11
## [13,]   -1   -4
## [14,]  -20    8
## [15,]   -6  -13
## [16,]   12   15
## [17,]   13   16
## [18,]  -19   10
## [19,]   14   17
## [20,]   -7   19
## [21,]   18   20
## [22,]  -22   21
##         id ap-davis as-bimac as-fasci ch-bimac ci-ocela ci-orien co-macro
## S-R-CT1  1        0      194       55        0        0        5        0
## S-R-CP1  2        0       19        0        0        0        0        0
## S-A-TA1  3        0       23        1       13        0        0        0
## S-R-CT2  4        0      142        3        3        0       69        0
## S-R-CP2  5        0        5        1        0       40        9        0
## S-A-TA2  6        0       46        0      178        0        0        0
## S-R-CT3  7        0      206       64        0        0       25        0
## S-R-CP3  8        0       16        0        0       13       24        0
## S-A-TA3  9        0      234        7      238        0        0        2
## S-R-CT4 10        0        0        1        0        0        5        0
## S-R-CP4 11        0        0        0        0       11        6        0
## S-A-TA4 12        0      394        0      273        0        0        0
## B-A-MU1 13        0       12        0        0        0        0        0
## B-A-GU1 14        0        2        2        0        0        0        0
## B-R-PC2 15        5       44        0        0        2        0        0
## B-A-MU2 16        0       99        0        0        0        0        0
## B-A-GU2 17        0        0        0        0        0        0        0
## B-R-PC3 18       22       75        7        0        4        0        0
## B-A-MU3 19        0      511        0        0        0        0        0
## B-A-GU3 20        0        6        0        0        0        0        0
## B-R-PC4 21        0        7       17        0        0        0        0
## B-A-MU4 22        0      235        0        0        0        0        0
## B-A-GU4 23        0       13        0        0        0        0        0
##         co-heter cr-menez cu-lepid cy-gilbe ge-brasi he-margi ho-malab hy-pusar
## S-R-CT1        1       14        0        0        3        0        1        9
## S-R-CP1        0        0        0        0        0        0        5        2
## S-A-TA1        0        0        0        0        0        0        0        0
## S-R-CT2        0        4        0        0        0        1       17       43
## S-R-CP2        0        0        0        0        0        0       10        2
## S-A-TA2        0        0        0        0        0        0        2        0
## S-R-CT3        0        8        0        0        1        0       31       11
## S-R-CP3        0        0        0        0        0        0        4        0
## S-A-TA3        0        0        0        0        0        0       20        0
## S-R-CT4        0        1        0       50        3        1        4        3
## S-R-CP4        0        0        0        0        0        0        2        0
## S-A-TA4        0        1        0        0        1        0        9        0
## B-A-MU1        0        0        0        0      190        0        0        0
## B-A-GU1        0        0        0        0        7        0        0        0
## B-R-PC2        0        0        0        0        8        0        0        0
## B-A-MU2        0        0        0        0       67        0        1        0
## B-A-GU2        0        0        0        0       23        0        0        0
## B-R-PC3        0        0       21        0       16        0        2        1
## B-A-MU3        0        0        0        0      145        0        0        0
## B-A-GU3        0        0        0        0       32        0        0        0
## B-R-PC4        0        0        0       81        5        0        1        0
## B-A-MU4        0        0        0        0      509        0        0        0
## B-A-GU4        0        0        0        0       10        0        0        0
##         le-melan le-piau le-taeni mo-costa mo-lepid or-nilot pa-manag pimel-sp
## S-R-CT1        0       3        0        0       39       36        0        6
## S-R-CP1        0       0        0        0        0        0        0        0
## S-A-TA1        0       0        0        0        0        0        0        0
## S-R-CT2        0       1        0        0        1       77        0        0
## S-R-CP2        0       3        0        0        0        0        0        0
## S-A-TA2        0       0        0        0        0        0        0        0
## S-R-CT3        0       2        0        0        0      138        0        0
## S-R-CP3        0       1        0        0        0        0        0        0
## S-A-TA3        0       0        0        0        0        0        0        0
## S-R-CT4        0       0        0        0        0       73        0        0
## S-R-CP4        0       2        0        0        0        0        0        0
## S-A-TA4        0       2        0        0        0        1        0        0
## B-A-MU1        0       0        0        0        0        6        0        0
## B-A-GU1        0       0        0        0        0        3       11        0
## B-R-PC2        2       0        1        0        0        5        0        0
## B-A-MU2        0       0        0        0        0        1        0        0
## B-A-GU2        0       0        0        0        0       36      102        0
## B-R-PC3        0       0        0        1        0       65        0        0
## B-A-MU3        0       0        0        0        0       11        0        0
## B-A-GU3        0       0        0        0        0      247      250        0
## B-R-PC4        0       1        0        0        0        9        0        0
## B-A-MU4        0       0        0        0        0        1        0        0
## B-A-GU4        0       0        0        0        0      129      190        0
##         po-retic po-vivip pr-brevi ps-rhomb ps-genise se-heter se-piaba
## S-R-CT1        0       47        5        0         0       40       68
## S-R-CP1        0       15        0        0         0       14        0
## S-A-TA1        0        0        1        0         0        4        0
## S-R-CT2       20      221       15        0         0       60        0
## S-R-CP2        0       32        5        0         0        0        0
## S-A-TA2        0        0        2        0         0        0        0
## S-R-CT3        5      326      164        1         1       38        0
## S-R-CP3        0       10        0        0         0        0        0
## S-A-TA3        0        0        0        0         0        0        0
## S-R-CT4        0       28       59        0         0        3        0
## S-R-CP4        0       80        0        0         0        3        0
## S-A-TA4        0        0        3        0         0        0        0
## B-A-MU1        0        0        0        0         0        0        0
## B-A-GU1        0        0        0        0         0        0        0
## B-R-PC2        0        0        9        0         0       10        0
## B-A-MU2       10        8        0        0         0        0        0
## B-A-GU2        0        0        0        0         0        0        0
## B-R-PC3        0        0        6        0         0       93        0
## B-A-MU3       46       48        1        0         0        0        0
## B-A-GU3        0        0        0        0         0        0        0
## B-R-PC4        0        0        0        0         0       31        0
## B-A-MU4      266      163        0        0         0        0        0
## B-A-GU4        0        0        0        0         0        0        0
##         se-spilo st-noton sy-marmo te-chalc tr-signa
## S-R-CT1        0        1        0        0       18
## S-R-CP1        0        0        0        0        0
## S-A-TA1        0        0        0        0        0
## S-R-CT2        0       25        0        0       15
## S-R-CP2        0        0        1        0        0
## S-A-TA2        0        0        0        0        0
## S-R-CT3        1      115        0        0        7
## S-R-CP3        0        0        0        0        0
## S-A-TA3        0        0        0        0        0
## S-R-CT4        0       64        0        0      141
## S-R-CP4        0        0        0        0        0
## S-A-TA4        0        0        0        0        0
## B-A-MU1        0        0        0        0        0
## B-A-GU1        0        0        0        0        0
## B-R-PC2        0        0        0       76       23
## B-A-MU2        0        0        0        0        0
## B-A-GU2        0        0        0        0        0
## B-R-PC3        0        0        0       58        0
## B-A-MU3        0        0        0        0        0
## B-A-GU3        0        0        0        0        0
## B-R-PC4        0        0        0        0        4
## B-A-MU4        0        0        0        0        0
## B-A-GU4        0        0        0        0        0</code></pre>
<div id="alguns-ajustes-para-melhorar-a-visualização" class="section level4 hasAnchor" number="16.4.1.1">
<h4><span class="header-section-number">16.4.1.1</span> Alguns ajustes para melhorar a visualização<a href="upgma.html#alguns-ajustes-para-melhorar-a-visualização" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="upgma.html#cb17-1" aria-hidden="true" tabindex="-1"></a>merge <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(cluster1<span class="sc">$</span>merge)</span>
<span id="cb17-2"><a href="upgma.html#cb17-2" aria-hidden="true" tabindex="-1"></a>merge[<span class="fu">nrow</span>(merge)<span class="sc">+</span><span class="dv">1</span>,] <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>,<span class="st">&quot;0&quot;</span>)</span>
<span id="cb17-3"><a href="upgma.html#cb17-3" aria-hidden="true" tabindex="-1"></a>merge</span>
<span id="cb17-4"><a href="upgma.html#cb17-4" aria-hidden="true" tabindex="-1"></a>uas <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">rownames_to_column</span>(m_trab,<span class="at">var =</span> <span class="st">&quot;UAs&quot;</span>))</span>
<span id="cb17-5"><a href="upgma.html#cb17-5" aria-hidden="true" tabindex="-1"></a>uas</span>
<span id="cb17-6"><a href="upgma.html#cb17-6" aria-hidden="true" tabindex="-1"></a>merges <span class="ot">&lt;-</span> <span class="fu">cbind</span>(uas[<span class="fu">c</span>(<span class="st">&quot;UAs&quot;</span>)], merge)</span>
<span id="cb17-7"><a href="upgma.html#cb17-7" aria-hidden="true" tabindex="-1"></a>merges</span></code></pre></div>
<pre><code>##     V1  V2
## 1   -2  -3
## 2  -14   1
## 3   -8   2
## 4   -5 -11
## 5    3   4
## 6  -15 -18
## 7  -21   5
## 8  -17 -23
## 9  -16   7
## 10  -9 -12
## 11   6   9
## 12 -10  11
## 13  -1  -4
## 14 -20   8
## 15  -6 -13
## 16  12  15
## 17  13  16
## 18 -19  10
## 19  14  17
## 20  -7  19
## 21  18  20
## 22 -22  21
## 23   0   0
##        UAs ap-davis as-bimac as-fasci ch-bimac ci-ocela ci-orien co-macro
## 1  S-R-CT1        0      194       55        0        0        5        0
## 2  S-R-CP1        0       19        0        0        0        0        0
## 3  S-A-TA1        0       23        1       13        0        0        0
## 4  S-R-CT2        0      142        3        3        0       69        0
## 5  S-R-CP2        0        5        1        0       40        9        0
## 6  S-A-TA2        0       46        0      178        0        0        0
## 7  S-R-CT3        0      206       64        0        0       25        0
## 8  S-R-CP3        0       16        0        0       13       24        0
## 9  S-A-TA3        0      234        7      238        0        0        2
## 10 S-R-CT4        0        0        1        0        0        5        0
## 11 S-R-CP4        0        0        0        0       11        6        0
## 12 S-A-TA4        0      394        0      273        0        0        0
## 13 B-A-MU1        0       12        0        0        0        0        0
## 14 B-A-GU1        0        2        2        0        0        0        0
## 15 B-R-PC2        5       44        0        0        2        0        0
## 16 B-A-MU2        0       99        0        0        0        0        0
## 17 B-A-GU2        0        0        0        0        0        0        0
## 18 B-R-PC3       22       75        7        0        4        0        0
## 19 B-A-MU3        0      511        0        0        0        0        0
## 20 B-A-GU3        0        6        0        0        0        0        0
## 21 B-R-PC4        0        7       17        0        0        0        0
## 22 B-A-MU4        0      235        0        0        0        0        0
## 23 B-A-GU4        0       13        0        0        0        0        0
##    co-heter cr-menez cu-lepid cy-gilbe ge-brasi he-margi ho-malab hy-pusar
## 1         1       14        0        0        3        0        1        9
## 2         0        0        0        0        0        0        5        2
## 3         0        0        0        0        0        0        0        0
## 4         0        4        0        0        0        1       17       43
## 5         0        0        0        0        0        0       10        2
## 6         0        0        0        0        0        0        2        0
## 7         0        8        0        0        1        0       31       11
## 8         0        0        0        0        0        0        4        0
## 9         0        0        0        0        0        0       20        0
## 10        0        1        0       50        3        1        4        3
## 11        0        0        0        0        0        0        2        0
## 12        0        1        0        0        1        0        9        0
## 13        0        0        0        0      190        0        0        0
## 14        0        0        0        0        7        0        0        0
## 15        0        0        0        0        8        0        0        0
## 16        0        0        0        0       67        0        1        0
## 17        0        0        0        0       23        0        0        0
## 18        0        0       21        0       16        0        2        1
## 19        0        0        0        0      145        0        0        0
## 20        0        0        0        0       32        0        0        0
## 21        0        0        0       81        5        0        1        0
## 22        0        0        0        0      509        0        0        0
## 23        0        0        0        0       10        0        0        0
##    le-melan le-piau le-taeni mo-costa mo-lepid or-nilot pa-manag pimel-sp
## 1         0       3        0        0       39       36        0        6
## 2         0       0        0        0        0        0        0        0
## 3         0       0        0        0        0        0        0        0
## 4         0       1        0        0        1       77        0        0
## 5         0       3        0        0        0        0        0        0
## 6         0       0        0        0        0        0        0        0
## 7         0       2        0        0        0      138        0        0
## 8         0       1        0        0        0        0        0        0
## 9         0       0        0        0        0        0        0        0
## 10        0       0        0        0        0       73        0        0
## 11        0       2        0        0        0        0        0        0
## 12        0       2        0        0        0        1        0        0
## 13        0       0        0        0        0        6        0        0
## 14        0       0        0        0        0        3       11        0
## 15        2       0        1        0        0        5        0        0
## 16        0       0        0        0        0        1        0        0
## 17        0       0        0        0        0       36      102        0
## 18        0       0        0        1        0       65        0        0
## 19        0       0        0        0        0       11        0        0
## 20        0       0        0        0        0      247      250        0
## 21        0       1        0        0        0        9        0        0
## 22        0       0        0        0        0        1        0        0
## 23        0       0        0        0        0      129      190        0
##    po-retic po-vivip pr-brevi ps-rhomb ps-genise se-heter se-piaba se-spilo
## 1         0       47        5        0         0       40       68        0
## 2         0       15        0        0         0       14        0        0
## 3         0        0        1        0         0        4        0        0
## 4        20      221       15        0         0       60        0        0
## 5         0       32        5        0         0        0        0        0
## 6         0        0        2        0         0        0        0        0
## 7         5      326      164        1         1       38        0        1
## 8         0       10        0        0         0        0        0        0
## 9         0        0        0        0         0        0        0        0
## 10        0       28       59        0         0        3        0        0
## 11        0       80        0        0         0        3        0        0
## 12        0        0        3        0         0        0        0        0
## 13        0        0        0        0         0        0        0        0
## 14        0        0        0        0         0        0        0        0
## 15        0        0        9        0         0       10        0        0
## 16       10        8        0        0         0        0        0        0
## 17        0        0        0        0         0        0        0        0
## 18        0        0        6        0         0       93        0        0
## 19       46       48        1        0         0        0        0        0
## 20        0        0        0        0         0        0        0        0
## 21        0        0        0        0         0       31        0        0
## 22      266      163        0        0         0        0        0        0
## 23        0        0        0        0         0        0        0        0
##    st-noton sy-marmo te-chalc tr-signa
## 1         1        0        0       18
## 2         0        0        0        0
## 3         0        0        0        0
## 4        25        0        0       15
## 5         0        1        0        0
## 6         0        0        0        0
## 7       115        0        0        7
## 8         0        0        0        0
## 9         0        0        0        0
## 10       64        0        0      141
## 11        0        0        0        0
## 12        0        0        0        0
## 13        0        0        0        0
## 14        0        0        0        0
## 15        0        0       76       23
## 16        0        0        0        0
## 17        0        0        0        0
## 18        0        0       58        0
## 19        0        0        0        0
## 20        0        0        0        0
## 21        0        0        0        4
## 22        0        0        0        0
## 23        0        0        0        0
##        UAs  V1  V2
## 1  S-R-CT1  -2  -3
## 2  S-R-CP1 -14   1
## 3  S-A-TA1  -8   2
## 4  S-R-CT2  -5 -11
## 5  S-R-CP2   3   4
## 6  S-A-TA2 -15 -18
## 7  S-R-CT3 -21   5
## 8  S-R-CP3 -17 -23
## 9  S-A-TA3 -16   7
## 10 S-R-CT4  -9 -12
## 11 S-R-CP4   6   9
## 12 S-A-TA4 -10  11
## 13 B-A-MU1  -1  -4
## 14 B-A-GU1 -20   8
## 15 B-R-PC2  -6 -13
## 16 B-A-MU2  12  15
## 17 B-A-GU2  13  16
## 18 B-R-PC3 -19  10
## 19 B-A-MU3  14  17
## 20 B-A-GU3  -7  19
## 21 B-R-PC4  18  20
## 22 B-A-MU4 -22  21
## 23 B-A-GU4   0   0</code></pre>
</div>
</div>
</div>
<div id="cluster-2-criando-a-matriz-de-distâncias-euclidiana" class="section level2 hasAnchor" number="16.5">
<h2><span class="header-section-number">16.5</span> Cluster 2: Criando a matriz de distâncias Euclidiana<a href="upgma.html#cluster-2-criando-a-matriz-de-distâncias-euclidiana" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="upgma.html#cb19-1" aria-hidden="true" tabindex="-1"></a>m_dists <span class="ot">&lt;-</span> <span class="fu">dist</span>(m_trab, <span class="at">method =</span> <span class="st">&quot;euclidean&quot;</span>,</span>
<span id="cb19-2"><a href="upgma.html#cb19-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">diag =</span> <span class="cn">TRUE</span>,</span>
<span id="cb19-3"><a href="upgma.html#cb19-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">upper =</span> <span class="cn">FALSE</span>)</span>
<span id="cb19-4"><a href="upgma.html#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co">#m_dists</span></span>
<span id="cb19-5"><a href="upgma.html#cb19-5" aria-hidden="true" tabindex="-1"></a>cluster2 <span class="ot">&lt;-</span> <span class="fu">hclust</span>(m_dists, <span class="at">method =</span> <span class="st">&quot;complete&quot;</span>) <span class="co">#método de fusão</span></span>
<span id="cb19-6"><a href="upgma.html#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span> (cluster2, <span class="at">main =</span> <span class="st">&quot;Cluster Dendrogram - Dist.Euclidiana&quot;</span>)</span>
<span id="cb19-7"><a href="upgma.html#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rect.hclust</span>(cluster2, <span class="at">k =</span> <span class="dv">3</span>)</span>
<span id="cb19-8"><a href="upgma.html#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co">#?dist</span></span>
<span id="cb19-9"><a href="upgma.html#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co">#?hclust</span></span></code></pre></div>
<p><img src="fundamentos_de_ecologia_numerica_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>O significado do argumento <code>method =</code> da função <code>dist()</code> usada no códico acima, depende do contexto em que ela é usada.</p>
<ul>
<li><p>A função <code>dist()</code> no R é usada para calcular as distâncias entre as observações em um conjunto de dados. Essa função tem vários métodos de cálculo de distância, que podem ser especificados pelo argumento <code>method =</code>, a exemplo de “euclidean”, “manhattan”, “canberra”, entre outras.</p></li>
<li><p>Quando o argumento <code>method =</code> é usado em conjunto com a função <code>hclust()</code>, como no código acima, para realizar uma análise de classificação (ou cluster) hierárquica, então ela passa a representar um método de fusão, a exemplo de UPGMA, “nearest neighbour”, “furtherst neighbour”, entre outros.</p></li>
</ul>
<p>A tabela <a href="upgma.html#tab:27fus">16.1</a> resume os métodos de fusão disponiveis na função <code>hclust()</code>.</p>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:27fus">Tabela 16.1: </span>Metodos de fusão disponiveis com o argumento <code>method=</code> da função <code>hclust</code>. Lembrando que UPGMA significa “Unweighted Pairwise Group Method with Arithmetic Mean”
</caption>
<thead>
<tr>
<th style="text-align:left;">
Method=
</th>
<th style="text-align:center;">
Método de fusão
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;width: 2cm; ">
ward.D
</td>
<td style="text-align:center;width: 2cm; ">
Método de Ward com variância mínima
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
ward.D2
</td>
<td style="text-align:center;width: 2cm; ">
Método de Ward com variância mínima ajustada
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
single
</td>
<td style="text-align:center;width: 2cm; ">
Método de ligação simples (vizinho mais próximo)
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
complete
</td>
<td style="text-align:center;width: 2cm; ">
Método de ligação completa (vizinho mais distante)
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
average
</td>
<td style="text-align:center;width: 2cm; ">
Método de ligação baseado na média, equivale ao UPGMA
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
mcquitty
</td>
<td style="text-align:center;width: 2cm; ">
Método de ligação de McQuitty, equivale ao WPGMA
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
median
</td>
<td style="text-align:center;width: 2cm; ">
Método de ligação baseado na mediana, ou WPGMC
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
centroid
</td>
<td style="text-align:center;width: 2cm; ">
Método de ligação baseado no centróide, ou UPGMC
</td>
</tr>
</tbody>
</table>
<div id="comparação-dos-resultados-obtidos-até-aqui" class="section level3 hasAnchor" number="16.5.1">
<h3><span class="header-section-number">16.5.1</span> Comparação dos resultados obtidos até aqui<a href="upgma.html#comparação-dos-resultados-obtidos-até-aqui" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="upgma.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.off() #limpa os gráficos</span></span>
<span id="cb20-2"><a href="upgma.html#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb20-3"><a href="upgma.html#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cluster1, <span class="at">main =</span> <span class="st">&quot;Cluster Dendrogram - Piloto automático&quot;</span>)</span>
<span id="cb20-4"><a href="upgma.html#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cluster2, <span class="at">main =</span> <span class="st">&quot;Cluster Dendrogram - Dist. Euclidiana&quot;</span>)</span></code></pre></div>
<p><img src="fundamentos_de_ecologia_numerica_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="upgma.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb21-2"><a href="upgma.html#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.off()</span></span></code></pre></div>
</div>
</div>
<div id="cluster-3-relativização-pelo-total-da-coluna" class="section level2 hasAnchor" number="16.6">
<h2><span class="header-section-number">16.6</span> Cluster 3: Relativização pelo total da coluna<a href="upgma.html#cluster-3-relativização-pelo-total-da-coluna" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="upgma.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)</span></code></pre></div>
<pre><code>## Carregando pacotes exigidos: permute</code></pre>
<pre><code>## Carregando pacotes exigidos: lattice</code></pre>
<pre><code>## This is vegan 2.6-4</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="upgma.html#cb26-1" aria-hidden="true" tabindex="-1"></a>m_relcol <span class="ot">&lt;-</span> <span class="fu">decostand</span>(m_trab,</span>
<span id="cb26-2"><a href="upgma.html#cb26-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">method=</span><span class="st">&quot;total&quot;</span>, <span class="do">### OUTROS METODOS: total, max, normalize, range, rankm</span></span>
<span id="cb26-3"><a href="upgma.html#cb26-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">MARGIN =</span> <span class="dv">2</span>) <span class="co">#1-linha, 2-coluna</span></span>
<span id="cb26-4"><a href="upgma.html#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co">#View(m_relcol)</span></span>
<span id="cb26-5"><a href="upgma.html#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co">#m_relcol</span></span></code></pre></div>
<div id="gráfico-de-clustering-relativizado" class="section level3 hasAnchor" number="16.6.1">
<h3><span class="header-section-number">16.6.1</span> Gráfico de clustering relativizado<a href="upgma.html#gráfico-de-clustering-relativizado" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Agora fazemos a classificação da matriz bruta após ter sido relativizada pelo total das colunas.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="upgma.html#cb27-1" aria-hidden="true" tabindex="-1"></a>cluster3 <span class="ot">&lt;-</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(m_relcol))</span>
<span id="cb27-2"><a href="upgma.html#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cluster3, <span class="at">main =</span> <span class="st">&quot;Cluster Dendrogram - Rel.Coluna&quot;</span>)</span>
<span id="cb27-3"><a href="upgma.html#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rect.hclust</span>(cluster3, <span class="at">k =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="fundamentos_de_ecologia_numerica_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="cluster-4-transformação-pelo-arcoseno-da-raiz-quadrada" class="section level2 hasAnchor" number="16.7">
<h2><span class="header-section-number">16.7</span> Cluster 4: Transformação pelo arcoseno da raiz quadrada<a href="upgma.html#cluster-4-transformação-pelo-arcoseno-da-raiz-quadrada" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Agora aplicaremos a transformação do arcoseno da raiz quadrada na matriz relativizada por colunas. Lembre que em ambas as matrizes entramos dados que variam entre 0 e 1, e os resutados retornados também variam entre 0 e 1, mas em um nível de compressão de valores extremos mais desejável. Usaremos a matriz relativizada/transformada para fazermos a proxima classificação.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="upgma.html#cb28-1" aria-hidden="true" tabindex="-1"></a>m_trns <span class="ot">&lt;-</span> <span class="fu">asin</span>(<span class="fu">sqrt</span>(m_relcol)) <span class="co">#valores de entrada tem que ser entre 0-1</span></span>
<span id="cb28-2"><a href="upgma.html#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co">#View(m_trns)</span></span>
<span id="cb28-3"><a href="upgma.html#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co">#m_trns</span></span></code></pre></div>
<div id="gráfico-de-clustering-relativizadotransformado" class="section level3 hasAnchor" number="16.7.1">
<h3><span class="header-section-number">16.7.1</span> Gráfico de clustering relativizado/transformado<a href="upgma.html#gráfico-de-clustering-relativizadotransformado" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Aqui fazemos uma Análise Cluster no piloto automático, para comparar com os resultados da primeira classificação, que não havia sido relativizada/transformada.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="upgma.html#cb29-1" aria-hidden="true" tabindex="-1"></a>cluster4 <span class="ot">&lt;-</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(m_trns))</span>
<span id="cb29-2"><a href="upgma.html#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cluster4,  <span class="at">main =</span> <span class="st">&quot;Cluster Dendrogram - ArcSin.SQRT&quot;</span>)</span>
<span id="cb29-3"><a href="upgma.html#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rect.hclust</span>(cluster4, <span class="at">k =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="fundamentos_de_ecologia_numerica_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
</div>
</div>
<div id="cluster-5-controle-total-dos-parâmetros" class="section level2 hasAnchor" number="16.8">
<h2><span class="header-section-number">16.8</span> Cluster 5: Controle total dos parâmetros<a href="upgma.html#cluster-5-controle-total-dos-parâmetros" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="upgma.html#cb30-1" aria-hidden="true" tabindex="-1"></a>vegdist <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(m_trns, <span class="at">method =</span> <span class="st">&quot;bray&quot;</span>,</span>
<span id="cb30-2"><a href="upgma.html#cb30-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">diag =</span> <span class="cn">TRUE</span>,</span>
<span id="cb30-3"><a href="upgma.html#cb30-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">upper =</span> <span class="cn">FALSE</span>)</span>
<span id="cb30-4"><a href="upgma.html#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">as.matrix</span>(vegdist)[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb30-5"><a href="upgma.html#cb30-5" aria-hidden="true" tabindex="-1"></a>cluster5 <span class="ot">&lt;-</span> <span class="fu">hclust</span>(vegdist, <span class="at">method =</span> <span class="st">&quot;average&quot;</span>)</span>
<span id="cb30-6"><a href="upgma.html#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cluster5, <span class="at">main =</span> <span class="st">&quot;Cluster Dendrogram - Bray-Curtis&quot;</span>)</span>
<span id="cb30-7"><a href="upgma.html#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rect.hclust</span>(cluster5, <span class="at">k =</span> <span class="dv">3</span>, <span class="at">h =</span> <span class="cn">NULL</span>) </span></code></pre></div>
<p><img src="fundamentos_de_ecologia_numerica_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="upgma.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#h = 0.8 fornece os grupos formados na altura h</span></span>
<span id="cb31-2"><a href="upgma.html#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co">#vegdist</span></span>
<span id="cb31-3"><a href="upgma.html#cb31-3" aria-hidden="true" tabindex="-1"></a>cluster5<span class="sc">$</span>merge</span>
<span id="cb31-4"><a href="upgma.html#cb31-4" aria-hidden="true" tabindex="-1"></a>cluster5<span class="sc">$</span>height</span>
<span id="cb31-5"><a href="upgma.html#cb31-5" aria-hidden="true" tabindex="-1"></a>idrow <span class="ot">&lt;-</span> <span class="fu">mutate</span>(m_trns, <span class="at">id =</span> <span class="fu">row_number</span>()) </span>
<span id="cb31-6"><a href="upgma.html#cb31-6" aria-hidden="true" tabindex="-1"></a>idrow <span class="sc">%&gt;%</span> <span class="fu">relocate</span>(id)</span></code></pre></div>
<pre><code>##           S-R-CT1   S-R-CP1   S-A-TA1   S-R-CT2   S-R-CP2   S-A-TA2   S-R-CT3
## S-R-CT1 0.0000000 0.8743721 0.9338269 0.6274997 0.8106894 0.9420728 0.6582219
## S-R-CP1 0.8743721 0.0000000 0.6833816 0.7759468 0.7726098 0.7342613 0.8672111
## S-A-TA1 0.9338269 0.6833816 0.0000000 0.8789631 0.9178304 0.5700984 0.9404687
## S-R-CT2 0.6274997 0.7759468 0.8789631 0.0000000 0.7280378 0.8836068 0.5169933
## S-R-CP2 0.8106894 0.7726098 0.9178304 0.7280378 0.0000000 0.8915271 0.8012846
## S-A-TA2 0.9420728 0.7342613 0.5700984 0.8836068 0.8915271 0.0000000 0.9412636
## S-R-CT3 0.6582219 0.8672111 0.9404687 0.5169933 0.8012846 0.9412636 0.0000000
##       [,1] [,2]
##  [1,]  -20  -23
##  [2,]   -8  -11
##  [3,]  -17    1
##  [4,]  -19  -22
##  [5,]   -6  -12
##  [6,]   -4  -10
##  [7,]  -16    4
##  [8,]   -5    2
##  [9,]  -13    7
## [10,]   -9    5
## [11,]   -7    6
## [12,]  -14    3
## [13,]   -2   -3
## [14,]   -1   11
## [15,]  -15  -18
## [16,]  -21   14
## [17,]   10   13
## [18,]    9   12
## [19,]    8   16
## [20,]   17   19
## [21,]   15   20
## [22,]   18   21
##  [1] 0.1402400 0.2637008 0.2827470 0.3726150 0.4095558 0.4631145 0.4766705
##  [8] 0.5326053 0.5584043 0.5683644 0.5934519 0.6112108 0.6833816 0.6834576
## [15] 0.6881517 0.7475412 0.7570089 0.7899914 0.8037471 0.8465927 0.8855551
## [22] 0.9099458
##         id ap-davis   as-bimac   as-fasci   ch-bimac  ci-ocela  ci-orien
## S-R-CT1  1 0.000000 0.29580113 0.63106017 0.00000000 0.0000000 0.1880966
## S-R-CP1  2 0.000000 0.09135411 0.00000000 0.00000000 0.0000000 0.0000000
## S-A-TA1  3 0.000000 0.10054093 0.07963989 0.13621375 0.0000000 0.0000000
## S-R-CT2  4 0.000000 0.25205752 0.13823439 0.06527916 0.0000000 0.7679121
## S-R-CP2  5 0.000000 0.04681561 0.07963989 0.00000000 0.8570719 0.2535816
## S-A-TA2  6 0.000000 0.14242797 0.00000000 0.52646034 0.0000000 0.0000000
## S-R-CT3  7 0.000000 0.30509802 0.68988155 0.00000000 0.0000000 0.4313758
## S-R-CP3  8 0.000000 0.08381382 0.00000000 0.00000000 0.4455406 0.4220958
## S-A-TA3  9 0.000000 0.32588896 0.21207071 0.61998604 0.0000000 0.0000000
## S-R-CT4 10 0.000000 0.00000000 0.07963989 0.00000000 0.0000000 0.1880966
## S-R-CP4 11 0.000000 0.00000000 0.00000000 0.00000000 0.4076059 0.2062968
## S-A-TA4 12 0.000000 0.42841263 0.00000000 0.67165367 0.0000000 0.0000000
## B-A-MU1 13 0.000000 0.07256361 0.00000000 0.00000000 0.0000000 0.0000000
## B-A-GU1 14 0.000000 0.02960230 0.11274751 0.00000000 0.0000000 0.0000000
## B-R-PC2 15 0.444860 0.13927667 0.00000000 0.00000000 0.1698463 0.0000000
## B-A-MU2 16 0.000000 0.20977540 0.00000000 0.00000000 0.0000000 0.0000000
## B-A-GU2 17 0.000000 0.00000000 0.00000000 0.00000000 0.0000000 0.0000000
## B-R-PC3 18 1.125936 0.18225721 0.21207071 0.00000000 0.2413830 0.0000000
## B-A-MU3 19 0.000000 0.49281178 0.00000000 0.00000000 0.0000000 0.0000000
## B-A-GU3 20 0.000000 0.05128768 0.00000000 0.00000000 0.0000000 0.0000000
## B-R-PC4 21 0.000000 0.05540108 0.33420332 0.00000000 0.0000000 0.0000000
## B-A-MU4 22 0.000000 0.32661037 0.00000000 0.00000000 0.0000000 0.0000000
## B-A-GU4 23 0.000000 0.07553213 0.00000000 0.00000000 0.0000000 0.0000000
##         co-macro co-heter  cr-menez cu-lepid  cy-gilbe   ge-brasi  he-margi
## S-R-CT1 0.000000 1.570796 0.7853982 0.000000 0.0000000 0.05425923 0.0000000
## S-R-CP1 0.000000 0.000000 0.0000000 0.000000 0.0000000 0.00000000 0.0000000
## S-A-TA1 0.000000 0.000000 0.0000000 0.000000 0.0000000 0.00000000 0.0000000
## S-R-CT2 0.000000 0.000000 0.3875967 0.000000 0.0000000 0.00000000 0.7853982
## S-R-CP2 0.000000 0.000000 0.0000000 0.000000 0.0000000 0.00000000 0.0000000
## S-A-TA2 0.000000 0.000000 0.0000000 0.000000 0.0000000 0.00000000 0.0000000
## S-R-CT3 0.000000 0.000000 0.5639426 0.000000 0.0000000 0.03131633 0.0000000
## S-R-CP3 0.000000 0.000000 0.0000000 0.000000 0.0000000 0.00000000 0.0000000
## S-A-TA3 1.570796 0.000000 0.0000000 0.000000 0.0000000 0.00000000 0.0000000
## S-R-CT4 0.000000 0.000000 0.1901256 0.000000 0.6659445 0.05425923 0.7853982
## S-R-CP4 0.000000 0.000000 0.0000000 0.000000 0.0000000 0.00000000 0.0000000
## S-A-TA4 0.000000 0.000000 0.1901256 0.000000 0.0000000 0.03131633 0.0000000
## B-A-MU1 0.000000 0.000000 0.0000000 0.000000 0.0000000 0.44626053 0.0000000
## B-A-GU1 0.000000 0.000000 0.0000000 0.000000 0.0000000 0.08293673 0.0000000
## B-R-PC2 0.000000 0.000000 0.0000000 0.000000 0.0000000 0.08867767 0.0000000
## B-A-MU2 0.000000 0.000000 0.0000000 0.000000 0.0000000 0.25918549 0.0000000
## B-A-GU2 0.000000 0.000000 0.0000000 0.000000 0.0000000 0.15073345 0.0000000
## B-R-PC3 0.000000 0.000000 0.0000000 1.570796 0.0000000 0.12557463 0.0000000
## B-A-MU3 0.000000 0.000000 0.0000000 0.000000 0.0000000 0.38659505 0.0000000
## B-A-GU3 0.000000 0.000000 0.0000000 0.000000 0.0000000 0.17806243 0.0000000
## B-R-PC4 0.000000 0.000000 0.0000000 0.000000 0.9048519 0.07007133 0.0000000
## B-A-MU4 0.000000 0.000000 0.0000000 0.000000 0.0000000 0.78441777 0.0000000
## B-A-GU4 0.000000 0.000000 0.0000000 0.000000 0.0000000 0.09917726 0.0000000
##           ho-malab  hy-pusar le-melan   le-piau le-taeni mo-costa  mo-lepid
## S-R-CT1 0.09592969 0.3640209 0.000000 0.4636476 0.000000 0.000000 1.4120161
## S-R-CP1 0.21584866 0.1686344 0.000000 0.0000000 0.000000 0.000000 0.0000000
## S-A-TA1 0.00000000 0.0000000 0.000000 0.0000000 0.000000 0.000000 0.0000000
## S-R-CT2 0.40598283 0.8918340 0.000000 0.2611574 0.000000 0.000000 0.1587802
## S-R-CP2 0.30772498 0.1686344 0.000000 0.4636476 0.000000 0.000000 0.0000000
## S-A-TA2 0.13587479 0.0000000 0.000000 0.0000000 0.000000 0.000000 0.0000000
## S-R-CT3 0.56249105 0.4045563 0.000000 0.3737922 0.000000 0.000000 0.0000000
## S-R-CP3 0.19275669 0.0000000 0.000000 0.2611574 0.000000 0.000000 0.0000000
## S-A-TA3 0.44266923 0.0000000 0.000000 0.0000000 0.000000 0.000000 0.0000000
## S-R-CT4 0.19275669 0.2070324 0.000000 0.0000000 0.000000 0.000000 0.0000000
## S-R-CP4 0.13587479 0.0000000 0.000000 0.3737922 0.000000 0.000000 0.0000000
## S-A-TA4 0.29145679 0.0000000 0.000000 0.3737922 0.000000 0.000000 0.0000000
## B-A-MU1 0.00000000 0.0000000 0.000000 0.0000000 0.000000 0.000000 0.0000000
## B-A-GU1 0.00000000 0.0000000 0.000000 0.0000000 0.000000 0.000000 0.0000000
## B-R-PC2 0.00000000 0.0000000 1.570796 0.0000000 1.570796 0.000000 0.0000000
## B-A-MU2 0.09592969 0.0000000 0.000000 0.0000000 0.000000 0.000000 0.0000000
## B-A-GU2 0.00000000 0.0000000 0.000000 0.0000000 0.000000 0.000000 0.0000000
## B-R-PC3 0.13587479 0.1189585 0.000000 0.0000000 0.000000 1.570796 0.0000000
## B-A-MU3 0.00000000 0.0000000 0.000000 0.0000000 0.000000 0.000000 0.0000000
## B-A-GU3 0.00000000 0.0000000 0.000000 0.0000000 0.000000 0.000000 0.0000000
## B-R-PC4 0.09592969 0.0000000 0.000000 0.2611574 0.000000 0.000000 0.0000000
## B-A-MU4 0.00000000 0.0000000 0.000000 0.0000000 0.000000 0.000000 0.0000000
## B-A-GU4 0.00000000 0.0000000 0.000000 0.0000000 0.000000 0.000000 0.0000000
##           or-nilot  pa-manag pimel-sp  po-retic   po-vivip   pr-brevi ps-rhomb
## S-R-CT1 0.20878001 0.0000000 1.570796 0.0000000 0.22101460 0.13650631 0.000000
## S-R-CP1 0.00000000 0.0000000 0.000000 0.0000000 0.12416313 0.00000000 0.000000
## S-A-TA1 0.00000000 0.0000000 0.000000 0.0000000 0.00000000 0.06089569 0.000000
## S-R-CT2 0.30797141 0.0000000 0.000000 0.2424450 0.49537824 0.23794112 0.000000
## S-R-CP2 0.00000000 0.0000000 0.000000 0.0000000 0.18188749 0.13650631 0.000000
## S-A-TA2 0.00000000 0.0000000 0.000000 0.0000000 0.00000000 0.08617291 0.000000
## S-R-CT3 0.41785958 0.0000000 0.000000 0.1203286 0.61547971 0.89364927 1.570796
## S-R-CP3 0.00000000 0.0000000 0.000000 0.0000000 0.10129161 0.00000000 0.000000
## S-A-TA3 0.00000000 0.0000000 0.000000 0.0000000 0.00000000 0.00000000 0.000000
## S-R-CT4 0.29961011 0.0000000 0.000000 0.0000000 0.17002156 0.48641493 0.000000
## S-R-CP4 0.00000000 0.0000000 0.000000 0.0000000 0.29005641 0.00000000 0.000000
## S-A-TA4 0.03455130 0.0000000 0.000000 0.0000000 0.00000000 0.10560544 0.000000
## B-A-MU1 0.08471752 0.0000000 0.000000 0.0000000 0.00000000 0.00000000 0.000000
## B-A-GU1 0.05986846 0.1415090 0.000000 0.0000000 0.00000000 0.00000000 0.000000
## B-R-PC2 0.07732071 0.0000000 0.000000 0.0000000 0.00000000 0.18360401 0.000000
## B-A-MU2 0.03455130 0.0000000 0.000000 0.1705861 0.09056689 0.00000000 0.000000
## B-A-GU2 0.20878001 0.4439109 0.000000 0.0000000 0.00000000 0.00000000 0.000000
## B-R-PC3 0.28223829 0.0000000 0.000000 0.0000000 0.00000000 0.14962891 0.000000
## B-A-MU3 0.11482305 0.0000000 0.000000 0.3726604 0.22339293 0.06089569 0.000000
## B-A-GU3 0.57389635 0.7374041 0.000000 0.0000000 0.00000000 0.00000000 0.000000
## B-R-PC4 0.10381968 0.0000000 0.000000 0.0000000 0.00000000 0.00000000 0.000000
## B-A-MU4 0.03455130 0.0000000 0.000000 1.0665527 0.42053434 0.00000000 0.000000
## B-A-GU4 0.40318427 0.6263078 0.000000 0.0000000 0.00000000 0.00000000 0.000000
##         ps-genise  se-heter se-piaba se-spilo   st-noton sy-marmo  te-chalc
## S-R-CT1  0.000000 0.3764349 1.570796 0.000000 0.06989994 0.000000 0.0000000
## S-R-CP1  0.000000 0.2192313 0.000000 0.000000 0.00000000 0.000000 0.0000000
## S-A-TA1  0.000000 0.1165111 0.000000 0.000000 0.00000000 0.000000 0.0000000
## S-R-CT2  0.000000 0.4670175 0.000000 0.000000 0.35673339 0.000000 0.0000000
## S-R-CP2  0.000000 0.0000000 0.000000 0.000000 0.00000000 1.570796 0.0000000
## S-A-TA2  0.000000 0.0000000 0.000000 0.000000 0.00000000 0.000000 0.0000000
## S-R-CT3  1.570796 0.3664456 0.000000 1.570796 0.84652593 0.000000 0.0000000
## S-R-CP3  0.000000 0.0000000 0.000000 0.000000 0.00000000 0.000000 0.0000000
## S-A-TA3  0.000000 0.0000000 0.000000 0.000000 0.00000000 0.000000 0.0000000
## S-R-CT4  0.000000 0.1008442 0.000000 0.000000 0.59287085 0.000000 0.0000000
## S-R-CP4  0.000000 0.1008442 0.000000 0.000000 0.00000000 0.000000 0.0000000
## S-A-TA4  0.000000 0.0000000 0.000000 0.000000 0.00000000 0.000000 0.0000000
## B-A-MU1  0.000000 0.0000000 0.000000 0.000000 0.00000000 0.000000 0.0000000
## B-A-GU1  0.000000 0.0000000 0.000000 0.000000 0.00000000 0.000000 0.0000000
## B-R-PC2  0.000000 0.1848546 0.000000 0.000000 0.00000000 0.000000 0.8527660
## B-A-MU2  0.000000 0.0000000 0.000000 0.000000 0.00000000 0.000000 0.0000000
## B-A-GU2  0.000000 0.0000000 0.000000 0.000000 0.00000000 0.000000 0.0000000
## B-R-PC3  0.000000 0.5950206 0.000000 0.000000 0.00000000 0.000000 0.7180303
## B-A-MU3  0.000000 0.0000000 0.000000 0.000000 0.00000000 0.000000 0.0000000
## B-A-GU3  0.000000 0.0000000 0.000000 0.000000 0.00000000 0.000000 0.0000000
## B-R-PC4  0.000000 0.3295526 0.000000 0.000000 0.00000000 0.000000 0.0000000
## B-A-MU4  0.000000 0.0000000 0.000000 0.000000 0.00000000 0.000000 0.0000000
## B-A-GU4  0.000000 0.0000000 0.000000 0.000000 0.00000000 0.000000 0.0000000
##          tr-signa
## S-R-CT1 0.2985914
## S-R-CP1 0.0000000
## S-A-TA1 0.0000000
## S-R-CT2 0.2718802
## S-R-CP2 0.0000000
## S-A-TA2 0.0000000
## S-R-CT3 0.1844947
## S-R-CP3 0.0000000
## S-A-TA3 0.0000000
## S-R-CT4 0.9672667
## S-R-CP4 0.0000000
## S-A-TA4 0.0000000
## B-A-MU1 0.0000000
## B-A-GU1 0.0000000
## B-R-PC2 0.3389861
## B-A-MU2 0.0000000
## B-A-GU2 0.0000000
## B-R-PC3 0.0000000
## B-A-MU3 0.0000000
## B-A-GU3 0.0000000
## B-R-PC4 0.1391234
## B-A-MU4 0.0000000
## B-A-GU4 0.0000000</code></pre>
<p>No código acima, <code>h = 0.8</code> fornece os grupos formados na altura <code>h</code> do eixos das distâncias do dendrograma. Ou seja, no dendrograma, o eixo y (HEIGHT, “h”) representa o valor da distancia escolhida entre os objetos ou grupos de objetos. Portanto, se dois objetos ou grupos de objetos foram agrupados num dado valor (0.8, por exemplo) no eixo <code>height</code>, isso significa que a distancia entre esses objetos é 0.8.</p>
</div>
<div id="construindo-uma-prancha-de-gráficos-comparativos" class="section level2 hasAnchor" number="16.9">
<h2><span class="header-section-number">16.9</span> Construindo uma prancha de gráficos comparativos<a href="upgma.html#construindo-uma-prancha-de-gráficos-comparativos" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="upgma.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.off()</span></span>
<span id="cb33-2"><a href="upgma.html#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span> (<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb33-3"><a href="upgma.html#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cluster1, <span class="at">main =</span> <span class="st">&quot;Dist.Euclidiana&quot;</span>)</span>
<span id="cb33-4"><a href="upgma.html#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cluster3, <span class="at">main =</span> <span class="st">&quot;Rel.Coluna&quot;</span>)</span>
<span id="cb33-5"><a href="upgma.html#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cluster4, <span class="at">main =</span> <span class="st">&quot;ArcSin.SQRT&quot;</span>)</span>
<span id="cb33-6"><a href="upgma.html#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cluster5, <span class="at">main =</span> <span class="st">&quot;Bray-Curtis&quot;</span>)</span></code></pre></div>
<p><img src="fundamentos_de_ecologia_numerica_files/figure-html/unnamed-chunk-18-1.png" width="768" /></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="upgma.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb34-2"><a href="upgma.html#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.off()</span></span></code></pre></div>
</div>
<div id="construindo-heatmaps" class="section level2 hasAnchor" number="16.10">
<h2><span class="header-section-number">16.10</span> Construindo <code>heatmaps</code><a href="upgma.html#construindo-heatmaps" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Agora que vimos de forma comparativa a importância de se relativizar e transformar nossos dados, e também de escolher de forma consciente a medida de distância e o método de fusão, podemos avançar um pouco mais na interpretação dos nossos dados.</p>
<p>Um “heatmap”, ou mapa de calor, é uma imagem em cores (basicamente <code>image(t(x))</code>) com um dendrograma adicionado ao lado esquerdo e/ou ao topo. Normalmente, é realizado o reordenamento das linhas e colunas de acordo com algum conjunto de valores (médias de linha ou coluna) dentro das restrições impostas pelo dendrograma.</p>
<p>Primeiro vamos rever o dendrograma final, usando a Distância de Bray-Curtis e o Método de Fusão UPGMA (ou “average”).</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="upgma.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;RColorBrewer&quot;</span>)</span>
<span id="cb35-2"><a href="upgma.html#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;gplots&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;gplots&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     lowess</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="upgma.html#cb38-1" aria-hidden="true" tabindex="-1"></a>vegdist <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(m_trns, <span class="at">method =</span> <span class="st">&quot;bray&quot;</span>,</span>
<span id="cb38-2"><a href="upgma.html#cb38-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">diag =</span> <span class="cn">TRUE</span>,</span>
<span id="cb38-3"><a href="upgma.html#cb38-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">upper =</span> <span class="cn">FALSE</span>)</span>
<span id="cb38-4"><a href="upgma.html#cb38-4" aria-hidden="true" tabindex="-1"></a>cluster5 <span class="ot">&lt;-</span> <span class="fu">hclust</span>(vegdist, <span class="at">method =</span> <span class="st">&quot;average&quot;</span>)</span>
<span id="cb38-5"><a href="upgma.html#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cluster5, <span class="at">main =</span> <span class="st">&quot;Cluster Dendrogram - Bray-Curtis&quot;</span>)</span>
<span id="cb38-6"><a href="upgma.html#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="upgma.html#cb38-7" aria-hidden="true" tabindex="-1"></a>heatdist <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(vegdist)</span>
<span id="cb38-8"><a href="upgma.html#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="co">#heatdist</span></span></code></pre></div>
<p><img src="fundamentos_de_ecologia_numerica_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>Na sequência fazemos um <code>heatmap</code> <strong>objetos x objetos</strong>, ou seja a comparação bidimensional das clustereds entre unidades amostrais.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="upgma.html#cb39-1" aria-hidden="true" tabindex="-1"></a>col <span class="ot">&lt;-</span> <span class="fu">rev</span>(<span class="fu">heat.colors</span>(<span class="dv">999</span>)) <span class="co">#rev() reverte as cores do heatmap</span></span>
<span id="cb39-2"><a href="upgma.html#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap.2</span>(<span class="at">x=</span>(<span class="fu">as.matrix</span>(vegdist)), <span class="co">#objetos x objetos</span></span>
<span id="cb39-3"><a href="upgma.html#cb39-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">Rowv =</span> <span class="fu">as.dendrogram</span>(cluster5),</span>
<span id="cb39-4"><a href="upgma.html#cb39-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">Colv =</span> <span class="fu">as.dendrogram</span>(cluster5),</span>
<span id="cb39-5"><a href="upgma.html#cb39-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">key =</span> T, <span class="at">tracecol =</span> <span class="cn">NA</span>, <span class="at">revC =</span> T,</span>
<span id="cb39-6"><a href="upgma.html#cb39-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> heat.colors,  <span class="co">#dissimilaridade = 1 - similaridade</span></span>
<span id="cb39-7"><a href="upgma.html#cb39-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">density.info =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb39-8"><a href="upgma.html#cb39-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">&quot;UA´s&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;UA´s&quot;</span>,</span>
<span id="cb39-9"><a href="upgma.html#cb39-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">6</span>) <span class="sc">+</span> <span class="fl">0.2</span>)</span></code></pre></div>
<p><img src="fundamentos_de_ecologia_numerica_files/figure-html/unnamed-chunk-20-1.png" width="768" /></p>
<p>Agora vamos criar um novo dendrograma, para as espécies, mostrando sua similaridade em termos de em quais UA´s elas são mais comuns.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="upgma.html#cb40-1" aria-hidden="true" tabindex="-1"></a>cluster6 <span class="ot">&lt;-</span> <span class="fu">hclust</span>((<span class="fu">vegdist</span>(<span class="fu">t</span>(m_trns), <span class="at">method =</span> <span class="st">&quot;bray&quot;</span>,</span>
<span id="cb40-2"><a href="upgma.html#cb40-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">diag =</span> <span class="cn">TRUE</span>,</span>
<span id="cb40-3"><a href="upgma.html#cb40-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">upper =</span> <span class="cn">FALSE</span>)), <span class="at">method =</span> <span class="st">&quot;average&quot;</span>)</span>
<span id="cb40-4"><a href="upgma.html#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cluster6, <span class="at">main =</span> <span class="st">&quot;Dendrograma dos atributos&quot;</span>)</span></code></pre></div>
<p><img src="fundamentos_de_ecologia_numerica_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>Na sequencia, fazemos um novo <code>heatmap</code> <strong>objetos x atributos</strong>, com a comparação bidimensional das clustereds formadas entre unidades amostrais em relação as espécies mais comuns que ocorreram em cada unidade amostral.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="upgma.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap.2</span>(<span class="fu">t</span>(<span class="fu">as.matrix</span>(m_trns)), <span class="co">#objetos x atributos</span></span>
<span id="cb41-2"><a href="upgma.html#cb41-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">Colv =</span> <span class="fu">as.dendrogram</span>(cluster5),</span>
<span id="cb41-3"><a href="upgma.html#cb41-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">Rowv =</span> <span class="fu">as.dendrogram</span>(cluster6),</span>
<span id="cb41-4"><a href="upgma.html#cb41-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">key =</span> T, <span class="at">tracecol =</span> <span class="cn">NA</span>, <span class="at">revC =</span> T,</span>
<span id="cb41-5"><a href="upgma.html#cb41-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> col,</span>
<span id="cb41-6"><a href="upgma.html#cb41-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">density.info =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb41-7"><a href="upgma.html#cb41-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">&quot;Unidades amostrais&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Espécies&quot;</span>,</span>
<span id="cb41-8"><a href="upgma.html#cb41-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">6</span>) <span class="sc">+</span> <span class="fl">0.1</span>)  <span class="co"># adjust margin size</span></span></code></pre></div>
<p><img src="fundamentos_de_ecologia_numerica_files/figure-html/unnamed-chunk-22-1.png" width="768" /></p>
<div id="percentual-de-encadeamento-chaining" class="section level3 hasAnchor" number="16.10.1">
<h3><span class="header-section-number">16.10.1</span> Percentual de encadeamento (% chaining)<a href="upgma.html#percentual-de-encadeamento-chaining" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Dendrogram Chaining (ou encadeamento) é um termo usado em análises de cluster hierárquico para se referir ao processo de adição sequencial de pequenos grupos a um ou poucos grandes grupos. É possível usar a porcentagem de encadeamento para ajudar a avaliar a qualidade do dendrograma. Análises altamente encadeadas provavelmente não valem a pena serem exploradas em maiores detalhes, provavelmente há alguma falha nos passos anteriores da análise. Por outro lado, pequenas diferenças na porcentagem de encadeamento na extremidade inferior da escala são geralmente um critério pobre para selecionar um algoritmo de ligação em relação a outro <span class="citation">(<a href="#ref-RN1552" role="doc-biblioref">MCCUNE; GRACE, 2002</a>)</span>.</p>
<p>O método para calcular o grau de encadeamento compara o comprimento médio do caminho do dendrograma com o comprimento mínimo possível (sem encadeamento) e o comprimento máximo possível (encadeamento completo). O comprimento do caminho para cada item no dendrograma é o número de nós que o conectam ao nível mais alto do dendrograma. O encadeamento completo ocorre quando cada fusão envolve a adição de um único item a um único grupo, cada vez mais grande <span class="citation">(<a href="#ref-RN1552" role="doc-biblioref">MCCUNE; GRACE, 2002</a>)</span>.</p>
<p>Com esse código podemos calcular o percentual de encadeamento para cada fusão em <code>cluster1</code> e fazer um gráfico simples para observação.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="upgma.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the percent chaining for each merge</span></span>
<span id="cb42-2"><a href="upgma.html#cb42-2" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> cluster1<span class="sc">$</span>height</span>
<span id="cb42-3"><a href="upgma.html#cb42-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(h)</span>
<span id="cb42-4"><a href="upgma.html#cb42-4" aria-hidden="true" tabindex="-1"></a>pc <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, n<span class="dv">-1</span>)</span>
<span id="cb42-5"><a href="upgma.html#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)) {</span>
<span id="cb42-6"><a href="upgma.html#cb42-6" aria-hidden="true" tabindex="-1"></a>  pc[i] <span class="ot">&lt;-</span> <span class="fu">abs</span>(h[i] <span class="sc">-</span> h[i<span class="sc">+</span><span class="dv">1</span>]) <span class="sc">/</span> h[<span class="dv">1</span>] <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb42-7"><a href="upgma.html#cb42-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-8"><a href="upgma.html#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the percent chaining</span></span>
<span id="cb42-9"><a href="upgma.html#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pc, <span class="at">type =</span> <span class="st">&quot;h&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Merge&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Percent chaining&quot;</span>)</span></code></pre></div>
<p><img src="fundamentos_de_ecologia_numerica_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>Para calcular o percentual geral de encadeamento em um dendrograma, é necessário calcular a diferença na altura entre cada nó e seus nós filhos e, em seguida, somar essas diferenças. Essa soma representa o comprimento total do dendrograma. Em seguida, é necessário calcular a soma das diferenças na altura entre cada nó que representa uma fusão e a altura de seus dois nós filhos. Essa soma representa o encadeamento total no dendrograma.</p>
<p>Finalmente, você pode calcular o percentual geral de encadeamento como o encadeamento total dividido pelo comprimento total do dendrograma, multiplicado por 100.</p>
<p>O eixo Y do gráfico mostra a percentagem de encadeamento, que é a diferença na altura entre fusões sucessivas dividida pela altura total do dendrograma, multiplicada por 100. É possível que a percentagem de encadeamento seja superior a 100 se a altura das duas fusões comparadas for maior que a altura total do dendrograma. Nesse caso, a percentagem de encadeamento é truncada em 100.</p>
<p>Isso pode acontecer, por exemplo, se a altura de uma fusão for negativa, o que pode ocorrer se a distância entre dois grupos for menor que zero, ou se o dendrograma for escalado ou truncado de alguma forma.</p>
</div>
<div id="função-loop-para-comparar-os-encadeamentos" class="section level3 hasAnchor" number="16.10.2">
<h3><span class="header-section-number">16.10.2</span> Função <code>loop</code> para comparar os encadeamentos<a href="upgma.html#função-loop-para-comparar-os-encadeamentos" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="upgma.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a list of the four cluster analyses</span></span>
<span id="cb43-2"><a href="upgma.html#cb43-2" aria-hidden="true" tabindex="-1"></a>cluster_list <span class="ot">&lt;-</span> <span class="fu">list</span>(cluster1, cluster2, cluster3, cluster4, cluster5)</span>
<span id="cb43-3"><a href="upgma.html#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="upgma.html#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>)) <span class="co">#posicionamento dos gráficos</span></span>
<span id="cb43-5"><a href="upgma.html#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="upgma.html#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="co"># loop through the list and calculate percent chaining for each</span></span>
<span id="cb43-7"><a href="upgma.html#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb43-8"><a href="upgma.html#cb43-8" aria-hidden="true" tabindex="-1"></a>  h <span class="ot">&lt;-</span> cluster_list[[i]]<span class="sc">$</span>height</span>
<span id="cb43-9"><a href="upgma.html#cb43-9" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(h)</span>
<span id="cb43-10"><a href="upgma.html#cb43-10" aria-hidden="true" tabindex="-1"></a>  pc <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, n<span class="dv">-1</span>)</span>
<span id="cb43-11"><a href="upgma.html#cb43-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)) {</span>
<span id="cb43-12"><a href="upgma.html#cb43-12" aria-hidden="true" tabindex="-1"></a>    pc[j] <span class="ot">&lt;-</span> <span class="fu">abs</span>(h[j] <span class="sc">-</span> h[j<span class="sc">+</span><span class="dv">1</span>]) <span class="sc">/</span> h[<span class="dv">1</span>] <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb43-13"><a href="upgma.html#cb43-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb43-14"><a href="upgma.html#cb43-14" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the percent chaining for each cluster analysis</span></span>
<span id="cb43-15"><a href="upgma.html#cb43-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(pc, <span class="at">type =</span> <span class="st">&quot;h&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Merge&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Percent chaining&quot;</span>, <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">&quot;Cluster &quot;</span>, i))</span>
<span id="cb43-16"><a href="upgma.html#cb43-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="fundamentos_de_ecologia_numerica_files/figure-html/unnamed-chunk-24-1.png" width="768" /></p>
</div>
</div>
<div id="apêndices-13" class="section level2 unnumbered hasAnchor">
<h2>Apêndices<a href="upgma.html#apêndices-13" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="sites-consultados-9" class="section level2 unnumbered hasAnchor">
<h2>Sites consultados<a href="upgma.html#sites-consultados-9" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://copyprogramming.com/howto/how-to-color-labels-of-dendogram-with-dendextend-and-heatmap-2-using-pre-d#efined-sample-groups" class="uri">https://copyprogramming.com/howto/how-to-color-labels-of-dendogram-with-dendextend-and-heatmap-2-using-pre-d#efined-sample-groups</a>
<a href="https://www.datacamp.com/tutorial/hierarchical-clustering-R" class="uri">https://www.datacamp.com/tutorial/hierarchical-clustering-R</a></p>
<div id="outras-formas-de-fazer-a-partição-1" class="section level3 unnumbered hasAnchor">
<h3>Outras formas de fazer a partição<a href="upgma.html#outras-formas-de-fazer-a-partição-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>m_bruta_part2 &lt;- m_bruta_part<span class="math display">\[colSums(abs(m_bruta_part), na.rm = F) \&gt; 0\]</span>
m_bruta_part2 &lt;- subset(m_bruta_part, colSums != 0) m_bruta_part2 &lt;-
m_bruta_part<span class="math display">\[, colSums(m_bruta_part != 0) \&gt; 0\]</span></p>
</div>
<div id="código-1" class="section level3 unnumbered hasAnchor">
<h3>Código<a href="upgma.html#código-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>range(euclidma) par(mfrow=c(2,1)) hist(euclidma, breaks = 15, #determina
o no. de colunas do histograma xlim = range(floor(min(euclidma)),
ceiling(max(euclidma))), xlab = “Distr. de Frequências”, freq = FALSE)
curve(dnorm(x, mean=mean(euclidma), sd=sd(euclidma)), add=TRUE)
boxplot.default(euclidma, horizontal = TRUE, frame = FALSE, xlab=“Distr.
de Frequências”, ylim=c(floor(min(euclidma)), ceiling(max(euclidma))))</p>
</div>
</div>
<div id="script-limpo-10" class="section level2 unnumbered hasAnchor">
<h2>Script limpo<a href="upgma.html#script-limpo-10" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Aqui apresento o scrip na íntegra sem os textos ou outros comentários. Você pode copiar e colar no R para executa-lo. Lembre de remover os <span style="color:green"><code>#</code></span> ou <span style="color:green"><code>##</code></span> caso necessite executar essas linhas.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="upgma.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="do">## dev.off() #apaga os graficos, se houver algum</span></span>
<span id="cb44-2"><a href="upgma.html#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="do">## rm(list=ls(all=TRUE)) #limpa a memória</span></span>
<span id="cb44-3"><a href="upgma.html#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="do">## cat(&quot;\014&quot;) #limpa o console</span></span>
<span id="cb44-4"><a href="upgma.html#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="do">## install.packages(&quot;openxlsx&quot;) #importa arquivos do excel</span></span>
<span id="cb44-5"><a href="upgma.html#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="do">## install.packages(&quot;moments&quot;) #calcula assimetria e curtose dos dados</span></span>
<span id="cb44-6"><a href="upgma.html#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="do">## install.packages(&quot;matrixStats&quot;) #fornece funções rápidas para a estatística de matrizes</span></span>
<span id="cb44-7"><a href="upgma.html#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="do">## install.packages(&quot;gt&quot;) #ferramenta para criação de tabelas bonitas e personalizáveis</span></span>
<span id="cb44-8"><a href="upgma.html#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="do">## getwd()</span></span>
<span id="cb44-9"><a href="upgma.html#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="do">## setwd(&quot;C:/Seu/Diretório/De/Trabalho&quot;)</span></span>
<span id="cb44-10"><a href="upgma.html#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb44-11"><a href="upgma.html#cb44-11" aria-hidden="true" tabindex="-1"></a>m_bruta <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(<span class="st">&quot;D:/Elvio/OneDrive/Disciplinas/_EcoNumerica/5.Matrizes/peixes06.xlsx&quot;</span>,</span>
<span id="cb44-12"><a href="upgma.html#cb44-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">rowNames =</span> T, <span class="at">colNames =</span> T,</span>
<span id="cb44-13"><a href="upgma.html#cb44-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sheet =</span> <span class="st">&quot;Sheet1&quot;</span>)</span>
<span id="cb44-14"><a href="upgma.html#cb44-14" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(m_bruta)</span>
<span id="cb44-15"><a href="upgma.html#cb44-15" aria-hidden="true" tabindex="-1"></a>m_bruta_ma <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(m_bruta) <span class="co">#lê m_bruta como uma matriz</span></span>
<span id="cb44-16"><a href="upgma.html#cb44-16" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(m_bruta_ma)</span>
<span id="cb44-17"><a href="upgma.html#cb44-17" aria-hidden="true" tabindex="-1"></a><span class="co">#m_bruta</span></span>
<span id="cb44-18"><a href="upgma.html#cb44-18" aria-hidden="true" tabindex="-1"></a>m_bruta_ma[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>] <span class="co">#[1:5,1:5] mostra apenas as linhas e colunas de 1 a 5.</span></span>
<span id="cb44-19"><a href="upgma.html#cb44-19" aria-hidden="true" tabindex="-1"></a><span class="co">#m_bruta &lt;- (m_bruta)   # &lt;1&gt;</span></span>
<span id="cb44-20"><a href="upgma.html#cb44-20" aria-hidden="true" tabindex="-1"></a><span class="co">#View(m_bruta)</span></span>
<span id="cb44-21"><a href="upgma.html#cb44-21" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(m_bruta)</span>
<span id="cb44-22"><a href="upgma.html#cb44-22" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(m_bruta)</span>
<span id="cb44-23"><a href="upgma.html#cb44-23" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(m_bruta)</span>
<span id="cb44-24"><a href="upgma.html#cb44-24" aria-hidden="true" tabindex="-1"></a><span class="fu">mode</span>(m_bruta)</span>
<span id="cb44-25"><a href="upgma.html#cb44-25" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(m_bruta)</span>
<span id="cb44-26"><a href="upgma.html#cb44-26" aria-hidden="true" tabindex="-1"></a><span class="co">#?str</span></span>
<span id="cb44-27"><a href="upgma.html#cb44-27" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(m_bruta) <span class="co">#menor e maior valores</span></span>
<span id="cb44-28"><a href="upgma.html#cb44-28" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(m_bruta) <span class="co">#no. de colunas</span></span>
<span id="cb44-29"><a href="upgma.html#cb44-29" aria-hidden="true" tabindex="-1"></a><span class="fu">ncol</span>(m_bruta) <span class="co">#no. de N colunas</span></span>
<span id="cb44-30"><a href="upgma.html#cb44-30" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(m_bruta) <span class="co">#no. de M linhas</span></span>
<span id="cb44-31"><a href="upgma.html#cb44-31" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">lengths</span>(m_bruta)) <span class="co">#soma os nos. de colunas</span></span>
<span id="cb44-32"><a href="upgma.html#cb44-32" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">as.matrix</span>(m_bruta)) <span class="co">#tamanho da matriz m x n</span></span>
<span id="cb44-33"><a href="upgma.html#cb44-33" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(m_bruta <span class="sc">==</span> <span class="dv">0</span>) <span class="co"># número de observações igual a zero</span></span>
<span id="cb44-34"><a href="upgma.html#cb44-34" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(m_bruta <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="co"># número de observações maiores que zero</span></span>
<span id="cb44-35"><a href="upgma.html#cb44-35" aria-hidden="true" tabindex="-1"></a>zeros <span class="ot">&lt;-</span> (<span class="fu">sum</span>(m_bruta <span class="sc">==</span> <span class="dv">0</span>)<span class="sc">/</span><span class="fu">length</span>(<span class="fu">as.matrix</span>(m_bruta)))<span class="sc">*</span><span class="dv">100</span> <span class="co"># proporção de zeros na matriz</span></span>
<span id="cb44-36"><a href="upgma.html#cb44-36" aria-hidden="true" tabindex="-1"></a>zeros</span>
<span id="cb44-37"><a href="upgma.html#cb44-37" aria-hidden="true" tabindex="-1"></a>tamanho <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb44-38"><a href="upgma.html#cb44-38" aria-hidden="true" tabindex="-1"></a>  Função <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;range&quot;</span>, <span class="st">&quot;lenght&quot;</span>, <span class="st">&quot;m cols&quot;</span>, <span class="st">&quot;n linhas&quot;</span>, <span class="st">&quot;Tamanho&quot;</span>, <span class="st">&quot;Tamanho&quot;</span>,</span>
<span id="cb44-39"><a href="upgma.html#cb44-39" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;Zeros&quot;</span>, <span class="st">&quot;Nao zeros&quot;</span>, <span class="st">&quot;% Zeros&quot;</span>),</span>
<span id="cb44-40"><a href="upgma.html#cb44-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">Resultado =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="fu">range</span>(m_bruta), <span class="at">collapse =</span> <span class="st">&quot; - &quot;</span>), <span class="fu">length</span>(m_bruta), <span class="fu">ncol</span>(m_bruta),</span>
<span id="cb44-41"><a href="upgma.html#cb44-41" aria-hidden="true" tabindex="-1"></a>                <span class="fu">nrow</span>(m_bruta), <span class="fu">sum</span>(<span class="fu">lengths</span>(m_bruta)), <span class="fu">length</span>(<span class="fu">as.matrix</span>(m_bruta)), <span class="fu">sum</span>(m_bruta <span class="sc">==</span> <span class="dv">0</span>),</span>
<span id="cb44-42"><a href="upgma.html#cb44-42" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sum</span>(m_bruta <span class="sc">&gt;</span> <span class="dv">0</span>), <span class="fu">round</span>(zeros, <span class="dv">1</span>))</span>
<span id="cb44-43"><a href="upgma.html#cb44-43" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-44"><a href="upgma.html#cb44-44" aria-hidden="true" tabindex="-1"></a>tamanho</span>
<span id="cb44-45"><a href="upgma.html#cb44-45" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(tamanho, <span class="at">format =</span> <span class="st">&quot;markdown&quot;</span>, <span class="at">caption =</span> <span class="st">&quot;Resumo das informações sobre o tamanho da matriz&quot;</span>)</span>
<span id="cb44-46"><a href="upgma.html#cb44-46" aria-hidden="true" tabindex="-1"></a>euclid <span class="ot">&lt;-</span> <span class="fu">dist</span>(m_bruta, <span class="at">method =</span> <span class="st">&quot;euclidian&quot;</span>, <span class="at">diag =</span> <span class="cn">TRUE</span>, <span class="at">upper =</span> <span class="cn">FALSE</span>)</span>
<span id="cb44-47"><a href="upgma.html#cb44-47" aria-hidden="true" tabindex="-1"></a><span class="co">#?dist</span></span>
<span id="cb44-48"><a href="upgma.html#cb44-48" aria-hidden="true" tabindex="-1"></a><span class="co">#euclid</span></span>
<span id="cb44-49"><a href="upgma.html#cb44-49" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(euclid)</span>
<span id="cb44-50"><a href="upgma.html#cb44-50" aria-hidden="true" tabindex="-1"></a><span class="fu">mode</span>(euclid)</span>
<span id="cb44-51"><a href="upgma.html#cb44-51" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(euclid)</span>
<span id="cb44-52"><a href="upgma.html#cb44-52" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">as.matrix</span>(euclid))</span>
<span id="cb44-53"><a href="upgma.html#cb44-53" aria-hidden="true" tabindex="-1"></a><span class="fu">as.matrix</span>(euclid)[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>] <span class="co">#mostra as 5 primeiras linhas e colunas da matriz</span></span>
<span id="cb44-54"><a href="upgma.html#cb44-54" aria-hidden="true" tabindex="-1"></a>euclid_ma <span class="ot">&lt;-</span> (<span class="fu">as.matrix</span>(euclid))</span>
<span id="cb44-55"><a href="upgma.html#cb44-55" aria-hidden="true" tabindex="-1"></a><span class="co">#View(euclid_ma)</span></span>
<span id="cb44-56"><a href="upgma.html#cb44-56" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(euclid_ma)</span>
<span id="cb44-57"><a href="upgma.html#cb44-57" aria-hidden="true" tabindex="-1"></a><span class="fu">mode</span>(euclid_ma)</span>
<span id="cb44-58"><a href="upgma.html#cb44-58" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(euclid_ma)</span>
<span id="cb44-59"><a href="upgma.html#cb44-59" aria-hidden="true" tabindex="-1"></a>euclid_ma[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>] <span class="co">#mostra as 5 primeiras linhas e colunas da matriz</span></span>
<span id="cb44-60"><a href="upgma.html#cb44-60" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(m_bruta)</span>
<span id="cb44-61"><a href="upgma.html#cb44-61" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(euclid)</span>
<span id="cb44-62"><a href="upgma.html#cb44-62" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(euclid)</span>
<span id="cb44-63"><a href="upgma.html#cb44-63" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(euclid)</span>
<span id="cb44-64"><a href="upgma.html#cb44-64" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(euclid) <span class="co">#CENTROIDE!! OU Grand mean</span></span>
<span id="cb44-65"><a href="upgma.html#cb44-65" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(euclid)  <span class="co">#Standard deviation</span></span>
<span id="cb44-66"><a href="upgma.html#cb44-66" aria-hidden="true" tabindex="-1"></a>centroide <span class="ot">&lt;-</span> <span class="fu">mean</span>(euclid)</span>
<span id="cb44-67"><a href="upgma.html#cb44-67" aria-hidden="true" tabindex="-1"></a>centroide</span>
<span id="cb44-68"><a href="upgma.html#cb44-68" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(euclid)</span>
<span id="cb44-69"><a href="upgma.html#cb44-69" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">nrow</span>(m_bruta)</span>
<span id="cb44-70"><a href="upgma.html#cb44-70" aria-hidden="true" tabindex="-1"></a>m</span>
<span id="cb44-71"><a href="upgma.html#cb44-71" aria-hidden="true" tabindex="-1"></a>m<span class="sc">*</span>(m<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb44-72"><a href="upgma.html#cb44-72" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(euclid)</span>
<span id="cb44-73"><a href="upgma.html#cb44-73" aria-hidden="true" tabindex="-1"></a>Sumario1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">min</span>(euclid),</span>
<span id="cb44-74"><a href="upgma.html#cb44-74" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">max</span>(euclid),</span>
<span id="cb44-75"><a href="upgma.html#cb44-75" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">sd</span>(euclid),</span>
<span id="cb44-76"><a href="upgma.html#cb44-76" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">mean</span>(euclid),</span>
<span id="cb44-77"><a href="upgma.html#cb44-77" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">length</span>(euclid))</span>
<span id="cb44-78"><a href="upgma.html#cb44-78" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Sumario1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Minimo&quot;</span>, <span class="st">&quot;Maximo&quot;</span>, <span class="st">&quot;Desv.Padr&quot;</span>, <span class="st">&quot;Media&quot;</span>, <span class="st">&quot;m(m-1)/2&quot;</span>)</span>
<span id="cb44-79"><a href="upgma.html#cb44-79" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(Sumario1) <span class="ot">&lt;-</span> (<span class="st">&quot;Valores&quot;</span>)</span>
<span id="cb44-80"><a href="upgma.html#cb44-80" aria-hidden="true" tabindex="-1"></a>Sumario1</span>
<span id="cb44-81"><a href="upgma.html#cb44-81" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(euclid)</span>
<span id="cb44-82"><a href="upgma.html#cb44-82" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb44-83"><a href="upgma.html#cb44-83" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(euclid,</span>
<span id="cb44-84"><a href="upgma.html#cb44-84" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> <span class="dv">15</span>, <span class="co">#determina o no. de colunas do histograma</span></span>
<span id="cb44-85"><a href="upgma.html#cb44-85" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">range</span>(<span class="fu">floor</span>(<span class="fu">min</span>(euclid)), <span class="fu">ceiling</span>(<span class="fu">max</span>(euclid))), </span>
<span id="cb44-86"><a href="upgma.html#cb44-86" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Distr. de Frequências&quot;</span>,</span>
<span id="cb44-87"><a href="upgma.html#cb44-87" aria-hidden="true" tabindex="-1"></a>     <span class="at">freq =</span> <span class="cn">FALSE</span>)</span>
<span id="cb44-88"><a href="upgma.html#cb44-88" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x, <span class="at">mean=</span><span class="fu">mean</span>(euclid), <span class="at">sd=</span><span class="fu">sd</span>(euclid)), <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb44-89"><a href="upgma.html#cb44-89" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot.default</span>(euclid, <span class="at">horizontal =</span> <span class="cn">TRUE</span>, <span class="at">frame =</span> <span class="cn">FALSE</span>,</span>
<span id="cb44-90"><a href="upgma.html#cb44-90" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlab=</span><span class="st">&quot;Distr. de Frequências&quot;</span>,</span>
<span id="cb44-91"><a href="upgma.html#cb44-91" aria-hidden="true" tabindex="-1"></a>                <span class="at">ylim=</span><span class="fu">c</span>(<span class="fu">floor</span>(<span class="fu">min</span>(euclid)), <span class="fu">ceiling</span>(<span class="fu">max</span>(euclid)))) <span class="co">#Limites do eixo Y</span></span>
<span id="cb44-92"><a href="upgma.html#cb44-92" aria-hidden="true" tabindex="-1"></a><span class="do">## dev.off()</span></span>
<span id="cb44-93"><a href="upgma.html#cb44-93" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(matrixStats)</span>
<span id="cb44-94"><a href="upgma.html#cb44-94" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(moments)</span>
<span id="cb44-95"><a href="upgma.html#cb44-95" aria-hidden="true" tabindex="-1"></a>euclid_ma <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(euclid)</span>
<span id="cb44-96"><a href="upgma.html#cb44-96" aria-hidden="true" tabindex="-1"></a>euclid_ma</span>
<span id="cb44-97"><a href="upgma.html#cb44-97" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(euclid_ma) <span class="co">#valor errado</span></span>
<span id="cb44-98"><a href="upgma.html#cb44-98" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(euclid_ma) <span class="co">#valor errado</span></span>
<span id="cb44-99"><a href="upgma.html#cb44-99" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(euclid_ma) <span class="co">#valor errado</span></span>
<span id="cb44-100"><a href="upgma.html#cb44-100" aria-hidden="true" tabindex="-1"></a><span class="fu">is.na</span>(euclid_ma) <span class="ot">&lt;-</span> euclid_ma<span class="sc">==</span><span class="dv">0</span> <span class="co">#atribui n.a. aos valores = 0</span></span>
<span id="cb44-101"><a href="upgma.html#cb44-101" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(euclid_ma, <span class="at">na.rm=</span>T)  <span class="co">#valor correto, omite valores n.a. do calculo</span></span>
<span id="cb44-102"><a href="upgma.html#cb44-102" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(euclid_ma, <span class="at">na.rm=</span>T) <span class="co">#valor correto, omite valores n.a. do calculo</span></span>
<span id="cb44-103"><a href="upgma.html#cb44-103" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(euclid_ma, <span class="at">na.rm=</span>T) <span class="co">#valor correto, omite valores n.a. do calculo</span></span>
<span id="cb44-104"><a href="upgma.html#cb44-104" aria-hidden="true" tabindex="-1"></a><span class="co">#colMeans(euclid_ma, na.rm=T) #omite valores n.a. do calculo</span></span>
<span id="cb44-105"><a href="upgma.html#cb44-105" aria-hidden="true" tabindex="-1"></a><span class="co">#rowMeans(euclid_ma, na.rm=T) #omite valores n.a. do calculo</span></span>
<span id="cb44-106"><a href="upgma.html#cb44-106" aria-hidden="true" tabindex="-1"></a>centroide_ma <span class="ot">&lt;-</span> <span class="fu">mean</span>(euclid_ma, <span class="at">na.rm=</span>T)</span>
<span id="cb44-107"><a href="upgma.html#cb44-107" aria-hidden="true" tabindex="-1"></a>av.dist <span class="ot">&lt;-</span> (<span class="fu">as.matrix</span>(<span class="fu">colMeans</span>(euclid_ma, <span class="at">na.rm=</span>T)))</span>
<span id="cb44-108"><a href="upgma.html#cb44-108" aria-hidden="true" tabindex="-1"></a>av.desvpad <span class="ot">&lt;-</span> (<span class="fu">as.matrix</span>(<span class="fu">colSds</span>(euclid_ma, <span class="at">na.rm=</span>T)))</span>
<span id="cb44-109"><a href="upgma.html#cb44-109" aria-hidden="true" tabindex="-1"></a>dp.centroide_ma <span class="ot">&lt;-</span> (av.dist<span class="sc">-</span>centroide_ma)<span class="sc">/</span>(<span class="fu">colSds</span>(av.dist)) <span class="co">#ou z-scores</span></span>
<span id="cb44-110"><a href="upgma.html#cb44-110" aria-hidden="true" tabindex="-1"></a>list <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">cbind</span>(av.dist, av.desvpad, dp.centroide_ma))</span>
<span id="cb44-111"><a href="upgma.html#cb44-111" aria-hidden="true" tabindex="-1"></a>list</span>
<span id="cb44-112"><a href="upgma.html#cb44-112" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(list, <span class="at">do.NULL =</span> <span class="cn">FALSE</span>)</span>
<span id="cb44-113"><a href="upgma.html#cb44-113" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(list) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Av.Dist&quot;</span>, <span class="st">&quot;Av.StDev&quot;</span>, <span class="st">&quot;DP.Centroide&quot;</span>)</span>
<span id="cb44-114"><a href="upgma.html#cb44-114" aria-hidden="true" tabindex="-1"></a>list2 <span class="ot">&lt;-</span> list[<span class="fu">order</span>(list[,<span class="dv">1</span>], <span class="at">decreasing =</span> <span class="cn">TRUE</span>),] <span class="co">#[,1] ou o nome da coluna</span></span>
<span id="cb44-115"><a href="upgma.html#cb44-115" aria-hidden="true" tabindex="-1"></a>list2</span>
<span id="cb44-116"><a href="upgma.html#cb44-116" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>))</span>
<span id="cb44-117"><a href="upgma.html#cb44-117" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(list2[, <span class="st">&quot;Av.Dist&quot;</span>],</span>
<span id="cb44-118"><a href="upgma.html#cb44-118" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> <span class="dv">15</span>, <span class="co">#determina o no. de colunas do histograma</span></span>
<span id="cb44-119"><a href="upgma.html#cb44-119" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Distr. de Frequências das Distâncias (em dp) para o centroide&quot;</span>,</span>
<span id="cb44-120"><a href="upgma.html#cb44-120" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Distribuição de Frequência da distância média para o centroide&quot;</span>,</span>
<span id="cb44-121"><a href="upgma.html#cb44-121" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">range</span>(<span class="fu">floor</span>(<span class="fu">min</span>(av.dist)), <span class="fu">ceiling</span>(<span class="fu">max</span>(av.dist))), <span class="co">#substitua aqui o menor e maior valor do `range()`</span></span>
<span id="cb44-122"><a href="upgma.html#cb44-122" aria-hidden="true" tabindex="-1"></a>     <span class="at">freq =</span> T)</span>
<span id="cb44-123"><a href="upgma.html#cb44-123" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(list2[, <span class="st">&quot;Av.Dist&quot;</span>],</span>
<span id="cb44-124"><a href="upgma.html#cb44-124" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> <span class="dv">15</span>, <span class="co">#determina o no. de colunas do histograma</span></span>
<span id="cb44-125"><a href="upgma.html#cb44-125" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Distr. de Frequências das Distâncias (em dp) para o centroide&quot;</span>,</span>
<span id="cb44-126"><a href="upgma.html#cb44-126" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Curva de normalidade ajustada para a Distribuição de Frequência&quot;</span>,</span>
<span id="cb44-127"><a href="upgma.html#cb44-127" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">range</span>(<span class="fu">floor</span>(<span class="fu">min</span>(av.dist)), <span class="fu">ceiling</span>(<span class="fu">max</span>(av.dist))), <span class="co">#substitua aqui o menor e maior valor do `range()`</span></span>
<span id="cb44-128"><a href="upgma.html#cb44-128" aria-hidden="true" tabindex="-1"></a>     <span class="at">freq =</span> F)</span>
<span id="cb44-129"><a href="upgma.html#cb44-129" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x, <span class="at">mean=</span><span class="fu">mean</span>(list2[, <span class="st">&quot;Av.Dist&quot;</span>]), <span class="at">sd=</span><span class="fu">sd</span>(list2[, <span class="st">&quot;Av.Dist&quot;</span>])), <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb44-130"><a href="upgma.html#cb44-130" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot.default</span>(list2[, <span class="st">&quot;Av.Dist&quot;</span>], <span class="at">horizontal =</span> <span class="cn">TRUE</span>, <span class="at">frame =</span> <span class="cn">FALSE</span>,</span>
<span id="cb44-131"><a href="upgma.html#cb44-131" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlab=</span><span class="st">&quot;Distr. de Frequências&quot;</span>,</span>
<span id="cb44-132"><a href="upgma.html#cb44-132" aria-hidden="true" tabindex="-1"></a>                <span class="at">ylim=</span><span class="fu">c</span>(<span class="fu">floor</span>(<span class="fu">min</span>(av.dist)), <span class="fu">ceiling</span>(<span class="fu">max</span>(av.dist)))) <span class="co">#substitua aqui o menor e maior valor do `range()`</span></span>
<span id="cb44-133"><a href="upgma.html#cb44-133" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb44-134"><a href="upgma.html#cb44-134" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(dp.centroide_ma)</span>
<span id="cb44-135"><a href="upgma.html#cb44-135" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>))</span>
<span id="cb44-136"><a href="upgma.html#cb44-136" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(list2[, <span class="st">&quot;DP.Centroide&quot;</span>],</span>
<span id="cb44-137"><a href="upgma.html#cb44-137" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> <span class="dv">15</span>, <span class="co">#determina o no. de colunas do histograma</span></span>
<span id="cb44-138"><a href="upgma.html#cb44-138" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Distr. de Frequências das Distâncias dos desvios padões para o centroide&quot;</span>,</span>
<span id="cb44-139"><a href="upgma.html#cb44-139" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Distribuição de Frequência dos desvio padões das distâncias médias para o centroide&quot;</span>,</span>
<span id="cb44-140"><a href="upgma.html#cb44-140" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">range</span>(<span class="fu">floor</span>(<span class="fu">min</span>(dp.centroide_ma)), <span class="fu">ceiling</span>(<span class="fu">max</span>(dp.centroide_ma))), <span class="co">#substitua aqui o menor e maior valor do `range()`</span></span>
<span id="cb44-141"><a href="upgma.html#cb44-141" aria-hidden="true" tabindex="-1"></a>     <span class="at">freq =</span> T)</span>
<span id="cb44-142"><a href="upgma.html#cb44-142" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(list2[, <span class="st">&quot;DP.Centroide&quot;</span>],</span>
<span id="cb44-143"><a href="upgma.html#cb44-143" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> <span class="dv">15</span>, <span class="co">#determina o no. de colunas do histograma</span></span>
<span id="cb44-144"><a href="upgma.html#cb44-144" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Distr. de Frequências das Distâncias dos desvios padrões das distâncias médias para o centroide&quot;</span>,</span>
<span id="cb44-145"><a href="upgma.html#cb44-145" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Curva de normalidade ajustada para a Distribuição de Frequência&quot;</span>,</span>
<span id="cb44-146"><a href="upgma.html#cb44-146" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">range</span>(<span class="fu">floor</span>(<span class="fu">min</span>(dp.centroide_ma)), <span class="fu">ceiling</span>(<span class="fu">max</span>(dp.centroide_ma))), <span class="co">#substitua aqui o menor e maior valor do `range()`</span></span>
<span id="cb44-147"><a href="upgma.html#cb44-147" aria-hidden="true" tabindex="-1"></a>     <span class="at">freq =</span> F)</span>
<span id="cb44-148"><a href="upgma.html#cb44-148" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x, <span class="at">mean=</span><span class="fu">mean</span>(list2[, <span class="st">&quot;DP.Centroide&quot;</span>]), <span class="at">sd=</span><span class="fu">sd</span>(list2[, <span class="st">&quot;DP.Centroide&quot;</span>])), <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb44-149"><a href="upgma.html#cb44-149" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot.default</span>(list2[, <span class="st">&quot;DP.Centroide&quot;</span>], <span class="at">horizontal =</span> <span class="cn">TRUE</span>, <span class="at">frame =</span> <span class="cn">FALSE</span>,</span>
<span id="cb44-150"><a href="upgma.html#cb44-150" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlab=</span><span class="st">&quot;Distr. de Frequências&quot;</span>,</span>
<span id="cb44-151"><a href="upgma.html#cb44-151" aria-hidden="true" tabindex="-1"></a>                <span class="at">ylim=</span><span class="fu">c</span>(<span class="fu">floor</span>(<span class="fu">min</span>(dp.centroide_ma)), <span class="fu">ceiling</span>(<span class="fu">max</span>(dp.centroide_ma)))) <span class="co">#substitua aqui o menor e maior valor do `range()`</span></span>
<span id="cb44-152"><a href="upgma.html#cb44-152" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb44-153"><a href="upgma.html#cb44-153" aria-hidden="true" tabindex="-1"></a><span class="do">## dev.off()</span></span>
<span id="cb44-154"><a href="upgma.html#cb44-154" aria-hidden="true" tabindex="-1"></a>cutoff <span class="ot">&lt;-</span> <span class="fl">2.0</span></span>
<span id="cb44-155"><a href="upgma.html#cb44-155" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb44-156"><a href="upgma.html#cb44-156" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span>(cutoff, <span class="at">nsmall =</span> <span class="dv">1</span>)</span>
<span id="cb44-157"><a href="upgma.html#cb44-157" aria-hidden="true" tabindex="-1"></a>listf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(list2)</span>
<span id="cb44-158"><a href="upgma.html#cb44-158" aria-hidden="true" tabindex="-1"></a>listf<span class="sc">$</span>Outliers <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(listf<span class="sc">$</span>DP.Centroide<span class="sc">&gt;-</span>cutoff <span class="co">#CUTOFF MENOR QUE -&#39;cutoff</span></span>
<span id="cb44-159"><a href="upgma.html#cb44-159" aria-hidden="true" tabindex="-1"></a>                         <span class="sc">&amp;</span> listf<span class="sc">$</span>DP.Centroide<span class="sc">&lt;</span>cutoff,  <span class="co">#CUTOFF MAIOR QUE &#39;cutoff&#39;</span></span>
<span id="cb44-160"><a href="upgma.html#cb44-160" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;&quot;</span>, <span class="st">&quot;OUT&quot;</span>) </span>
<span id="cb44-161"><a href="upgma.html#cb44-161" aria-hidden="true" tabindex="-1"></a>listf</span>
<span id="cb44-162"><a href="upgma.html#cb44-162" aria-hidden="true" tabindex="-1"></a><span class="fu">gt</span>(<span class="fu">cbind</span>(<span class="at">Sitios=</span><span class="fu">rownames</span>(listf),listf))</span>
<span id="cb44-163"><a href="upgma.html#cb44-163" aria-hidden="true" tabindex="-1"></a>part <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;B-A-MU4&quot;</span>, <span class="st">&quot;B-A-MU3&quot;</span>, <span class="st">&quot;S-A-TA4&quot;</span>, <span class="st">&quot;S-R-CT3&quot;</span>)</span>
<span id="cb44-164"><a href="upgma.html#cb44-164" aria-hidden="true" tabindex="-1"></a>part</span>
<span id="cb44-165"><a href="upgma.html#cb44-165" aria-hidden="true" tabindex="-1"></a>m_bruta_part <span class="ot">&lt;-</span> m_bruta[<span class="sc">!</span>(<span class="fu">row.names</span>(m_bruta) <span class="sc">%in%</span> <span class="fu">c</span>(part)),]</span>
<span id="cb44-166"><a href="upgma.html#cb44-166" aria-hidden="true" tabindex="-1"></a><span class="co">#m_bruta_part</span></span>
<span id="cb44-167"><a href="upgma.html#cb44-167" aria-hidden="true" tabindex="-1"></a>sum <span class="ot">&lt;-</span> <span class="fu">colSums</span>(m_bruta_part)</span>
<span id="cb44-168"><a href="upgma.html#cb44-168" aria-hidden="true" tabindex="-1"></a>sum</span>
<span id="cb44-169"><a href="upgma.html#cb44-169" aria-hidden="true" tabindex="-1"></a>zero_sum_cols <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">which</span>(<span class="fu">colSums</span>(m_bruta_part) <span class="sc">==</span> <span class="dv">0</span>))</span>
<span id="cb44-170"><a href="upgma.html#cb44-170" aria-hidden="true" tabindex="-1"></a>zero_sum_cols <span class="co">#nomes das espécies zeradas</span></span>
<span id="cb44-171"><a href="upgma.html#cb44-171" aria-hidden="true" tabindex="-1"></a>m_bruta_part2 <span class="ot">&lt;-</span> m_bruta_part[(<span class="fu">colSums</span>(m_bruta_part) <span class="sc">!=</span> <span class="dv">0</span>)] <span class="co">#em != a exclamação inverte o sentido</span></span>
<span id="cb44-172"><a href="upgma.html#cb44-172" aria-hidden="true" tabindex="-1"></a>zero_sum_cols2 <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">which</span>(<span class="fu">colSums</span>(m_bruta_part2) <span class="sc">==</span> <span class="dv">0</span>))</span>
<span id="cb44-173"><a href="upgma.html#cb44-173" aria-hidden="true" tabindex="-1"></a>zero_sum_cols2 <span class="co">#nomes das espécies zeradas</span></span>
<span id="cb44-174"><a href="upgma.html#cb44-174" aria-hidden="true" tabindex="-1"></a>sum<span class="ot">&lt;-</span><span class="fu">colSums</span>(m_bruta_part2)</span>
<span id="cb44-175"><a href="upgma.html#cb44-175" aria-hidden="true" tabindex="-1"></a>sum</span>
<span id="cb44-176"><a href="upgma.html#cb44-176" aria-hidden="true" tabindex="-1"></a><span class="co">#m_bruta_part2</span></span>
<span id="cb44-177"><a href="upgma.html#cb44-177" aria-hidden="true" tabindex="-1"></a><span class="co">#m_bruta_part2 &lt;- as.matrix(m_bruta_part2)</span></span>
<span id="cb44-178"><a href="upgma.html#cb44-178" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(m_bruta_part2)</span>
<span id="cb44-179"><a href="upgma.html#cb44-179" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">as.matrix</span>(m_bruta_part2))</span>
<span id="cb44-180"><a href="upgma.html#cb44-180" aria-hidden="true" tabindex="-1"></a><span class="do">## df &lt;- data.frame(Sites = rownames(m_bruta), m_bruta,</span></span>
<span id="cb44-181"><a href="upgma.html#cb44-181" aria-hidden="true" tabindex="-1"></a><span class="do">##                  row.names = NULL,</span></span>
<span id="cb44-182"><a href="upgma.html#cb44-182" aria-hidden="true" tabindex="-1"></a><span class="do">##                  check.names = FALSE) #add titulo a primeira coluna</span></span>
<span id="cb44-183"><a href="upgma.html#cb44-183" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb44-184"><a href="upgma.html#cb44-184" aria-hidden="true" tabindex="-1"></a><span class="do">## write.table(m_bruta_part2, &quot;m_trabcsv.csv&quot;,</span></span>
<span id="cb44-185"><a href="upgma.html#cb44-185" aria-hidden="true" tabindex="-1"></a><span class="do">##             sep = &quot;;&quot;, dec = &quot;.&quot;, #&quot;\t&quot;,</span></span>
<span id="cb44-186"><a href="upgma.html#cb44-186" aria-hidden="true" tabindex="-1"></a><span class="do">##             row.names = TRUE,</span></span>
<span id="cb44-187"><a href="upgma.html#cb44-187" aria-hidden="true" tabindex="-1"></a><span class="do">##             quote = TRUE,</span></span>
<span id="cb44-188"><a href="upgma.html#cb44-188" aria-hidden="true" tabindex="-1"></a><span class="do">##             append = FALSE)</span></span>
<span id="cb44-189"><a href="upgma.html#cb44-189" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb44-190"><a href="upgma.html#cb44-190" aria-hidden="true" tabindex="-1"></a><span class="do">## m_trab &lt;- read.csv(&quot;m_trabcsv.csv&quot;,</span></span>
<span id="cb44-191"><a href="upgma.html#cb44-191" aria-hidden="true" tabindex="-1"></a><span class="do">##                    sep = &quot;;&quot;, dec = &quot;.&quot;,</span></span>
<span id="cb44-192"><a href="upgma.html#cb44-192" aria-hidden="true" tabindex="-1"></a><span class="do">##                    row.names = 1,</span></span>
<span id="cb44-193"><a href="upgma.html#cb44-193" aria-hidden="true" tabindex="-1"></a><span class="do">##                    header = TRUE,</span></span>
<span id="cb44-194"><a href="upgma.html#cb44-194" aria-hidden="true" tabindex="-1"></a><span class="do">##                    na.strings = NA,</span></span>
<span id="cb44-195"><a href="upgma.html#cb44-195" aria-hidden="true" tabindex="-1"></a><span class="do">##                    check.names = FALSE, #impede que o R mude os nomes das colunas</span></span>
<span id="cb44-196"><a href="upgma.html#cb44-196" aria-hidden="true" tabindex="-1"></a><span class="do">##                    col.names = gsub(&quot;(^|_)([a-z])&quot;, &quot;\\1\\U\\2&quot;,</span></span>
<span id="cb44-197"><a href="upgma.html#cb44-197" aria-hidden="true" tabindex="-1"></a><span class="do">##                                     names(m_trab), perl = TRUE))</span></span></code></pre></div>
</div>
<div id="referências-14" class="section level2 unnumbered hasAnchor">
<h2>Referências<a href="upgma.html#referências-14" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
<h3>Bibliografia<a href="bibliografia.html#bibliografia" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body" entry-spacing="1">
<div id="ref-RN1552" class="csl-entry">
MCCUNE, B.; GRACE, J. B. <strong>Analysis of Ecological Communities</strong>. Gleneden Beach, Oregon, U.S.A.: MjM Software Design, 2002. p. 300.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="outcentr.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="bibliografia.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/4-01-rmd7_upgma.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["fundamentos_de_ecologia_numerica.pdf", "fundamentos_de_ecologia_numerica.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
