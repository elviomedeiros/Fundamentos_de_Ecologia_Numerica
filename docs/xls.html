<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title> 6 R Modulo 1 - Importando planilhas de dados | Fundamentos de Ecologia Numérica</title>
<meta name="author" content="Prof. Elvio S. F. Medeiros">
<meta name="author" content="Laboratório de Ecologia">
<meta name="author" content="Universidade Estadual da Paraíba">
<meta name="author" content="Campus V, João Pessoa, PB">
<meta name="description" content="RESUMO A importação de planilhas do Excel para o ambiente de programação R é uma tarefa fundamental para análise de dados e estatísticas. Através da importação de planilhas do Excel, é possível...">
<meta name="generator" content="bookdown 0.38 with bs4_book()">
<meta property="og:title" content=" 6 R Modulo 1 - Importando planilhas de dados | Fundamentos de Ecologia Numérica">
<meta property="og:type" content="book">
<meta property="og:description" content="RESUMO A importação de planilhas do Excel para o ambiente de programação R é uma tarefa fundamental para análise de dados e estatísticas. Através da importação de planilhas do Excel, é possível...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content=" 6 R Modulo 1 - Importando planilhas de dados | Fundamentos de Ecologia Numérica">
<meta name="twitter:description" content="RESUMO A importação de planilhas do Excel para o ambiente de programação R é uma tarefa fundamental para análise de dados e estatísticas. Através da importação de planilhas do Excel, é possível...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.2/transition.js"></script><script src="libs/bs3compat-0.4.2/tabs.js"></script><script src="libs/bs3compat-0.4.2/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet">
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script><script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script><script src="libs/rglWebGL-binding-1.1.3/rglWebGL.js"></script><link href="libs/rglwidgetClass-1.1.3/rgl.css" rel="stylesheet">
<script src="libs/rglwidgetClass-1.1.3/rglClass.src.js"></script><script src="libs/rglwidgetClass-1.1.3/utils.src.js"></script><script src="libs/rglwidgetClass-1.1.3/buffer.src.js"></script><script src="libs/rglwidgetClass-1.1.3/subscenes.src.js"></script><script src="libs/rglwidgetClass-1.1.3/shaders.src.js"></script><script src="libs/rglwidgetClass-1.1.3/shadersrc.src.js"></script><script src="libs/rglwidgetClass-1.1.3/textures.src.js"></script><script src="libs/rglwidgetClass-1.1.3/projection.src.js"></script><script src="libs/rglwidgetClass-1.1.3/mouse.src.js"></script><script src="libs/rglwidgetClass-1.1.3/init.src.js"></script><script src="libs/rglwidgetClass-1.1.3/pieces.src.js"></script><script src="libs/rglwidgetClass-1.1.3/draw.src.js"></script><script src="libs/rglwidgetClass-1.1.3/controls.src.js"></script><script src="libs/rglwidgetClass-1.1.3/selection.src.js"></script><script src="libs/rglwidgetClass-1.1.3/rglTimer.src.js"></script><script src="libs/rglwidgetClass-1.1.3/pretty.src.js"></script><script src="libs/rglwidgetClass-1.1.3/axes.src.js"></script><script src="libs/rglwidgetClass-1.1.3/animation.src.js"></script><script src="libs/CanvasMatrix4-1.1.3/CanvasMatrix.src.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
          margin-bottom: 1em;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="Disciplina de Ecologia Numérica do Curso de Ciências Biológicas do Campus V da UEPB">Fundamentos de Ecologia Numérica</a>:
        <small class="text-muted">Disciplina de Ecologia Numérica do Curso de Ciências Biológicas do Campus V da UEPB</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Apresentação</a></li>
<li><a class="" href="intro.html"><span class="header-section-number">2</span> Introdução ao R/RStudio</a></li>
<li class="book-part">II. BASES DE DADOS</li>
<li><a class="" href="bases.html"><span class="header-section-number">3</span> Bases de dados. Dados do PPBio Semiárido</a></li>
<li><a class="" href="basepeixes.html"><span class="header-section-number">4</span> Base de dados I - Peixes</a></li>
<li><a class="" href="basehab.html"><span class="header-section-number">5</span> Base de dados II - Habitat</a></li>
<li class="book-part">III. ESTATÍSTICAS DESCRITIVAS</li>
<li><a class="active" href="xls.html"><span class="header-section-number">6</span> R Modulo 1 - Importando planilhas de dados</a></li>
<li><a class="" href="tiposR.html"><span class="header-section-number">7</span> R Modulo 2 - Tipos de dados no R</a></li>
<li><a class="" href="univ.html"><span class="header-section-number">8</span> R Modulo 3.1 - Estatísticas descritivas e normalidade</a></li>
<li><a class="" href="univ2.html"><span class="header-section-number">9</span> R Modulo 3.2 - Testes estatísticos</a></li>
<li><a class="" href="unigr.html"><span class="header-section-number">10</span> R Modulo 3.3 - Gráficos univariados</a></li>
<li><a class="" href="estrcom.html"><span class="header-section-number">11</span> R Módulo 4.1 - Estrutura da comunidade</a></li>
<li><a class="" href="partdiv.html"><span class="header-section-number">12</span> R Modulo 4.2 - Decomposição da diversidade</a></li>
<li><a class="" href="estrhab.html"><span class="header-section-number">13</span> R Modulo 4.3 - Estrutura do habitat</a></li>
<li><a class="" href="reltrns.html"><span class="header-section-number">14</span> R Modulo 5 - Relativizações e transformações</a></li>
<li><a class="" href="outcentr.html"><span class="header-section-number">15</span> R Módulo 6 - Análise de outliers baseada no desvio padrão do centróide</a></li>
<li class="book-part">IV. ANÁLISES MULTIVARIADAS</li>
<li><a class="" href="upgma.html"><span class="header-section-number">16</span> R Módulo 7 - Análise de Classificação Hierárquica - SAHN</a></li>
<li><a class="" href="kmeans.html"><span class="header-section-number">17</span> R Modulo 8 - Análise de Classificação Não-hierárquica - K-Means</a></li>
<li><a class="" href="nmds.html"><span class="header-section-number">18</span> R Módulo 10.1 - Análise de Ordenação - NMDS</a></li>
<li><a class="" href="nmds2.html"><span class="header-section-number">19</span> R Modulo 10.2 - Análise de Ordenação - NMDS</a></li>
<li><a class="" href="bibliografia-geral.html">Bibliografia Geral</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="xls" class="section level1" number="6">
<h1>
<span class="header-section-number"> 6</span> R Modulo 1 - Importando planilhas de dados<a class="anchor" aria-label="anchor" href="#xls"><i class="fas fa-link"></i></a>
</h1>
<div id="resumo-4" class="section level3 unnumbered">
<h3>RESUMO<a class="anchor" aria-label="anchor" href="#resumo-4"><i class="fas fa-link"></i></a>
</h3>
<p>A importação de planilhas do Excel para o ambiente de programação R é uma tarefa fundamental para análise de dados e estatísticas. Através da importação de planilhas do Excel, é possível transformar dados armazenados em formatos familiares em estruturas que podem ser manipuladas e exploradas de maneira eficaz no R. Isso permite a aplicação de diversas técnicas estatísticas e criação de visualizações informativas, contribuindo para a tomada de decisões embasadas em dados. Neste contexto, entender como importar dados do Excel para o R é um passo crucial para realizar análises de alta qualidade e obter insights significativos a partir dos conjuntos de dados disponíveis.</p>
</div>
<div id="apresentação-3" class="section level3 unnumbered">
<h3>Apresentação<a class="anchor" aria-label="anchor" href="#apresenta%C3%A7%C3%A3o-3"><i class="fas fa-link"></i></a>
</h3>
<p>A importação de planilhas do Excel para o ambiente de programação R é uma tarefa fundamental para análise de dados e estatísticas. O R é uma linguagem de programação amplamente utilizada por cientistas de dados, pesquisadores e analistas para manipular, visualizar e modelar informações. Através da importação de planilhas do Excel, é possível transformar dados armazenados em formatos familiares em estruturas que podem ser manipuladas e exploradas de maneira eficaz no R. Isso permite a aplicação de diversas técnicas estatísticas e criação de visualizações informativas, contribuindo para a tomada de decisões embasadas em dados. Neste contexto, entender como importar dados do Excel para o R é um passo crucial para realizar análises de alta qualidade e obter insights significativos a partir dos conjuntos de dados disponíveis.</p>
</div>
<div id="sobre-os-dados-do-ppbio-2" class="section level2" number="6.1">
<h2>
<span class="header-section-number">6.1</span> Sobre os dados do PPBio<a class="anchor" aria-label="anchor" href="#sobre-os-dados-do-ppbio-2"><i class="fas fa-link"></i></a>
</h2>
<p>Usaremos para esse tutorial dados coletados no Programa de Pesquisa em Biodiversidade - PPBio (veja <a href="https://ppbio.inpa.gov.br/Sobre">Programa de Pesquisa em Biodiversidade – PPBio</a>). Nesta base de dados estão armazenadas informações sobre diversos grupos taxonômicos dstribuidos em diversas unidades amostrais (UA’s ou sítios), como peixes, macroinverbrebrados bentônicos, quironomídeos e zooplâncotn, além de dados do habitat, como variáveis físicas e químicas, morfologia do habitat, composição do substrato, estrutura de habitat marginal, entre outros (Figura <a href="xls.html#fig:301ppbio">6.1</a>).</p>
<p>Essa é a <strong>matriz bruta de dados</strong>, porque os valores ainda não foram ajustados para os valores de Captura Por Unidade de Esforço (CPUE), nem foram relativizados ou transformados.</p>
<div class="figure">
<span style="display:block;" id="fig:301ppbio"></span>
<img src="imagens/ppbio.png" alt="Parte da planilha de dados brutos do PPBio." width="450px"><p class="caption">
Figura 6.1: Parte da planilha de dados brutos do PPBio.
</p>
</div>
<div class="infobox warning">
<div class="center">
<p><strong>IMPORTANTE</strong></p>
</div>
<p>Veja as matrizes de dados disponíveis para análises, suas descrições e tipos de dados, na seção <a href="bases.html#arqs">Arquivos disponíveis</a> do Capítulo <a href="bases.html#bases">Bases de dados</a>.</p>
</div>
<p>A planilha <code>ppbio*-peixes.***</code> contém o delineamento amostral de um dos estudos do Projeto PPBio (Figura <a href="xls.html#fig:301rm1">6.2</a>). Nas linhas são apresentadas as abreviações dos nomes das unidades amostrais (UA’s) e nas colunas são apresentados os nomes abreviados das espécies - temos portando uma matriz comunitária. No corpo da planilha temos os valores para o tipo de dados amostrado. Quantitativo, semi-quatitativo ou qualitativo.</p>
<p>Qual desses tipos de dados você acha que é apresentado na planilha?</p>
<div class="figure">
<span style="display:block;" id="fig:301rm1"></span>
<img src="imagens/rm1.fig3.png" alt="Associação entre a planilha de dados brutos do PPBio e o delineamento amostral do estudo." width="450px"><p class="caption">
Figura 6.2: Associação entre a planilha de dados brutos do PPBio e o delineamento amostral do estudo.
</p>
</div>
<p>Várias das espécies nessa matriz tem grande importância ecológica, como é o caso de <em>Astyanax bimaculatus</em> <a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;A etimologia do gênero &lt;em&gt;Astyanax&lt;/em&gt; vem da mitologia Grega. Heitor personagem da “Ilíada”, tinha um filho chamado Astíanax.&lt;/p&gt;"><sup>11</sup></a> (Figura <a href="xls.html#fig:301asbim">6.3</a>), que é muito comum em rios intermitentes e serve de alimento para predadores maiores como a espécie <em>Hoplias malabaricus</em> <a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Do Grego, &lt;em&gt;hoplon&lt;/em&gt;, arma ou armadura, em referência aos dentes caniniformes muito desenvolvidos, e forte estrutura óssea na cabeça.&lt;/p&gt;"><sup>12</sup></a> (Figura <a href="xls.html#fig:301hmala">6.4</a>).</p>
<div class="figure">
<span style="display:block;" id="fig:301asbim"></span>
<img src="imagens/spp/Asbim_u4.jpg" alt="*Astyanax bimaculatus*, a espécie mais comum da matriz de dados ppbio. Peru, by Eakins, R. Fonte: &lt;https://www.fishbase.se/summary/Astianax-bimaculatus.html&gt;" width="450px"><p class="caption">
Figura 6.3: <em>Astyanax bimaculatus</em>, a espécie mais comum da matriz de dados ppbio. Peru, by Eakins, R. Fonte: <a href="https://www.fishbase.se/summary/Astianax-bimaculatus.html" class="uri">https://www.fishbase.se/summary/Astianax-bimaculatus.html</a>
</p>
</div>
<div class="figure">
<span style="display:block;" id="fig:301hmala"></span>
<img src="imagens/spp/Homal_u6.jpg" alt="*Hoplias malabaricus*, espécie que cresce para se tornar um importante predador. Brazil, by Roselet, F.F.G. Fonte: &lt;https://www.fishbase.se/summary/Hoplias-malabaricus.html&gt;" width="450px"><p class="caption">
Figura 6.4: <em>Hoplias malabaricus</em>, espécie que cresce para se tornar um importante predador. Brazil, by Roselet, F.F.G. Fonte: <a href="https://www.fishbase.se/summary/Hoplias-malabaricus.html" class="uri">https://www.fishbase.se/summary/Hoplias-malabaricus.html</a>
</p>
</div>
<div class="infobox note">
<div class="center">
<p><strong>NOTA</strong></p>
</div>
<p>Se você ainda não tem o R e o RStudio instalados veja a seção <a href="intro.html#instala_r">Instalação do R e RStudio</a> do Capítulo <a href="intro.html#intro">Introdução ao R/RStudio</a></p>
</div>
</div>
<div id="importando-a-planilha-de-trabalho" class="section level2" number="6.2">
<h2>
<span class="header-section-number">6.2</span> Importando a planilha de trabalho<a class="anchor" aria-label="anchor" href="#importando-a-planilha-de-trabalho"><i class="fas fa-link"></i></a>
</h2>
<div class="infobox2 stopred">
<div class="center">
<p><strong><span style="color:white">ATENÇÃO</span></strong></p>
</div>
<p>Os links para baixar as planilhas necessárias para repetir esse tutorial podem ser encontrados na seção <a href="bases.html#arqs">Arquivos disponíveis</a> do Capítulo <a href="bases.html#bases">Bases de dados</a>.</p>
<div class="center">
<p>Ou, baixe aqui o arquivo <a href="https://docs.google.com/spreadsheets/d/1Olyew6L3SCFeSXWJC54Ak3MKmgHD3sTK/edit?usp=drive_link&amp;ouid=101766125969589673518&amp;rtpof=true&amp;sd=true">ppbio06c-peixes.xlsx</a></p>
</div>
</div>
<p>Para começar a usar o R e analisar os dados do Projeto PPBio, abra o RStudio, verifique sua interface (Figura <a href="xls.html#fig:301interface">6.5</a>) e siga as instruções a seguir.</p>
<div class="figure">
<span style="display:block;" id="fig:301interface"></span>
<img src="imagens/interfaceR.png" alt="Interface típica do RStudio e nome dos paineis  ou janelas." width="450px"><p class="caption">
Figura 6.5: Interface típica do RStudio e nome dos paineis ou janelas.
</p>
</div>
</div>
<div id="mensagens-de-erro-e-avisos-no-r" class="section level2" number="6.3">
<h2>
<span class="header-section-number">6.3</span> Mensagens de erro e avisos no R<a class="anchor" aria-label="anchor" href="#mensagens-de-erro-e-avisos-no-r"><i class="fas fa-link"></i></a>
</h2>
<p>No contexto da linguagem de programação R, mensagens de erro (errors) e mensagens de aviso (warnings) que <span style="color:red">aparecem em vermelho no painel de console</span>. Elas são formas de feedback do sistema que indicam problemas ou situações potencialmente problemáticas durante a execução do código. Aqui está uma breve explicação de cada um:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Erro (<span style="color:red">Error</span>):</strong>
<ul>
<li>Um erro ocorre quando algo no código não está correto ou não pode ser executado como esperado.</li>
<li>Isso pode ser causado por sintaxe incorreta, uso incorreto de funções, operações inválidas, referências a objetos que não existem, entre outros problemas.</li>
<li>Quando ocorre um erro, a execução do código é interrompida e uma mensagem de erro é exibida no console em vermelho, indicando o tipo de erro e, muitas vezes, a linha onde ocorreu.</li>
</ul>
</li>
<li>
<strong>Aviso (<span style="color:red">Warning</span>):</strong>
<ul>
<li>Não indica erro. Um aviso é emitido quando algo no código pode resultar em um comportamento indesejado ou em resultados inesperados, mas não interrompe necessariamente a execução do código.</li>
<li>Os avisos geralmente indicam situações que merecem atenção, como conversões de tipos de dados que podem perder informações ou funções que estão sendo usadas de maneira que pode levar a resultados questionáveis.</li>
<li>Os avisos são exibidos em vermelho no console e fornecem informações sobre a natureza do aviso e, possivelmente, como abordá-lo.</li>
</ul>
</li>
</ol>
<p>É importante prestar atenção a mensagens de erro e avisos, pois eles fornecem insights sobre problemas em seu código ou potenciais fontes de comportamento inesperado. Resolver erros é fundamental para que o código funcione conforme o esperado. Embora os avisos não interrompam a execução, investigá-los pode ajudar a evitar problemas futuros ou melhorar a qualidade do código.</p>
</div>
<div id="organização-básica" class="section level2" number="6.4">
<h2>
<span class="header-section-number">6.4</span> Organização básica<a class="anchor" aria-label="anchor" href="#organiza%C3%A7%C3%A3o-b%C3%A1sica"><i class="fas fa-link"></i></a>
</h2>
<p>No ambiente do RStudio no painel de edição de código execute (<code>Ctrl+Enter</code> com o teclado ou <code>Run</code> no editor de código) os comandos a seguir, para instalar os pacotes necessários para este módulo.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"readxl"</span><span class="op">)</span> <span class="co">#importa arquivos do excel</span></span></code></pre></div>
<p>E em seguida,</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></span></code></pre></div>
<p>Os códigos acima, são usados para instalar e carregar os pacotes necessários para este módulo. Esses códigos são comandos para instalar pacotes no R. Um pacote é uma coleção de funções, dados e documentação que ampliam as capacidades do R (<a href="https://cran.r-project.org/">R CRAN</a>) <span class="citation">(<a href="#ref-RN2774" role="doc-biblioref">TEAM, 2017</a>)</span>, e <a href="https://posit.co/download/rstudio-desktop/">RStudio</a> <span class="citation">(<a href="#ref-RN358" role="doc-biblioref">TEAM, 2022</a>)</span>. No exemplo acima, o pacote <code>readxl</code> permite ler e escrever arquivos Excel no R.</p>
<p>Para instalar um pacote no R, você precisa usar a função <code><a href="https://rdrr.io/r/utils/install.packages.html">install.packages()</a></code>. Depois de instalar um pacote, você precisa carregá-lo na sua sessão R com a função <code><a href="https://rdrr.io/r/base/library.html">library()</a></code>.</p>
<p>Por exemplo, para carregar o pacote <code>readxl</code>, você precisa executar a função <code><a href="https://readxl.tidyverse.org">library(readxl)</a></code>. Isso irá permitir que você use as funções do pacote na sua sessão R. Você precisa carregar um pacote toda vez que iniciar uma nova sessão R e quiser usar um pacote instalado.</p>
<p>Agora vamos <strong>definir o diretório de trabalho</strong>. Esse código é usado para obter e definir o diretório de trabalho atual no R. O comando <code><a href="https://rdrr.io/r/base/getwd.html">getwd()</a></code> retorna o caminho do diretório onde o R está lendo e salvando arquivos. O comando <code><a href="https://rdrr.io/r/base/getwd.html">setwd()</a></code> muda esse diretório de trabalho para o caminho especificado entre aspas. No seu caso, você deve ajustar o caminho para o seu próprio diretório de trabalho. <strong>Lembre de usar a barra “/” entre os diretórios. E não a contra-barra “\”.</strong></p>
<p>Usaremos uma matriz multivariada (sítios x espécies, matriz comunitária) do Projeto PPBio chamada ppbio**.xlsx que está no diretório <span style="color:blue">“C:/Meu/Diretório/De/Trabalho/Planilha.xlsx”</span></p>
<p>Note que o símbolo <code>#</code> em programação R significa que o texto que vem depois dele é um comentário e não será executado pelo programa. Isso é útil para explicar o código ou deixar anotações.</p>
<p>Ajuste a segunda linha do código abaixo para refletir <span style="color:red">“C:/Seu/Diretório/De/Trabalho/Planilha.xlsx”</span>.</p>
<p>Definindo o diretório de trabalho e installando os pacotes necessários:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">setwd</a></span><span class="op">(</span><span class="st">"C:/Seu/Diretório/De/Trabalho"</span><span class="op">)</span></span></code></pre></div>
<p>Alternativamente você pode ir na barra de tarefas e escolhes as opções:\SESSION -&gt; SET WORKING DIRECTORY -&gt; CHOOSE DIRECTORY</p>
<div id="prefira-sempre-códigos-e-scripts-do-que-mouse-e-menus-de-janelas-no-r" class="section level3" number="6.4.1">
<h3>
<span class="header-section-number">6.4.1</span> Prefira sempre códigos e scripts do que mouse e menus de janelas no R<a class="anchor" aria-label="anchor" href="#prefira-sempre-c%C3%B3digos-e-scripts-do-que-mouse-e-menus-de-janelas-no-r"><i class="fas fa-link"></i></a>
</h3>
<p>Optar pelo uso de scripts e comandos de teclado no R, em vez das opções baseadas em mouse e menus das janelas, oferece várias vantagens significativas para quem está envolvido em análises de dados e programação. Aqui estão algumas justificativas para essa abordagem:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Reprodutibilidade:</strong> O uso de scripts permite que todas as etapas de análise e manipulação de dados sejam documentadas em um único lugar. Isso facilita a reexecução de todo o processo, tornando a análise reprodutível e permitindo que outras pessoas compreendam e validem o trabalho realizado.</p></li>
<li><p><strong>Automação:</strong> Comandos de script podem ser facilmente repetidos ou adaptados para diferentes conjuntos de dados. Isso possibilita a automação de tarefas complexas, economizando tempo e reduzindo a possibilidade de erros manuais.</p></li>
<li><p><strong>Flexibilidade:</strong> Enquanto as opções de mouse e menus podem ser limitadas em termos das ações específicas que permitem, os scripts oferecem uma flexibilidade muito maior. Você pode personalizar cada etapa do processo de análise de acordo com suas necessidades específicas.</p></li>
<li><p><strong>Eficiência:</strong> A digitação de comandos é geralmente mais rápida do que navegar por menus e clicar em botões, especialmente quando se trata de tarefas repetitivas e/ou complexas.</p></li>
<li><p><strong>Controle total:</strong> Ao utilizar scripts, você tem controle total sobre cada etapa do processo. Isso é particularmente importante em análises estatísticas, onde pequenas variações nos parâmetros podem ter um grande impacto nos resultados.</p></li>
<li><p><strong>Aprendizado contínuo:</strong> Escrever e modificar scripts permite um maior aprendizado e domínio da linguagem R. Conforme você ganha experiência, poderá realizar análises mais sofisticadas e explorar recursos avançados.</p></li>
<li><p><strong>Portabilidade:</strong> Scripts podem ser facilmente compartilhados com outros pesquisadores ou colegas, independentemente do sistema operacional utilizado. Isso torna a colaboração mais fluida e ajuda a evitar problemas de compatibilidade.</p></li>
<li><p><strong>Melhor entendimento:</strong> Ao escrever e ler scripts, você desenvolve uma compreensão mais profunda dos processos que está realizando. Isso é importante para identificar possíveis erros e interpretar corretamente os resultados.</p></li>
<li><p><strong>Documentação clara:</strong> Ao escrever um script, você pode adicionar comentários explicativos que descrevem cada passo e sua lógica. Isso resulta em uma documentação clara e autoexplicativa do trabalho realizado.</p></li>
<li><p><strong>Consistência:</strong> O uso de scripts promove a adoção de práticas consistentes em toda a análise, reduzindo a chance de erros causados por abordagens diferentes em momentos distintos.</p></li>
</ol>
<p>Em resumo, a abordagem baseada em scripts e comandos de teclado oferece mais controle, flexibilidade, eficiência e reprodutibilidade, tornando-a a escolha preferida para profissionais que buscam análises de dados precisas, consistentes e de alta qualidade no ambiente R.</p>
</div>
</div>
<div id="importando-a-planilha" class="section level2" number="6.5">
<h2>
<span class="header-section-number">6.5</span> Importando a planilha<a class="anchor" aria-label="anchor" href="#importando-a-planilha"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></span>
<span><span class="va">ppbio06</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"D:/Elvio/OneDrive/Disciplinas/_EcoNumerica/5.Matrizes/ppbio06c-peixes.xlsx"</span>,</span>
<span>                      sheet <span class="op">=</span> <span class="st">"Sheet1"</span>,</span>
<span>                      na <span class="op">=</span> <span class="st">"NA"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">ppbio06</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">ppbio06</span><span class="op">)</span></span></code></pre></div>
<p>Com essas linhas de código a primeira coluna da matriz importada apresenta texto. Não queremos assim porque vamos fazer cálculos matemáticos na matriz.</p>
<p>Resolvemos o problema com mais algumas linhas de código.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ppbio06</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">ppbio06</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">ppbio06</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">ppbio06</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">ppbio06</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="co">#tem  que ser um df</span></span>
<span><span class="va">ppbio06</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
<p>Ou podemos instalar esse pacote de importação de arquivos .xlsx para o R.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"openxlsx"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ycphs.github.io/openxlsx/index.html">openxlsx</a></span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning: package 'openxlsx' was built under R version 4.3.2</code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ppbio</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html">read.xlsx</a></span><span class="op">(</span><span class="st">"D:/Elvio/OneDrive/Disciplinas/_EcoNumerica/5.Matrizes/ppbio06c-peixes.xlsx"</span>,</span>
<span>                   rowNames <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                   colNames <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                   sheet <span class="op">=</span> <span class="st">"Sheet1"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">ppbio</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">ppbio</span><span class="op">)</span></span>
<span><span class="va">ppbio_ma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">ppbio</span><span class="op">)</span> <span class="co">#lê ppbio como uma matriz</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">ppbio_ma</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">ppbio_ma</span><span class="op">)</span></span>
<span><span class="co">#ppbio</span></span>
<span><span class="co">#ppbio_ma</span></span></code></pre></div>
<p>Compare as diferenças. Agora podemos exportar os dados como uma matriz de dados em formato de <code>valores separados por vírgula (.csv)</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.table</a></span><span class="op">(</span><span class="va">ppbio</span>, <span class="st">"ppbiocsv.txt"</span>, append <span class="op">=</span> <span class="cn">F</span>, quote <span class="op">=</span> <span class="cn">T</span>, <span class="st">";"</span>, row.names <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/shell.exec.html">shell.exec</a></span><span class="op">(</span><span class="va">dir</span><span class="op">)</span> <span class="co">#abre o diretorio de trabalho no Windows Explorer</span></span></code></pre></div>
<p>Podemos abrir o arquivo .csv criado <code>ppbiocsv.txt</code> usando os códigos abaixo.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ppbiocsv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"ppbiocsv.txt"</span>,</span>
<span>                     sep <span class="op">=</span> <span class="st">";"</span>, dec <span class="op">=</span> <span class="st">","</span>, <span class="co">#definimos o dígito separador</span></span>
<span>                     header <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                     row.names <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                     na.strings <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">ppbiocsv</span><span class="op">)</span></span>
<span><span class="va">ppbiocsv</span></span></code></pre></div>
<p>Lembre de prestar atenção no dígito separador de decimais ” , ” ou ” . ” . Além disso, só estaamos usando <code>ppbio**.***</code> porque o diretório de trabalho ja fo definido no início. Se não deveríamos estar usando <code>C:/Seu/Diretório/De/Trabalho/ppbio**.***</code></p>
<p>Alguns comandos para exibir a planilha são “case-sensitive” <code>(ignore.case(object))</code></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#View(ppbio)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">ppbio</span><span class="op">)</span></span>
<span><span class="va">ppbio</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">ppbio</span><span class="op">)</span></span>
<span><span class="co">#?View</span></span>
<span><span class="co">#?view</span></span>
<span><span class="co">#?remove</span></span></code></pre></div>
<div id="outra-forma-de-achar-e-importar-uma-planilha" class="section level3" number="6.5.1">
<h3>
<span class="header-section-number">6.5.1</span> Outra forma de achar e importar uma planilha<a class="anchor" aria-label="anchor" href="#outra-forma-de-achar-e-importar-uma-planilha"><i class="fas fa-link"></i></a>
</h3>
<p>Essa forma é desaconselhavel porque é demorada e sujeita a erros. Além de precisar ser refeita sempre que se quiser abrir uma nova planilha ou reabrir a última planilha importada. Veja o tópico <a href="xls.html#prefira-sempre-c%C3%B3digos-e-scripts-do-que-mouse-e-menus-de-janelas-no-r">Prefira sempre códigos e scripts do que mouse e menus de janelas no R</a></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">ppbio</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html">read.xlsx</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.choose.html">file.choose</a></span><span class="op">(</span><span class="op">)</span>,  <span class="co">#abre o windows explorer</span></span>
<span>                   rowNames <span class="op">=</span> <span class="cn">T</span>, colNames <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                   sheet <span class="op">=</span> <span class="st">"Sheet1"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div id="importando-.ods-do-libreoffice-calc" class="section level2" number="6.6">
<h2>
<span class="header-section-number">6.6</span> Importando <code>.ods</code> do LibreOffice Calc<a class="anchor" aria-label="anchor" href="#importando-.ods-do-libreoffice-calc"><i class="fas fa-link"></i></a>
</h2>
<p>A planilha a seguir pode ser baixada da seção <a href="#download401"><strong>??</strong></a></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#install.packages("readODS")</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/readODS">readODS</a></span><span class="op">)</span></span>
<span><span class="va">ppbio06.ods</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/readODS/reference/read_ods.html">read_ods</a></span><span class="op">(</span><span class="st">"D:/Elvio/OneDrive/Disciplinas/_EcoNumerica/5.Matrizes/ppbio06c-peixes.ods"</span>,</span>
<span>                   row_names <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                   col_names <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                   sheet <span class="op">=</span> <span class="st">"Sheet1"</span>,</span>
<span>                   as_tibble <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                   na <span class="op">=</span> <span class="st">"n/a"</span><span class="op">)</span> <span class="co"># porque existem celulas vazias (n/a)</span></span>
<span><span class="va">ppbio06.ods</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">ppbio06.ods</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">ppbio06.ods</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">ppbio06.ods</span><span class="op">)</span></span>
<span><span class="va">ppbio06.ods_ma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">ppbio06.ods</span><span class="op">)</span> <span class="co">#lê como uma matriz</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">ppbio06.ods_ma</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">ppbio06.ods_ma</span><span class="op">)</span></span>
<span><span class="co">#ppbio06.ods</span></span>
<span><span class="co">#ppbio06.ods_ma</span></span></code></pre></div>
<div id="colunas-com-o-mesmo-nome" class="section level3" number="6.6.1">
<h3>
<span class="header-section-number">6.6.1</span> Colunas com o mesmo nome<a class="anchor" aria-label="anchor" href="#colunas-com-o-mesmo-nome"><i class="fas fa-link"></i></a>
</h3>
<p>Em algumas situações é necessário encontrar colunas com o mesmo nome em um conjunto de dados e soma-las ou fazer sua média. Isso pode ocorrer quando se está trabalhando com dados de várias fontes e é necessário combinar esses diferentes conjuntos de dados.</p>
<p>Considere por exemplo um cenário onde se está trabalhando em um projeto de análise de dados ecológicos e você recebeu conjuntos de dados de diferentes locais de amostragens enviados por diferentes pesquisadores, e cada pesquiador enviou seu conjunto de dados que contém informações sobre as mesmas espécies (ou variáveis ambientais). Devido a diferentes sistemas de registro ou a falta de comunicação entre os pesquisadores, pode haver repetição nos nomes das colunas.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Dados de mamíferos roedores</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  Rato <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  Musaranho <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>  Rato <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">9</span><span class="op">)</span>, <span class="co">#nome duplicado</span></span>
<span>  Esquilo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  Ratão <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  Castor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  Tâmia <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span><span class="op">)</span>,</span>
<span>  Marmota <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  Castor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, <span class="co">#nome duplicado</span></span>
<span>  check.names <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df</span></span></code></pre></div>
<pre><code>##   Rato Musaranho Rato Esquilo Ratão Castor Tâmia Marmota Castor
## 1    1         4    7       0     1      1    11       1      2
## 2    2         5    8       0     1      0    12       2      1
## 3    3         6    9       1     0      0    13       0      1</code></pre>
<p>Por exemplo, no estudo sobre mamíferos roedores acima, quando se combina o conjunto geral de dados para realizar uma análise abrangente, depara-se com colunas duplicadas, onde a matriz com o conjunto total de dados contém espécies repetidas.</p>
<p>Nesse caso, encontrar e resolver colunas com o mesmo nome é crucial para garantir a integridade dos dados e realizar uma análise precisa. Você deve consolidar essas colunas duplicadas, somando-as ou fazendo sua média.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Achando colunas com nomes duplicados</span></span>
<span><span class="va">dup_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html">duplicated</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co"># Somando colunas com o mesmo nome</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">col_name</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">dup_cols</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Get indices of columns with the same name</span></span>
<span>  <span class="va">col_indices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">==</span> <span class="va">col_name</span><span class="op">)</span></span>
<span>  <span class="co"># Sum columns with the same name</span></span>
<span>  <span class="va">df</span><span class="op">[[</span><span class="va">col_name</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span>, <span class="va">col_indices</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># Remove as colunas duplicadas originais e mantem as novas colunas que são a soma ("except for the first occurrence")</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html">duplicated</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co"># Mostra a nova tabela com colunas repetidas somadas</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<pre><code>##   Rato Musaranho Esquilo Ratão Castor Tâmia Marmota
## 1    8         4       0     1      3    11       1
## 2   10         5       0     1      1    12       2
## 3   12         6       1     0      1    13       0</code></pre>
</div>
<div id="removendo-linhas-ou-colunas-por-nome" class="section level3" number="6.6.2">
<h3>
<span class="header-section-number">6.6.2</span> Removendo linhas ou colunas por nome<a class="anchor" aria-label="anchor" href="#removendo-linhas-ou-colunas-por-nome"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Colunas</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">df</span>, select <span class="op">=</span> <span class="op">-</span><span class="va">Lec.mono</span><span class="op">)</span> <span class="co">#escolhendo uma coluna pelo nome</span></span>
<span></span>
<span><span class="co">#Linhas</span></span>
<span><span class="va">del_rows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ST20"</span><span class="op">)</span></span>
<span><span class="va">del_rows</span></span>
<span><span class="va">m_part</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="op">!</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">entorno</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">del_rows</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">m_part</span></span></code></pre></div>
</div>
<div id="criando-uma-matriz-de-médias" class="section level3" number="6.6.3">
<h3>
<span class="header-section-number">6.6.3</span> Criando uma matriz de médias<a class="anchor" aria-label="anchor" href="#criando-uma-matriz-de-m%C3%A9dias"><i class="fas fa-link"></i></a>
</h3>
<p>Por razões diferentes o precedimento anterior pode vir a ser necessário de ser aplicado às linhas. Por exemplo, quando se quer somar ou fazer a média de amostras diferentes do mesmo ambiente de coleta. Veja a matriz abaixo.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">"</span></span>
<span><span class="st">Sp1 Sp2 Sp3 Sp4 Sp5 Sp6 Sp7 Sp8</span></span>
<span><span class="st">A1 0 0 0 0 0 0 6 1</span></span>
<span><span class="st">A2 0 0 0 2 0 0 10 2</span></span>
<span><span class="st">B1 93 2 0 177 0 260 2 5</span></span>
<span><span class="st">B2 0 4 0 8 0 0 83 7</span></span>
<span><span class="st">C1 0 0 0 0 1 0 0 1</span></span>
<span><span class="st">C2 0 0 1 0 0 1 0 1</span></span>
<span><span class="st">C3 0 2 0 2 0 0 0 1</span></span>
<span><span class="st">"</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, row.names <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">data</span></span></code></pre></div>
<pre><code>##    Sp1 Sp2 Sp3 Sp4 Sp5 Sp6 Sp7 Sp8
## A1   0   0   0   0   0   0   6   1
## A2   0   0   0   2   0   0  10   2
## B1  93   2   0 177   0 260   2   5
## B2   0   4   0   8   0   0  83   7
## C1   0   0   0   0   1   0   0   1
## C2   0   0   1   0   0   1   0   1
## C3   0   2   0   2   0   0   0   1</code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://tidyverse.tidyverse.org">"tidyverse"</a></span><span class="op">)</span></span>
<span><span class="co">#Inserindo coluna para agrupamentos</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="co">#no. de N colunas x M linhas</span></span>
<span><span class="va">data_g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>Grupos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="va">data</span><span class="op">)</span></span>
<span><span class="va">data_g</span></span>
<span></span>
<span><span class="va">grps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">data_g</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">grps</span></span>
<span></span>
<span><span class="va">data_g</span> <span class="op">&lt;-</span> <span class="va">data_g</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Grupos<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">grps</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#data_avg &lt;- aggregate(data_g[, 9:9], list(data_g$Grupos), mean)</span></span>
<span><span class="co">#data_avg</span></span>
<span></span>
<span><span class="va">data_avg</span> <span class="op">&lt;-</span> <span class="va">data_g</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Grupos</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span>.cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">.x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">data_avg</span></span>
<span></span>
<span><span class="va">data_dp</span> <span class="op">&lt;-</span> <span class="va">data_g</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Grupos</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span>.cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">mean</span>, sd <span class="op">=</span> <span class="va">sd</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#?across</span></span>
<span><span class="va">data_dp</span></span>
<span></span>
<span><span class="co">#Primeira coluna para nomes das linhas </span></span>
<span><span class="va">data_dp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">data_dp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">data_dp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">data_dp</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">data_dp</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">data_dp</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">data_dp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">data_dp</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">data_dp</span></span>
<span><span class="co">#Salvando a matriz</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.table</a></span><span class="op">(</span><span class="va">data_dp</span>,</span>
<span>            <span class="st">"data_dp.csv"</span>,</span>
<span>            append <span class="op">=</span> <span class="cn">F</span>,</span>
<span>            quote <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            sep <span class="op">=</span> <span class="st">";"</span>, dec <span class="op">=</span> <span class="st">","</span>,</span>
<span>            row.names <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">data_dp_csv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"data_dp.csv"</span>,</span>
<span>                    sep <span class="op">=</span> <span class="st">";"</span>, dec <span class="op">=</span> <span class="st">","</span>,</span>
<span>                    header <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                    row.names <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                    na.strings <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div id="apêndices-2" class="section level2 unnumbered">
<h2>Apêndices<a class="anchor" aria-label="anchor" href="#ap%C3%AAndices-2"><i class="fas fa-link"></i></a>
</h2>
<div id="sites-consultados-1" class="section level3 unnumbered">
<h3>Sites consultados<a class="anchor" aria-label="anchor" href="#sites-consultados-1"><i class="fas fa-link"></i></a>
</h3>
<p>[<a href="https://youtu.be/U6ksXvvY6Q0" class="uri">https://youtu.be/U6ksXvvY6Q0</a>]<br>
[<a href="https://youtu.be/a7EJE_2mtGk" class="uri">https://youtu.be/a7EJE_2mtGk</a>]</p>
</div>
</div>
<div id="script-limpo" class="section level2 unnumbered">
<h2>Script limpo<a class="anchor" aria-label="anchor" href="#script-limpo"><i class="fas fa-link"></i></a>
</h2>
<p>Aqui apresento o scrip na íntegra sem os textos ou outros comentários. Você pode copiar e colar no R para executa-lo. Lembre de remover os <span style="color:green"><code>#</code></span> ou <span style="color:green"><code>##</code></span> caso necessite executar essas linhas.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## install.packages("readxl") #importa arquivos do excel</span></span>
<span><span class="co">## library(readxl)</span></span>
<span><span class="co">## getwd()</span></span>
<span><span class="co">## setwd("C:/Seu/Diretório/De/Trabalho")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></span>
<span><span class="va">ppbio06</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"D:/Elvio/OneDrive/Disciplinas/_EcoNumerica/5.Matrizes/ppbio06.xlsx"</span>,</span>
<span>                      sheet <span class="op">=</span> <span class="st">"Sheet1"</span>,</span>
<span>                      na <span class="op">=</span> <span class="st">"NA"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">ppbio06</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">ppbio06</span><span class="op">)</span></span>
<span><span class="va">ppbio06</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">ppbio06</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">ppbio06</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">ppbio06</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">ppbio06</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="co">#tem  que ser um df</span></span>
<span><span class="va">ppbio06</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="co">#install.packages("openxlsx")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ycphs.github.io/openxlsx/index.html">openxlsx</a></span><span class="op">)</span></span>
<span><span class="va">ppbio</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html">read.xlsx</a></span><span class="op">(</span><span class="st">"D:/Elvio/OneDrive/Disciplinas/_EcoNumerica/5.Matrizes/bentos06.xlsx"</span>,</span>
<span>                   rowNames <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                   colNames <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                   sheet <span class="op">=</span> <span class="st">"contagem"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">ppbio</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">ppbio</span><span class="op">)</span></span>
<span><span class="va">ppbio_ma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">ppbio</span><span class="op">)</span> <span class="co">#lê ppbio como uma matriz</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">ppbio_ma</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">ppbio_ma</span><span class="op">)</span></span>
<span><span class="co">#ppbio</span></span>
<span><span class="co">#ppbio_ma</span></span>
<span><span class="co">## write.table(ppbio, "ppbiocsv.txt", append = F, quote = T, ";", row.names = T)</span></span>
<span><span class="co">## dir &lt;- getwd()</span></span>
<span><span class="co">## shell.exec(dir) #abre o diretorio de trabalho no Windows Explorer</span></span>
<span><span class="co">## ppbiocsv &lt;- read.csv("ppbiocsv.txt",</span></span>
<span><span class="co">##                      sep = ";", dec = ",", #definimos o dígito separador</span></span>
<span><span class="co">##                      header = T,</span></span>
<span><span class="co">##                      row.names = 1,</span></span>
<span><span class="co">##                      na.strings = NA)</span></span>
<span><span class="co">## str(ppbiocsv)</span></span>
<span><span class="co">## ppbiocsv</span></span>
<span><span class="co">## #View(ppbio)</span></span>
<span><span class="co">## print(ppbio)</span></span>
<span><span class="co">## ppbio</span></span>
<span><span class="co">## str(ppbio)</span></span>
<span><span class="co">## #?View</span></span>
<span><span class="co">## #?view</span></span>
<span><span class="co">## #?remove</span></span>
<span><span class="co">## getwd()</span></span>
<span><span class="co">## ppbio &lt;- read.xlsx(file.choose(),  #abre o windows explorer</span></span>
<span><span class="co">##                    rowNames = T, colNames = T,</span></span>
<span><span class="co">##                    sheet = "Sheet1")</span></span></code></pre></div>
</div>
<div id="referências-4" class="section level2 unnumbered">
<h2>Referências<a class="anchor" aria-label="anchor" href="#refer%C3%AAncias-4"><i class="fas fa-link"></i></a>
</h2>

</div>
</div>
<h3>Bibliografia Geral</h3>
<div id="refs" class="references csl-bib-body" entry-spacing="1">
<div id="ref-RN2774" class="csl-entry">
TEAM, R. D. C. <strong>R: A language and environment for statistical computing</strong>. Austria: R Foundation for Statistical Computing, 2017. Disponível em: &lt;<a href="https://www.r-project.org/">https://www.r-project.org/</a>&gt;
</div>
<div id="ref-RN358" class="csl-entry">
TEAM, R. S. <strong>RStudio: Integrated Development Environment for R</strong>. Boston, MA: RStudio, PBC, 2022. Disponível em: &lt;<a href="https://posit.co/products/open-source/rstudio/">https://posit.co/products/open-source/rstudio/</a>&gt;
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="basehab.html"><span class="header-section-number">5</span> Base de dados II - Habitat</a></div>
<div class="next"><a href="tiposR.html"><span class="header-section-number">7</span> R Modulo 2 - Tipos de dados no R</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li>
<a class="nav-link" href="#xls"><span class="header-section-number">6</span> R Modulo 1 - Importando planilhas de dados</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#resumo-4">RESUMO</a></li>
<li><a class="nav-link" href="#apresenta%C3%A7%C3%A3o-3">Apresentação</a></li>
</ul>
</li>
<li><a class="nav-link" href="#sobre-os-dados-do-ppbio-2"><span class="header-section-number">6.1</span> Sobre os dados do PPBio</a></li>
<li><a class="nav-link" href="#importando-a-planilha-de-trabalho"><span class="header-section-number">6.2</span> Importando a planilha de trabalho</a></li>
<li><a class="nav-link" href="#mensagens-de-erro-e-avisos-no-r"><span class="header-section-number">6.3</span> Mensagens de erro e avisos no R</a></li>
<li>
<a class="nav-link" href="#organiza%C3%A7%C3%A3o-b%C3%A1sica"><span class="header-section-number">6.4</span> Organização básica</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#prefira-sempre-c%C3%B3digos-e-scripts-do-que-mouse-e-menus-de-janelas-no-r"><span class="header-section-number">6.4.1</span> Prefira sempre códigos e scripts do que mouse e menus de janelas no R</a></li></ul>
</li>
<li>
<a class="nav-link" href="#importando-a-planilha"><span class="header-section-number">6.5</span> Importando a planilha</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#outra-forma-de-achar-e-importar-uma-planilha"><span class="header-section-number">6.5.1</span> Outra forma de achar e importar uma planilha</a></li></ul>
</li>
<li>
<a class="nav-link" href="#importando-.ods-do-libreoffice-calc"><span class="header-section-number">6.6</span> Importando .ods do LibreOffice Calc</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#colunas-com-o-mesmo-nome"><span class="header-section-number">6.6.1</span> Colunas com o mesmo nome</a></li>
<li><a class="nav-link" href="#removendo-linhas-ou-colunas-por-nome"><span class="header-section-number">6.6.2</span> Removendo linhas ou colunas por nome</a></li>
<li><a class="nav-link" href="#criando-uma-matriz-de-m%C3%A9dias"><span class="header-section-number">6.6.3</span> Criando uma matriz de médias</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#ap%C3%AAndices-2">Apêndices</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#sites-consultados-1">Sites consultados</a></li></ul>
</li>
<li><a class="nav-link" href="#script-limpo">Script limpo</a></li>
<li><a class="nav-link" href="#refer%C3%AAncias-4">Referências</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Fundamentos de Ecologia Numérica</strong>: Disciplina de Ecologia Numérica do Curso de Ciências Biológicas do Campus V da UEPB" was written by Prof. Elvio S. F. Medeiros, Laboratório de Ecologia, Universidade Estadual da Paraíba, Campus V, João Pessoa, PB. It was last built on Last updated: 09/02/2026 18:38:06.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
